var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(a,o){function r(t){try{c(n.next(t))}catch(e){o(e)}}function s(t){try{c(n["throw"](t))}catch(e){o(e)}}function c(t){t.done?a(t.value):new i(function(e){e(t.value)}).then(r,s)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,o&&(r=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,o=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(r=s.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(n){i=[6,n],o=0}finally{a=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,o,r,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return{next:i(0),"throw":i(1),"return":i(2)}},Main=function(t){function e(){var i=t.call(this)||this;return i.configArrayList=[{path:"resource/default.res.json",root:"resource/"}],i.groupArrayList=["loading","game","pvp"],i.ifCanJiXu=!0,i.zhenPingX=50,i.zhenPingY=-.9,i.TopSence=new egret.DisplayObjectContainer,e.Instance=i,i}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.onConfigComplete(null);var i=new eui.Theme("resource/default.thm.json",this.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e.processStatus=Indicator.getInstance(e.processStatus).set(ProcessStatus.ThemeLoadEnd).indecate,e.onLoadingEnd()},this)},e.prototype.onConfigComplete=function(t){if(null==t&&RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.configArrayList.length>0){var e=this.configArrayList[0];this.configArrayList.splice(0,1),RES.loadConfig(e.path,e.root)}else RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.processStatus=Indicator.getInstance(this.processStatus).set(ProcessStatus.ConfigLoadEnd).indecate,this.onLoadingEnd()},e.prototype.onLoadingEnd=function(){Indicator.getChecker(this.processStatus)(ProcessStatus.ConfigLoadEnd|ProcessStatus.ThemeLoadEnd)&&!Indicator.getChecker(this.processStatus)(ProcessStatus.ResourceLoadEnd)?this.getResGroupList():Indicator.getChecker(this.processStatus)(ProcessStatus.ResourceLoadEnd)&&(FacadeApp.inst.startUp(this),FacadeApp.inst.registerMediator(new MainMediator(this)),egret.Ticker.getInstance().register(function(t){FacadeApp.inst.Process(t),SkillManager.Process(t)},this),FacadeApp.inst.watch(function(t){FacadeApp.dispatchAction(CommandList.M_AT_ACTIONEXECUTE,t.info)},"3006"),LoginPage.Register(this))},e.prototype.getResGroupList=function(){RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),this.groupArrayList.map(function(t){RES.loadGroup(t)})},e.prototype.onResourceLoadComplete=function(t){"loading"==t.groupName&&LoadingPage.Register(this);for(var e=0,i=0;i<this.groupArrayList.length;i++)e|=1<<i,this.groupArrayList[i]==t.groupName&&(this.groupProcessStatus=Indicator.getInstance(this.groupProcessStatus).set(1<<i).indecate);Indicator.getChecker(this.groupProcessStatus)(e)&&(RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),this.processStatus=Indicator.getInstance(this.processStatus).set(ProcessStatus.ResourceLoadEnd).indecate,this.onLoadingEnd())},e.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load")},e.prototype.onResourceProgress=function(t){"game"==t.groupName&&LoadingPage.upDateProgress("loading..."+Math.floor(100*t.itemsLoaded/t.itemsTotal).toString()+"%")},e.prototype.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},e.prototype.enterStartScreen=function(){LoginPage.inst.UnRegister(),ConfigStaticManager.Init(),SkillManager.Init(),TalismanManager.Init(),AmuletManager.Init(),CardManager.Init(),PetManager.Init(),GoodsManager.Init(),TaskManager.Init(),RewardItemManager.Init(),UnitManager.Init(),SoundManager.PlayBackgroundMusic()},e.prototype.enterGameScreen=function(){this.addChild(BG.GetInstance()),this.addChild(Decoration.GetInstance()),this.addChild(SoldierManage.FightManager.GetInstance()),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,SoldierManage.FightManager.GetInstance()._TouchTap,SoldierManage.FightManager.GetInstance()),this.addChild(e.Instance.TopSence),UIPage.inst(UIPage).Register(this,!1),GuideWindow.inst(GuideWindow).Register(this,!1).Show(FacadeApp.read(CommandList.Re_Status).guideId)},e.prototype.creatZhenPingFun=function(){this.ifCanJiXu=!1,this.zhenPingX=50,this.zhenPingY=.8,this.y=0,this.x=0,this.hasEventListener(egret.Event.ENTER_FRAME)||this.addEventListener(egret.Event.ENTER_FRAME,this.onFrame,this)},e.prototype.onFrame=function(t){this.zhenPingX*=-this.zhenPingY,this.y=this.zhenPingX,this.x=this.zhenPingX,Math.abs(this.zhenPingX)<.2&&(this.y=0,this.x=0,this.removeEventListener(egret.Event.ENTER_FRAME,this.onFrame,this),this.ifCanJiXu=!0)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var ProcessStatus={ThemeLoadEnd:1,ResourceLoadEnd:2,ConfigLoadEnd:4},CommandList={M_NET_CheckpointNum:1e5,M_NET_CheckEvent:100001,M_NET_TalismanNum:500001,M_NET_SkillNum:503001,M_NET_PetNum:504001,M_NET_RankNum:601001,M_NET_Amulet:501001,M_NET_STATUS:999002,M_NET_TASK:101e3,M_NET_Card:502001,M_NET_SHOP:999003,M_NET_TASK_GET:101001,M_NET_Mail:600001,M_NET_Activity:103001,GuideInfo:"checkGuide",GuideFinish:"guide.finish",Guide:"5001",GuideBonus:"5002",M_CMD_ZhenPing:"zhenping",M_CMD_CHANGE:"scene_change",M_CMD_Change_Marshalling:"M_CMD_Change_Marshalling",M_CMD_Change_Pet:"M_CMD_CHANGE_PET",M_CMD_CHANGE_ROLE:"M_CMD_CHANGE_ROLE",M_CMD_UiOpened_Task:"M_CMD_UIOPENED_TASK",M_CMD_UiOpened_Shop:"M_CMD_UIOPENED_SHOP",M_CMD_UiOpened_Pet:"M_CMD_UIOPENED_PET",M_CMD_UiOpened_Talisman:"M_CMD_UIOPENED_ITEM",M_CMD_UiOpened_Buddha:"M_CMD_UIOPENED_BUDDHA",M_CMD_UiOpened_BuddhaMgr:"M_CMD_UIOPENED_BUDDHAMGR",M_CMD_UiOpened_Achievement:"M_CMD_UIOPENED_ACHIEVEMENT",M_CMD_UiOpened_Card:"M_CMD_UiOpened_Card",M_CMD_UiOpened_Marshalling:"M_CMD_UiOpened_Marshalling",M_CMD_UiOpened_ActivityRule:"M_CMD_UiOpened_ActivityRule",M_CMD_UiOpened_Amulet:"M_CMD_UIOPENED_AMULET",M_CMD_UiOpened_AmuletPokedex:"M_CMD_UiOpened_AmuletPokedex",M_CMD_UIOPENED_RANK_Tab1:"M_CMD_UIOPENED_RANK_Tab1",M_CMD_UIOPENED_RANK_Tab2:"M_CMD_UIOPENED_RANK_Tab2",M_CMD_UIOPENED_RANK_Tab3:"M_CMD_UIOPENED_RANK_Tab3",M_CMD_UiOpened_HangUpTip:"M_CMD_UiOpened_HangUpTip",M_CMD_UiOpened_HangUp:"M_CMD_UiOpened_HangUp",M_CMD_UiOpened_SeniorRevive:"M_CMD_UiOpened_SeniorRevive",M_CMD_UiOpened_ZS:"M_CMD_UiOpened_ZS",M_CMD_UiOpened_Online:"M_CMD_UiOpened_Online",M_CMD_UiOpened_Mail:"M_CMD_UiOpened_Mail",M_CMD_UiOpened_Integral:"M_CMD_UiOpened_Integral",M_CMD_ShowAmuletPokedex:"M_CMD_ShowAmuletPokedex",M_CMD_ShowAmuletDetail:"M_CMD_ShowAmuletDetail",M_CMD_ShowCard:"M_CMD_ShowCard",M_CMD_ShowTalisman:"M_CMD_ShowItem",M_CMD_ShowPVPMarshalling:"M_CMD_ShowPVPChange",M_CMD_ShowPVPFightWindow:"M_CMD_ShowPVPFightWindow",M_CMD_ShowPVPVS:"M_CMD_ShowPVPVS",M_CMD_SkillStatus:"M_CMD_SKILLSTATUS",M_CMD_Login:"M_CMD_Login",M_CMD_FIGHT_GiveUpOrFight:"GIVEUPORFIGHT",M_CMD_Fight_Suspend:"M_CMD_FIGHT_SUSPEND",M_CMD_FIGHT_CONTINUE:"M_CMD_FIGHT_CONTINUE",M_CMD_FIGHT_MonsterKilled:"M_CMD_FIGHT_MonsterKilled",M_CMD_FIGHT_MonsterHitted:"M_CMD_FIGHT_MonsterHitted",M_CMD_FIGHT_HIT_ENEMY:"M_CMD_FIGHT_HIT_ENEMY",M_CMD_FIGHT_HIT_MINE:"M_CMD_FIGHT_HIT_MINE",M_CMD_RoleAttack:"M_CMD_RoleAttack",M_CMD_PetAttack:"M_CMD_PetAttack",M_CMD_SoldierLifeChanged:"M_CMD_SoldierLifeChanged",M_CMD_ArmyDestory:"M_CMD_ArmyDestory",M_CMD_HangUp:"M_CMD_HangUp",PVP_SRART:"PVP_SRART",PVP_StartComeIn:"PVP_StartComeIn",PVP_HIT_ROLE:"PVP_HIT_ROLE",PVP_EndAttack:"PVP_EndAttack",PVP_RemoveFightWindow:"PVP_RemoveFightWindow",PVP_CheckAttackData:"PVP_CheckAttackData",pvp_ChangTimeScale:"pvp_ChangTimeScale",SetTollgateProgress:"SetTollgateProgress",BossLifeProgress:"BossLifeProgress",BOSSTIME:"BOSSTIME",BOSSBONUS:"BOSSSTONE",TASK_FINISHED_NUM:"TASK_FINISHED_NUM",TASK_GET_LIST:"TASK_GET_LIST",M_DAT_PetList:"PET_GET_LIST",M_DAT_TalismanList:"ITEM_GET_LIST",M_DAT_CardList:"GHOST_GET_LIST",M_DAT_MarshallingList:"Marshalling_GET_LIST",M_DAT_Amulet:"M_AT_AMULET",M_DAT_Change_Money:"M_AT_CHANGE_MONEY",M_AT_CHANGE_OFFLINE:"M_AT_CHANGE_OFFLINE",M_AT_STATUSLIST:"STATUS_LIST",M_AT_STATUS_Power:"M_AT_STATUS_Power",M_DAT_Status_PowerClick:"M_AT_STATUS_PowerClick",M_AT_EFFECTS:"M_AT_EFFECTS",M_AT_ACTIONEXECUTE:"M_AT_ACTIONEXECUTE",M_AT_SyncCheckpoint:"M_AT_SyncCheckpoint",M_AT_BattleWithFlyBoss:"M_AT_BattleWithFlyBoss",M_AT_EventHandleResult:"M_AT_EventHandleResult",M_AT_ReturnTollgate:"M_AT_ReturnTollgate",M_AT_GUIDE:"M_AT_GUIDE",SHOP_GET_LIST:"SHOP_GET_LIST",RANK_GET_LIST1:"RANK_GET_LIST1",RANK_GET_LIST2:"RANK_GET_LIST2",RANK_GET_LIST3:"RANK_GET_LIST3",M_DAT_MailList:"M_DAT_MailList",M_DAT_ActivityInfo:"M_DAT_ActivityInfo",Re_TaskInfo:"r_taskInfo",Re_FightInfo:"r_fightInfo",Re_ShopInfo:"r_shopInfo",Re_Status:"r_status",Re_RankInfo:"r_rankInfo",Re_PetInfo:"r_petInfo",Re_TalismanInfo:"r_talismanInfo",Re_CardtInfo:"r_cardInfo",Re_AmuletInfo:"r_amuletInfo",Re_MailInfo:"r_mailInfo",Re_ActivityInfo:"r_activityInfo",M_MS_FightStatusChg:"M_MS_FIGHTSTATUSCHG"},FacadeApp=function(t){function e(){var e=t.call(this)||this;e.notifyHandles={},e._requestFirstSet=[],e._requestSecondSet=[],e._currentNetCon=null,e.timerOfExpired=0,e.timerOfResent=0,e.timerOfActive=0,e.localStore=null,e.actionList={},e.SocketInit();var i=function(t){return function(t){return function(e){t(e)}}},n=redux.applyMiddleware(i)(redux.createStore);return e.localStore=n(reducers),e}return __extends(e,t),e.prototype.SocketInit=function(){var t=this;if(GameConfigOfRuntime.commMode==CommMode.socket){this.socket=io.connect(GameConfigOfRuntime.ServerUrl+":"+GameConfigOfRuntime.ServerPort,{forceNew:!0});var e=this;this.socket.on("connect",function(){e.trace("开始登录"),e.login(),e._currentNetCon&&(e._GetData(e._currentNetCon.ReqSet,e._currentNetCon.CompleteFun,e._currentNetCon.Router),e._currentNetCon=null)}),this.socket.on("disconnect",function(){e.trace("连接已断开"),e.socket.connect()}),this.socket.on("chat msg",function(t){e.timerOfExpired=0,e.trace("receive message: "+t)}),this.socket.on("active msg",function(t){e.timerOfExpired=0}),this.socket.on("notify",function(e){t.notifyHandles[e.type]?t.notifyHandles[e.type](e):t.notifyHandles["default"]&&t.notifyHandles["default"](e)}),this.watch(function(t){})}},e.prototype._NextSend=function(){this._currentNetCon=null,this._requestFirstSet.length>0?this._currentNetCon=this._requestFirstSet.shift():this._requestSecondSet.length>0&&(this._currentNetCon=this._requestSecondSet.shift()),null!=this._currentNetCon&&this._GetData(this._currentNetCon.ReqSet,this._currentNetCon.CompleteFun,this._currentNetCon.Router)},e.prototype._GetData=function(t,i,n){var a=this;void 0===n&&(n="q");var o="q"==n?"sessionid":"id",r=o+"="+UnitManager.PlayID+"&act=";if(null!=t)for(var s=0;s<t.length;s++)r+=t[s];switch(GameConfigOfRuntime.commMode){case CommMode.socket:if(this.socket.disconnected)this.socket.connect();else{this._currentSendUrl=n+"?"+r;var c=i[0];this.socket.emit("req",{url:this._currentSendUrl},function(t){a.timerOfExpired=0;var e=t;null!=e&&"undefined"!=typeof e.code&&null!=e.code&&c(e)}),this._currentNetCon=null}break;default:this._currentSendUrl=GameConfigOfRuntime.ServerUrl+":"+GameConfigOfRuntime.ServerPort+"/public/"+n+"?"+r,console.log(this._currentSendUrl);var l=new egret.URLLoader;l.dataFormat=egret.URLLoaderDataFormat.TEXT,i.length>1&&i[1]&&l.addEventListener(egret.IOErrorEvent.IO_ERROR,i[1],this);var u=new egret.URLRequest(this._currentSendUrl);u.method=egret.URLRequestMethod.GET,l._request=u,l.addEventListener(egret.Event.COMPLETE,function(t){if(null==t)return void a._NextSend();var n=t.target;try{var o=JSON.parse(n.data);o.code!=e.SuccessCode&&(console.log(e._errorCodeSet[o.code.toString()]),console.log("发送链接："+a._currentSendUrl)),i[0](o),a._NextSend()}catch(r){console.log("消息处理出错,发送链接："+a._currentSendUrl),console.log(r),i.length>1&&i[1]&&i[1](r),a._NextSend()}},this),l.load(l._request)}},e.prototype.SendRequest=function(t,i,n,a){switch(void 0===n&&(n=!0),void 0===a&&(a="q"),null==e._errorCodeSet&&e._InitErrorCode(),GameConfigOfRuntime.commMode){case CommMode.socket:this.socket.disconnected?(this._currentNetCon=new NetContent(t,i,a),this.socket.connect()):this._GetData(t,i,a);break;default:var o=new NetContent(t,i,a);n?this._requestFirstSet.push(o):this._requestSecondSet.push(o),null==this._currentNetCon&&this._NextSend()}},e.fetchData=function(t,i,n,a){void 0===n&&(n=!0),void 0===a&&(a="q"),e.inst.SendRequest(t,i,n,a)},e.PromisifyFetch=function(t){return new Promise(function(i,n){try{e.fetchData(t,[function(t){i(t)},function(t){n(t)}],!0,"q")}catch(a){n(a)}})},e.PromisifyFetchList=function(t){try{return Promise.all(t.map(function(t){return e.PromisifyFetch(t)}))}catch(i){return console.log(JSON.stringify(i)),null}},e.prototype.login=function(){this.socket.emit("login msg",{name:"1",password:"pwd",room:"Mary"},function(t){switch(t.code){case"0":break;case"1":break;case"2":break;case"3":}})},e.ShowError=function(t){UIPage.inst(UIPage).ShowTrottingHorseLampWindow(e._errorCodeSet[t])},e.prototype.trace=function(t){console.log(t)},e.prototype.SendChatMsg=function(t){GameConfigOfRuntime.commMode==CommMode.socket&&this.socket&&this.socket.connected&&this.socket.emit("chat msg",t)},e.prototype.Process=function(t){this.timerOfResent+=t,this.timerOfResent>=15e3&&(this.timerOfResent=0,null!=e.inst._currentNetCon&&(console.log("消息处理超时,链接："+this._currentSendUrl),this._NextSend())),GameConfigOfRuntime.commMode==CommMode.socket&&(this.timerOfExpired+=t,this.timerOfActive+=t,this.timerOfActive>=15e3&&(this.timerOfActive=0,this.socket.emit("active msg")),this.timerOfExpired>=6e4&&(this.timerOfExpired=0,this.socket.disconnected?this.socket.connect():this.socket.disconnect()))},e.prototype.startUp=function(t){this.sendNotification(e.STARTUP,t),this.removeCommand(e.STARTUP)},e.prototype.initializeController=function(){t.prototype.initializeController.call(this),this.registerCommand(e.STARTUP,StartupCommand)},e.dispatchAction=function(t,i){if(null!=i){var n=null;-1!=Object.keys(e.inst.actionList).indexOf(t)&&(n=e.inst.actionList[t]),null!=n&&e.inst.localStore.dispatch(n(i))}var a=e.listeners[t];if(a)for(var o=a.length,r=0;o>r;r++){var s=a[r];s.notify(t,i)}},e.Notify=function(t,i,n){e.inst.sendNotification(t,i,n)},e.AddListener=function(t,i,n){var a=e.listeners[t];a||(e.listeners[t]=[]),e.listeners[t].push(new Observer(i,n))},e.RemoveListener=function(t,i,n){var a=e.listeners[t];if(a){for(var o=a.length,r=0;o>r;r++){var s=a[r];if(s.compar(n)){a.splice(r,1);break}}0==a.length&&delete e.listeners[t]}},e.prototype.registerAction=function(t,e){this.actionList[t]=e},e.read=function(t,e){return"undefined"==typeof e||null==e?this.inst.localStore.getState()[t]:this.inst.localStore.getState()[t][e]},e.cr=function(t,e){return function(i,n){return void 0===i&&(i=t),e.hasOwnProperty(n.type)?e[n.type](i,n):i}},e.ca=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var a={type:t};return e.forEach(function(t,n){a[e[n]]=i[n]}),a}},Object.defineProperty(e,"inst",{get:function(){return null==this.instance&&(this.instance=new e),this.instance},enumerable:!0,configurable:!0}),e.Calc=function(t,e){return this.read(CommandList.Re_Status).Calc(t,e)},e._InitErrorCode=function(){e._errorCodeSet={2001:"活动已结束",0:"操作成功",1:"非法用户",101:"非法任务索引",102:"任务奖励已领取",103:"任务尚未完成",201:"建筑等级已达最大",202:"建筑物无需修复",301:"敌人金币不足",302:"指定目标用户不存在",303:"打招呼冷却中",304:"当前是敌人",305:"当前是朋友",306:"好友数量超限",307:"没有发现合适的偷取对象",308:"没有发现合适的攻击对象",309:"受限行为达到最大次数",310:"自己当前是奴隶",311:"奴隶数量超出限制",312:"已被他人抓获",313:"战斗失利，抓捕失败",314:"战斗失利，逃跑失败",315:"已被自己抓获",401:"宠物尚未开始孵化",402:"指定宠物不存在",403:"达到宠物数量上限",404:"角色达到最大等级",501:"指定道具不存在",502:"指定道具数量不足",503:"指定道具已拥有",504:"指定道具当前无法购买",601:"关卡：用时太短",602:"关卡：用时太长",603:"关卡：体力不足",604:"关卡：尚未开始",605:"关卡：战斗中",606:"关卡：扫荡中",607:"关卡：领奖中",608:"关卡：异常得分",609:"关卡：异常关卡号",610:"关卡：未注册(抓捕或起义)",701:"角色：角色碎片数量不足",801:"当日奖励已经领取",901:"活动: 奖励已领取",902:"活动：没有上榜",903:"活动：没有开始",9e3:"未知错误",9001:"非法数据",9002:"数据为空",9003:"金币不足",9004:"体力不足",9005:"数据库错误",9006:"第三方平台校验失败",9007:"由于客户端上行了无法解析的路由信息，导致服务端路由失败",9008:"连接数太多",9009:"元宝不足",2002:"活动未开始",2003:"当前关卡编号错误",2004:"消灭怪物数量未达标",2005:"战斗结果异常",2006:"战斗超时",2007:"用时太短，有外挂嫌疑",2008:"冷却时间未到",2009:"商品不存在",2010:"达到数量限制",2011:"元宝不足",2012:"金币不足",2013:"专属碎片不足",2014:"达到最大等级",2015:"通用：数量不足",2016:"无法激活图腾：关联魔宠未激活",2018:"处于挂机状态",2019:"权限不足",2020:"成员满",2021:"用户不存在",2022:"联盟不存在",2023:"已经加入了联盟",2024:"入盟申请不存在",2025:"数据不存在",2026:"荣誉会员，不能开除",2027:"敌对关系",2028:"己方宣战数量满",2029:"敌方宣战数量满",2030:"入盟CD中",2031:"等待批准加入",2032:"战力不足",2033:"没有加入联盟",2034:"数据错误，稍后再试",2035:"缓存管理器错误",3001:"缺少通用升级碎片",3002:"缺少专有升星碎片",3003:"缺少专有升阶碎片"}},e.prototype.watch=function(t,e){return void 0===e&&(e="default"),this.notifyHandles[e]=t,this},e}(puremvc.Facade);FacadeApp.SuccessCode=0,FacadeApp.STARTUP="STARTUP",FacadeApp.listeners={},__reflect(FacadeApp.prototype,"FacadeApp",["puremvc.IFacade","puremvc.INotifier"]);var CommMode;!function(t){t[t.web=0]="web",t[t.socket=1]="socket"}(CommMode||(CommMode={}));var StartupCommand=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.initializeMacroCommand=function(){this.addSubCommand(ControllerPrepCommand)},e}(puremvc.MacroCommand);__reflect(StartupCommand.prototype,"StartupCommand");var Observer=function(){function t(t,e){this.callback=null,this.context=null;var i=this;i.callback=t,i.context=e}return t.prototype.notify=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;(n=i.callback).call.apply(n,[i.context].concat(t));var n},t.prototype.compar=function(t){return t==this.context},t}();__reflect(Observer.prototype,"Observer");var NetContent=function(){function t(t,e,i){this._reqSet=t,this._completeFun=e,this._router=i}return Object.defineProperty(t.prototype,"ReqSet",{get:function(){return this._reqSet},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CompleteFun",{get:function(){return this._completeFun},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Router",{get:function(){return this._router},enumerable:!0,configurable:!0}),t}();__reflect(NetContent.prototype,"NetContent");var APanel=function(t){function e(e){var i=t.call(this)||this;return i._stopBattle=!0,i.onUnRegister=null,i.skinName=e,i.addEventListener(eui.UIEvent.CREATION_COMPLETE,i._ComponentWillMount,i),i.addEventListener(eui.UIEvent.ADDED_TO_STAGE,i._ComponentDidMount,i),i}return __extends(e,t),e.prototype._ComponentWillMount=function(){this.removeEventListener(eui.UIEvent.CREATION_COMPLETE,this._ComponentWillMount,this),this.ComponentWillMount()},e.prototype._ComponentDidMount=function(){this.ComponentDidMount()},e.prototype.ComponentWillMount=function(){},e.prototype.ComponentDidMount=function(){},e.prototype.RegisterDataSource=function(t){var e=this;t.map(function(t){FacadeApp.AddListener(t,function(){e.Render()})})},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},e.prototype.onAccess=function(){this._stopBattle&&FacadeApp.dispatchAction(CommandList.M_CMD_Fight_Suspend)},e.prototype.Register=function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=null),this._stopBattle=e,this.onUnRegister=i,t.addChild(this),this.onAccess(),this},e.prototype.UnRegister=function(){this._stopBattle&&FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_CONTINUE),null!=this.parent&&this.parent.removeChild(this)},e.prototype.CloseWindow=function(){this.onUnRegister&&this.onUnRegister(),SoundManager.PlayCloseWinMusic(),egret.Tween.removeTweens(this);var t=egret.Tween.get(this);t.to({y:GameConfigOfRuntime.panelInitY+6},83).to({y:GameConfigOfRuntime.panelInitY},83).to({y:GameConfigOfRuntime.panelInitY-26},250).to({y:GameConfigOfRuntime.gameHeight},250),this.UnRegister()},e.prototype.BouncedPanel=function(t){SoundManager.PlayOpenWinMusic(),egret.Tween.removeTweens(this);var e=egret.Tween.get(this);return t?e.to({y:-26},250).to({y:0},83).to({y:6},83):e.to({y:GameConfigOfRuntime.panelInitY-26},208).to({y:GameConfigOfRuntime.panelInitY},250).to({y:GameConfigOfRuntime.panelInitY+6},83).to({y:GameConfigOfRuntime.panelInitY},83),this},e.prototype._UpOrDown=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),egret.Tween.removeTweens(this);var n=egret.Tween.get(this);if(t?n.to({y:GameConfigOfRuntime.panelInitY+26},250).to({y:GameConfigOfRuntime.panelInitY},250).to({y:-26},250).to({y:0},250).to({y:6},83).to({y:0},83):n.to({y:6},83).to({y:0},83).to({y:-26},250).to({y:GameConfigOfRuntime.panelInitY},250).to({y:GameConfigOfRuntime.panelInitY+26},250).to({y:GameConfigOfRuntime.panelInitY},250),null!=e){egret.Tween.removeTweens(e);var a=egret.Tween.get(e),o=egret.Tween.get(e.viewport),r=250,s=e.viewport.scrollV;t?(a.to({height:r-26},250).to({height:r},250).to({height:GameConfigOfRuntime.panelListHeight+26},250).to({height:GameConfigOfRuntime.panelListHeight},250).to({height:GameConfigOfRuntime.panelListHeight-6},83).to({height:GameConfigOfRuntime.panelListHeight},83),o.to({scrollV:s},500).to({scrollV:Math.max(s-(GameConfigOfRuntime.panelListHeight-r),0)},350)):(a.to({height:GameConfigOfRuntime.panelListHeight-6},83).to({height:GameConfigOfRuntime.panelListHeight},83).to({height:GameConfigOfRuntime.panelListHeight+26},250).to({height:r},250).to({height:r-26},250).to({height:r},250),e.viewport.scrollV+=1)}},e.inst=function(t){return null==this._inst&&(this._inst=new t),this._inst},e}(eui.Component);APanel._inst=null,__reflect(APanel.prototype,"APanel");var aniControlStatus={StartWave:1},APanelList=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.genericsInstance=null,e.GetDataFromDb=null,e.aniControl=0,e.firstOpen=!0,e}return __extends(e,t),e.prototype.InitComponent=function(t,e,i,n,a){this.myGroup=t,this.myScroller=e,this.genericsInstance=i,this.GetDataFromDb=n,a&&(this.aniControl=a)},e.prototype.ScrollToBottom=function(){var t=this;setTimeout(function(){t.myScroller.viewport.scrollV+t.myScroller.height<t.myScroller.viewport.contentHeight&&(t.myScroller.viewport.scrollV+=10,t.ScrollToBottom())},20)},e.prototype.DelItemBySpecial=function(t){var e=this;return new Promise(function(i){var n=e.GetIndexBySpecial(t);if(n>=0){var a=e.myGroup.getChildAt(n);if(a.anchorOffsetY=a.height/2,a)return new Promise(function(t){var i=egret.Tween.get(a);return i.to({skewX:90,y:a.y+a.height/2},200).to({skewX:180,y:a.y+a.height/2},200).call(function(){e.myGroup.removeChild(a);var t=0;return Promise.all(e.myGroup.$children.map(function(e){var i=e;return null==i.getId?null:new Promise(function(i){egret.Tween.get(e).to({y:t++*e.height},300).call(function(){i()})})}))})});i()}})},e.prototype.GetIndexBySpecial=function(t){for(var e=0;e<this.myGroup.numChildren;e++){var i=this.myGroup.getChildAt(e);if(null!=i.getId&&i.getId==t)return e}return-1},e.prototype.GetItemBySpecial=function(t){for(var e=0;e<this.myGroup.numChildren;e++){var i=this.myGroup.getChildAt(e);if(null!=i.getId&&i.getId.toString()==t)return i}return null},e.prototype.UnRegister=function(){t.prototype.UnRegister.call(this),this.myGroup.$children.map(function(t){egret.Tween.get(t).to({x:-700},0)})},e.prototype.AddItem=function(t,e){for(var i=0,n=0;n<this.myGroup.numChildren;n++){var a=this.myGroup.getChildAt(n);null!=a.getId||(i+=1)}t.y=(this.myGroup.numChildren-i)*t.height,this.myGroup.addChild(t)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,a,o,r,s,c=this;return __generator(this,function(l){switch(l.label){case 0:for(t=this.GetDataFromDb.length,e=Indicator.getChecker(this.aniControl)(aniControlStatus.StartWave)&&this.firstOpen,i=[],n=[],a=function(a){var r=o.GetDataFromDb[a](),s=r[0],l=r[1];if(n.push(l),l.map(function(t){var i=c.GetItemBySpecial(t),n=s[t]?s[t]:s;i?(i.x=e?-700:0,i.update(n)):(i=c.genericsInstance[a](),i.x=e?-700:0,i.update(n),c.AddItem(i,a),c.firstOpen||c.ScrollToBottom())}),e){var u=0;o.myGroup.$children.map(function(t){egret.Tween.get(t).wait(150*u++).to({x:80+10*u},300).to({x:-50-10*u},200).to({x:0},100)})}o.myGroup.$children.map(function(e){var a=e,o=!1;if(null!=a.getId){for(var r=0;r<n.length;r++)if(n[r].indexOf(a.getId+"")>=0){o=!0;break}}else o=!0;0==o&&n.length>=t&&i.push(a)})},o=this,r=0;t>r;r++)a(r);l.label=1;case 1:return i.length>0?(s=i.pop(),[4,this.DelItemBySpecial(s.getId)]):[3,3];case 2:return l.sent(),[3,1];case 3:return this.firstOpen=!1,[2]}})})},e.genericsFactory=function(t){return new t},e}(APanel);APanelList.LineProSet=[],__reflect(APanelList.prototype,"APanelList");var SoldierManage;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._id=0,i._name="",i._level=1,i._desc="",i._damage=new Digit([0,0]),i.timerOfResent=0,i._life=new Digit([0,0]),i.unitType=t.SoldierType.hero,i.traitType=t.SoldierTrait.None,i.createStatusMachine(t.SoldierStatusList.ready),i}return __extends(i,e),i.prototype.onInit=function(){},i.prototype.onReturn=function(){},i.prototype.onReady=function(t,e,i){},i.prototype.onRunning=function(t,e,i){},i.prototype.onHit=function(t,e,i,n){},i.prototype.onDeath=function(t,e,i){},i.prototype.onSuspend=function(t,e,i){},i.prototype.onBeforeattacking=function(t,e,i){},i.prototype.onAttacking=function(t,e,i,n){},i.prototype.onMove=function(t,e,i){this._armature.animation.gotoAndPlay("move")},i.prototype.onStand=function(t,e,i){this._armature.animation.gotoAndPlay("stand")},i.prototype.createStatusMachine=function(e){var i=this;this.status=StateMachine.create({initial:{state:e,event:"initialize"},events:[{name:"attacked",from:"*",to:t.SoldierStatusList.hit},{name:"killed",from:"*",to:t.SoldierStatusList.death},{name:"start",from:t.SoldierStatusList.ready,to:t.SoldierStatusList.running},{name:"attackingEvent",from:"*",to:t.SoldierStatusList.attacking},{name:"stop",from:"*",to:t.SoldierStatusList.suspend},{name:"continue",from:t.SoldierStatusList.suspend,to:t.SoldierStatusList.running},{name:"moveEvent",from:"*",to:t.SoldierStatusList.move},{name:"standEvent",from:"*",to:t.SoldierStatusList.stand}],callbacks:{onattacked:function(t,e,n,a){i.onHit(t,e,n,a)},onkilled:function(t,e,n){i.onDeath(t,e,n)},onready:function(t,e,n){i.onReady(t,e,n)},onrunning:function(t,e,n){i.onRunning(t,e,n)},onstop:function(t,e,n){i.onSuspend(t,e,n)},onbeforeattackingEvent:function(t,e,n){i.onBeforeattacking(t,e,n)},onattackingEvent:function(t,e,n,a){i.onAttacking(t,e,n,a)},onmoveEvent:function(t,e,n){i.onMove(t,e,n)},onstandEvent:function(t,e,n){i.onStand(t,e,n)}},error:function(t,e,i,n,a,o){return"event "+t+": "+o}}),this.status.start()},Object.defineProperty(i.prototype,"Life",{get:function(){return this._life},set:function(e){switch(this._life=e.max(0),this.unitType){case t.SoldierType.boss:FacadeApp.dispatchAction(CommandList.BossLifeProgress,this._life.clone.Mul(100).Div(this._totalLife).Number);break;case t.SoldierType.monster:this._monsterLifeBar&&(this._monsterLifeBar.visible=!this._life.Equal(this._totalLife)),this._monsterLifeBar.value=this._life.clone.Mul(100).Div(this._totalLife).Number;break;default:FacadeApp.dispatchAction(CommandList.M_CMD_SoldierLifeChanged,{id:this.ID,cur:this._life.clone,left:this._life.clone.Mul(100).Div(this._totalLife).Number})}this._life.Larger(0)||(this.unitType==t.SoldierType.monster||this.unitType==t.SoldierType.boss)&&this.status.killed()},enumerable:!0,configurable:!0}),i.prototype.RemoveArmature=function(){null!=this._armature&&(MovieManage.RemoveArmature(this._armature),this._armature.display.parent&&this._armature.display.parent.removeChild(this._armature.display),this._armature=null)},i.prototype.RemoveTweenAndSetTimeout=function(){},i.prototype.Framing=function(t){},Object.defineProperty(i.prototype,"Damage",{get:function(){return this._damage},set:function(t){this._damage=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalLife",{get:function(){return this._totalLife},set:function(t){this._totalLife=t.max(0)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MonsterHeight",{get:function(){return this._armature?this._armature.display.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Trait",{get:function(){return this.traitType},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ID",{get:function(){return this._id},set:function(t){this._id=t},enumerable:!0,configurable:!0}),i}(egret.Sprite);t.Soldier=e,__reflect(e.prototype,"SoldierManage.Soldier",["IObjectPool"])}(SoldierManage||(SoldierManage={}));var PVPManager;!function(t){t.SoldierStatusList={noReady:"noReady",ready:"ready",move:"move",attackBefore:"attackBefore",attacking:"attacking",attackEnd:"attackEnd",death:"death",wait:"wait",interrupted:"interrupted",seeThrough:"seeThrough",effectChange:"effectChange"};var e;!function(t){t[t.pvpMineHero=0]="pvpMineHero",t[t.pvpEnemyHero=1]="pvpEnemyHero",t[t.pvpMinePet=2]="pvpMinePet",t[t.pvpEnemyPet=3]="pvpEnemyPet"}(e=t.SoldierType||(t.SoldierType={}));var i=function(i){function n(){var n=i.call(this)||this;return n.unitType=e.pvpMineHero,n._isMineArmy=!1,n._direction=1,n._roleid=0,n._posiXYSet=null,n._uid=0,n._name="",n._level=1,n._desc="",n._skillArmaSet=[],n._buffArmaSet=[],n.AttackAniGroupName="",n.site=2,n._allEventIndex=[],n._isRoleAniComplete=!0,n._isRoleTweenComplete=!0,n._isSkillAniComplete=!0,n._isSkillTweenComplete=!0,n._isHitEffectComplete=!0,n.curAniIndex=0,n._hitAniSet=[],n.createStatusMachine(t.SoldierStatusList.noReady),FacadeApp.AddListener(CommandList.pvp_ChangTimeScale,n.changeRoleTimeScale.bind(n),n),n}return __extends(n,i),n.prototype.onInit=function(){},n.prototype.onReturn=function(){},n.prototype.createStatusMachine=function(e){var i=this;this.status=StateMachine.create({initial:{state:e,event:"initialize"},events:[{name:"ChangeReady",from:t.SoldierStatusList.noReady,to:t.SoldierStatusList.ready},{name:"ChangeMove",from:"*",to:t.SoldierStatusList.move},{name:"ChangeReadyAttack",from:"*",to:t.SoldierStatusList.attackBefore},{name:"ChangeAttacking",from:"*",to:t.SoldierStatusList.attacking},{name:"ChangeAttackLater",from:"*",to:t.SoldierStatusList.attackEnd},{name:"ChangeDeath",from:"*",to:t.SoldierStatusList.death},{name:"ChangeWait",from:"*",to:t.SoldierStatusList.wait},{name:"ChangeInterrupted",from:"*",to:t.SoldierStatusList.interrupted},{name:"ChangeSeeThrough",from:"*",to:t.SoldierStatusList.seeThrough},{name:"ChangeEffectChange",from:"*",to:t.SoldierStatusList.effectChange}],callbacks:{onChangeReady:function(t,e,n){i.onReady(t,e,n)
},onChangeMove:function(t,e,n){i.onMove(t,e,n)},onChangeReadyAttack:function(t,e,n,a){i.onReadyAttack(t,e,n,a)},onChangeAttacking:function(t,e,n,a){i.onAttacking(t,e,n,a)},onChangeAttackLater:function(t,e,n){i.onAttackLater(t,e,n)},onChangeDeath:function(t,e,n){i.onDeath(t,e,n)},onChangeWait:function(t,e,n){i.onWait(t,e,n)},onChangeInterrupted:function(t,e,n){i.onInterrupted(t,e,n)},onChangeSeeThrough:function(t,e,n){i.onSeeThrough(t,e,n)},onChangeEffectChange:function(t,e,n,a){i.onEffectChange(t,e,n,a)}},error:function(t,e,i,n,a,o){return"event "+t+": "+o}})},n.prototype.onReady=function(t,e,i){},n.prototype.onMove=function(t,e,i){},n.prototype.onReadyAttack=function(t,e,i,n){},n.prototype.onAttacking=function(t,e,i,n){},n.prototype.onAttackLater=function(t,e,i,n){},n.prototype.onDeath=function(t,e,i){},n.prototype.onWait=function(t,e,i){},n.prototype.onInterrupted=function(t,e,i){},n.prototype.onSeeThrough=function(t,e,i){},n.prototype.onEffectChange=function(t,e,i,n){},n.prototype.HitFun=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,a,o=this;return __generator(this,function(r){return e==t.AttrChangedType.Damage||e==t.AttrChangedType.Bang?(this.creatHitEffectRes(i),this.status.current==t.SoldierStatusList.wait&&this.PlayRoleAnimation("hit1",1)):e==t.AttrChangedType.Recover?this.creatHitEffectRes(i):e==t.AttrChangedType.Miss?this.status.current==t.SoldierStatusList.wait&&(n=100*this._direction,this.PlayRoleAnimation("move",0),a=this._posiXYSet[this.site].x,egret.Tween.get(this).to({x:a-n},150/t.PVPFightManager.TIMESCALE).to({x:a},150/t.PVPFightManager.TIMESCALE).call(function(){"move"==o._roleArmature.curPlayName&&o.status.current==t.SoldierStatusList.wait&&o.PlayRoleAnimation("move",0),o.judgeAndClearCurFightData()},this)):e==t.AttrChangedType.Parry?this.status.current==t.SoldierStatusList.wait&&(this._roleid==t.AllRoleId.wukong?this.PlayRoleAnimation("block",1):this.PlayRoleAnimation("hit1",1)):e==t.AttrChangedType.Poisoned?this.status.current==t.SoldierStatusList.wait&&this.PlayRoleAnimation("hit1",1):(console.log("其他受击动作"),this.status.current==t.SoldierStatusList.wait&&this.PlayRoleAnimation("hit1",1)),[2]})})},n.prototype.creatHitEffectRes=function(e){return __awaiter(this,void 0,void 0,function(){var i,n,a,a,o,r,s,c,l,u,h=this;return __generator(this,function(p){switch(p.label){case 0:return i=null,t.AttrChangedType.ShouJiRes(e).isCreat?[4,t.PVPArmatureManager.CreatHitEffectAni(this,e)]:[3,2];case 1:return i=p.sent(),this._hitAniSet.push(i),[3,10];case 2:return e!=t.RoleAttackAniGroupNames.WuKong_QianChong?[3,3]:(n=250*this._direction,a=this._posiXYSet[this.site].x,egret.Tween.get(this).to({x:a-n},200).wait(100).to({x:a},200).call(function(){},this),[3,10]);case 3:return e!=t.RoleAttackAniGroupNames.WuKong_BaJiaoShan?[3,7]:this.status.current==t.SoldierStatusList.wait&&Math.abs(this.y-this._posiXYSet[this.site].y)<=30?(a=this._posiXYSet[this.site].x,o=this._posiXYSet[this.site].y,r=Math.floor(2*Math.random()),s=[[0,640],[640,0]],c=[400*Math.random()+100,100*Math.random()+300,400*Math.random()+100],("move"==this._roleArmature.curPlayName||"stand"==this._roleArmature.curPlayName)&&(this._roleid==t.AllRoleId.wukong?this.PlayRoleAnimation("hit2",0):this.PlayRoleAnimation("hit1",0),egret.Tween.get(this).to({x:s[r][0],y:c[0],rotation:180},250).call(function(){FacadeApp.dispatchAction(CommandList.M_CMD_ZhenPing)}).to({x:c[1],y:300,rotation:0},250).call(function(){FacadeApp.dispatchAction(CommandList.M_CMD_ZhenPing)}).to({x:s[r][1],y:c[2],rotation:180},250).call(function(){FacadeApp.dispatchAction(CommandList.M_CMD_ZhenPing)}).to({x:a,y:o,rotation:0},250).call(function(){h.status.current==t.SoldierStatusList.wait&&h.PlayRoleAnimation("move",0)},this)),[3,6]):[3,4];case 4:return[4,t.PVPArmatureManager.CreatHitEffectAni(this,e)];case 5:i=p.sent(),this._hitAniSet.push(i),p.label=6;case 6:return[3,10];case 7:return e!=t.RoleAttackAniGroupNames.CommAttack_yinyangerqiping&&e!=t.RoleAttackAniGroupNames.CommAttack_jinnao&&e!=t.RoleAttackAniGroupNames.CommAttack_zijinhonghulu&&e!=t.RoleAttackAniGroupNames.CommAttack_renzhongdai?[3,10]:this.status.current==t.SoldierStatusList.wait&&Math.abs(this.y-this._posiXYSet[this.site].y)<=30?(l=173,u=450,("move"==this._roleArmature.curPlayName||"stand"==this._roleArmature.curPlayName)&&(this._roleid==t.AllRoleId.wukong?this.PlayRoleAnimation("hit2",0):this.PlayRoleAnimation("hit1",0),this._isMineArmy&&(l=481),egret.Tween.get(this).to({x:l,y:u,rotation:1520,scaleX:.1,scaleY:.1},500).wait(1e3).to({x:this._posiXYSet[this.site].x,y:this._posiXYSet[this.site].y,rotation:0,scaleX:1,scaleY:1},500).call(function(){h.status.current==t.SoldierStatusList.wait&&h.PlayRoleAnimation("move",0)},this)),[3,10]):[3,8];case 8:return[4,t.PVPArmatureManager.CreatHitEffectAni(this,e)];case 9:i=p.sent(),this._hitAniSet.push(i),p.label=10;case 10:return[2]}})})},n.prototype.createArmature=function(){return __awaiter(this,void 0,void 0,function(){var e,i,n,a,o;return __generator(this,function(r){switch(r.label){case 0:return this.RemoveArmature(this._roleArmature),e=this._roleid,null==t.ArmyRoleResNameSet[this._roleid]&&(e=0),i=t.ArmyRoleResNameSet[e].res,n=this,[4,MovieManage.PromisifyGetDragonBonesMovie(i,this)];case 1:return n._roleArmature=r.sent(),this._roleArmature.display.scaleX=t.ArmyRoleResNameSet[e].scaleX,this._roleArmature.display.scaleY=t.ArmyRoleResNameSet[e].scaleY,this._isMineArmy||(this._roleArmature.display.scaleX*=-1),this._roleArmature.Height=t.ArmyRoleResNameSet[e].Height,this._roleArmature.Width=t.ArmyRoleResNameSet[e].Width,this._isMineArmy||(a=[1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],o=new egret.ColorMatrixFilter(a),this._roleArmature.display.filters=[o]),this._roleArmature.animation.timeScale=1,this._roleArmature.animation.timeScale=FacadeApp.Calc(effectEnum.HeroAttackSpeed,1),this._roleArmature.animation.timeScale*=t.PVPFightManager.TIMESCALE,this._roleArmature.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.RoleArmComplete.bind(this),this),this.status.ChangeWait(),this.addChild(this._roleArmature.display),this.creatLife(),[2]}})})},n.prototype.creatLife=function(){null==this._pvpRoleLifeBar&&(this._pvpRoleLifeBar=new PVPRoleLife),this.addChild(this._pvpRoleLifeBar),this._pvpRoleLifeBar.x=-this._pvpRoleLifeBar.width/2,this._pvpRoleLifeBar.y=-this.RoleHeight-this._roleArmature.display.y,this._pvpRoleLifeBar.slideDuration=500},n.prototype.PlayRoleSkillAniFun=function(){return __awaiter(this,void 0,void 0,function(){var e,i,i,n,a,o,r;return __generator(this,function(s){switch(s.label){case 0:if(!this.curAniGroup&&this.curAniIndex>=this.curAniGroup.length)return[2];if(this.curAniGroup[this.curAniIndex].hit&&"startHit"==this.curAniGroup[this.curAniIndex].hit&&(e=this.Army.getHitRoleObject(this.site)))for(i=0;i<e.length;i++)FacadeApp.dispatchAction(CommandList.PVP_HIT_ROLE,{aniName:this.AttackAniGroupName,site:e[i],jiduan:t.RoleAttackAniGroupNames.getHitNum(this.AttackAniGroupName),eventIndex:this.Army.eachFightDataSet[this.site][0].EventIndex});return"mine"!=this.curAniGroup[this.curAniIndex].type?[3,1]:(this.RoleAniComplete=!1,this._roleArmature.aniData=this.curAniGroup[this.curAniIndex],this.PlayRoleAnimation(this.curAniGroup[this.curAniIndex].aniName,1),this.curAniIndex+=1,[3,4]);case 1:return"newDragon"!=this.curAniGroup[this.curAniIndex].type&&"newImage"!=this.curAniGroup[this.curAniIndex].type&&"newParticle"!=this.curAniGroup[this.curAniIndex].type&&"newMovieClip"!=this.curAniGroup[this.curAniIndex].type?[3,3]:(this.SkillAniComplete=!1,[4,this.creatSkillArmature(this.curAniGroup[this.curAniIndex],this.curAniIndex)]);case 2:return s.sent(),this.curAniIndex+=1,[3,4];case 3:for(this.SkillAniComplete=!1,i=0;i<this._skillArmaSet.length;i++)this.curAniGroup[this.curAniIndex].isMulti||(n=this._skillArmaSet[i].hitData[0],a=this._skillArmaSet[i].hitData[2],o=1,n==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(o=2),r=t.ArmyOfPosiSet[o][a],this._skillArmaSet[i].display.x=r.x+this.curAniGroup[this.curAniIndex].oriXY[0]*this._direction,this._skillArmaSet[i].display.y=r.y+this.curAniGroup[this.curAniIndex].oriXY[1]),this._skillArmaSet[i].aniData=this.curAniGroup[this.curAniIndex],this._skillArmaSet[i].curAniIndex=this.curAniIndex,this._skillArmaSet[i].isClear=this.curAniGroup[this.curAniIndex].isClear,this._skillArmaSet[i].animation.gotoAndPlay(this.curAniGroup[this.curAniIndex].aniName,-1,-1,1);this.curAniIndex+=1,s.label=4;case 4:return this.AttackAniGroupName==t.RoleAttackAniGroupNames.WuKong_Comboo&&this.status.current==t.SoldierStatusList.attacking&&this.curAniIndex-1==0?this.visible=!1:this.visible=!0,this.curAniGroup[this.curAniIndex-1]&&this.curAniGroup[this.curAniIndex-1].isZhenPing&&"startZhenPing"==this.curAniGroup[this.curAniIndex-1].isZhenPing&&FacadeApp.dispatchAction(CommandList.M_CMD_ZhenPing),this.curAniGroup[this.curAniIndex]&&null!=this.curAniGroup[this.curAniIndex-1].isStop&&0==this.curAniGroup[this.curAniIndex-1].isStop&&this.PlayRoleSkillAniFun(),[2]}})})},n.prototype.creatSkillArmature=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,a,o,r,s,c,l;return __generator(this,function(u){switch(u.label){case 0:return n=this.Army.getHitRoleObject(this.site),null==n&&(n=[[this._uid,1,2]],console.log("没有受击目标,可能给自己释放技能")),a="dra","newImage"==e.type?a="ima":"newParticle"==e.type?a="par":"newMovieClip"==e.type&&(a="mov"),this.ClearSkillArmature(),e.isMulti?(r=(o=this._skillArmaSet).push,[4,t.PVPArmatureManager.creatSkillArmaRes(this,e,a,n[0],i)]):[3,2];case 1:return r.apply(o,[u.sent()]),[3,6];case 2:if(!n)return[3,6];s=0,u.label=3;case 3:return s<n.length?(l=(c=this._skillArmaSet).push,[4,t.PVPArmatureManager.creatSkillArmaRes(this,e,a,n[s],i)]):[3,6];case 4:l.apply(c,[u.sent()]),u.label=5;case 5:return s++,[3,3];case 6:return this.PlaySkillMoveFun(),("ima"==a||"par"==a)&&(this.SkillAniComplete=!0),[2]}})})},n.prototype.SkillArmatureCompleteFun=function(e){if(this.status.current==t.SoldierStatusList.attacking&&e.target._armature.aniData.hit&&"endHit"==e.target._armature.aniData.hit&&e.target._armature.aniData.isMulti&&this.SkillTweenComplete){var i=this.Army.getHitRoleObject(this.site);if(i)for(var n=0;n<i.length;n++)FacadeApp.dispatchAction(CommandList.PVP_HIT_ROLE,{aniName:this.AttackAniGroupName,site:i[n],jiduan:t.RoleAttackAniGroupNames.getHitNum(this.AttackAniGroupName),eventIndex:this.Army.eachFightDataSet[this.site][0].EventIndex})}this.SkillAniComplete=!0;var a=this._skillArmaSet[this._skillArmaSet.length-1];a&&a.isClear&&0==t.RoleAttackAniGroupNames.skillMoveAni(this.AttackAniGroupName,this.status.current,a.curAniIndex).isMove&&this.ClearSkillArmature(),this.judgeAndClearCurFightData()},n.prototype.SkillMovieClipCompleteFun=function(e){if(this.status.current==t.SoldierStatusList.attacking&&e.target.aniData.hit&&"endHit"==e.target.aniData.hit&&e.target.aniData.isMulti&&this.SkillTweenComplete){var i=this.Army.getHitRoleObject(this.site);if(i)for(var n=0;n<i.length;n++)FacadeApp.dispatchAction(CommandList.PVP_HIT_ROLE,{aniName:this.AttackAniGroupName,site:i[n],jiduan:t.RoleAttackAniGroupNames.getHitNum(this.AttackAniGroupName),eventIndex:this.Army.eachFightDataSet[this.site][0].EventIndex})}this.SkillAniComplete=!0;var a=this._skillArmaSet[this._skillArmaSet.length-1];a&&a.isClear&&0==t.RoleAttackAniGroupNames.skillMoveAni(this.AttackAniGroupName,this.status.current,a.curAniIndex).isMove&&this.ClearSkillArmature(),this.judgeAndClearCurFightData()},n.prototype.PlaySkillMoveFun=function(){var e=this,i=t.RoleAttackAniGroupNames.skillMoveAni(this.AttackAniGroupName,this.status.current,this.curAniIndex);if(i.isMove){this.SkillTweenComplete=!1;for(var n=this.Army.getHitRoleObject(this.site),a=this._skillArmaSet.length-1;a>=0;a--){var o=this._skillArmaSet[a];"dra"==this._skillArmaSet[a].type&&(o=this._skillArmaSet[a].display);var r=this._posiXYSet[this.site];if(i.isMulti&&null!=n){var s=1;n[0][0]==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(s=2),r=t.ArmyOfPosiSet[s][2]}else if(!i.isMulti&&null!=n){var s=1;n[a][0]==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(s=2),r=t.ArmyOfPosiSet[s][n[a][2]]}var c=new Object;c.x=r.x+i.deviation[0]*this._direction,c.y=r.y+i.deviation[1];var l=r.x-o.x,u=r.y-o.y,h=Math.sqrt(l*l+u*u),p=h*i.speed/t.PVPFightManager.TIMESCALE;0==h&&(p=i.speed/t.PVPFightManager.TIMESCALE),o.tarX=r.x,o.tarY=r.y,o.oriX=o.x,o.oriY=o.y,i.tweenType==t.SkillAniType.bajiaoshan?egret.Tween.get(o).to({x:c.x-130*this._direction,y:c.y},.3*p).call(function(){if(n)for(var i=0;i<n.length;i++)FacadeApp.dispatchAction(CommandList.PVP_HIT_ROLE,{aniName:e.AttackAniGroupName,site:n[i],jiduan:t.RoleAttackAniGroupNames.getHitNum(e.AttackAniGroupName),eventIndex:e.Army.eachFightDataSet[e.site][0].EventIndex})}).to({x:c.x+100*this._direction,y:c.y},.7*p).call(this.SkillTweenCompleteFun,this,[i]):i.tweenType==t.SkillAniType.wukongComboo?egret.Tween.get(o).to({x:c.x-100*this._direction,y:c.y-o.height/3,scaleX:1*this._direction,scaleY:1},p).call(this.SkillTweenCompleteFun,this,[i]):i.tweenType==t.SkillAniType.paodan?0==a&&egret.Tween.get(this).to({factor:1},p,egret.Ease.circIn).call(this.SkillTweenCompleteFun,this,[i]):i.tweenType==t.SkillAniType.huifu?0==a&&egret.Tween.get(this).to({factor:1},p).call(this.SkillTweenCompleteFun,this,[i]):i.tweenType==t.SkillAniType.dunwu?egret.Tween.get(o).to({x:c.x,y:c.y},p).call(this.SkillTweenCompleteFun,this,[i]):i.tweenType==t.SkillAniType.normal&&(o.rotation=180*Math.atan2(u,l)/Math.PI,egret.Tween.get(o).to({x:c.x,y:c.y,rotation:180*Math.atan2(u,l)/Math.PI},p).call(this.SkillTweenCompleteFun,this,[i]))}}},n.prototype.SkillTweenCompleteFun=function(e){if(this.status.current==t.SoldierStatusList.attacking&&e.isHit&&!this.SkillTweenComplete){var i=this.Army.getHitRoleObject(this.site);if(i)for(var n=0;n<i.length;n++)FacadeApp.dispatchAction(CommandList.PVP_HIT_ROLE,{aniName:this.AttackAniGroupName,site:i[n],jiduan:t.RoleAttackAniGroupNames.getHitNum(this.AttackAniGroupName),eventIndex:this.Army.eachFightDataSet[this.site][0].EventIndex})}this.SkillTweenComplete=!0,this.judgeAndClearCurFightData()},n.prototype.RoleArmComplete=function(){if(this.status.current==t.SoldierStatusList.attacking&&0!=this.curAniIndex&&this.curAniGroup[this.curAniIndex-1].hit&&"endHit"==this.curAniGroup[this.curAniIndex-1].hit){var e=this.Army.getHitRoleObject(this.site);if("mine"==this.curAniGroup[this.curAniIndex-1].type&&e)for(var i=0;i<e.length;i++)FacadeApp.dispatchAction(CommandList.PVP_HIT_ROLE,{aniName:this.AttackAniGroupName,site:e[i],jiduan:t.RoleAttackAniGroupNames.getHitNum(this.AttackAniGroupName),eventIndex:this.Army.eachFightDataSet[this.site][0].EventIndex})}return(this.status.current==t.SoldierStatusList.attackBefore||this.status.current==t.SoldierStatusList.attackEnd||this.status.current==t.SoldierStatusList.attacking)&&this.curAniGroup&&this.curAniIndex<this.curAniGroup.length&&(null==this._roleArmature.aniData.isStop||1==this._roleArmature.aniData.isStop)?void this.PlayRoleSkillAniFun():this.status.current==t.SoldierStatusList.interrupted?(this.RoleAniComplete=!0,this.RoleTweenComplete=!0,this.SkillAniComplete=!0,this.SkillTweenComplete=!0,void this.judgeAndClearCurFightData()):(this.status.current==t.SoldierStatusList.wait&&("hit1"==this._roleArmature.curPlayName||"hit2"==this._roleArmature.curPlayName)&&this.PlayRoleAnimation("move",0),this.RoleAniComplete=!0,void this.judgeAndClearCurFightData())},n.prototype.changeRoleTimeScale=function(){this._roleArmature.animation.timeScale=1,this._roleArmature.animation.timeScale=FacadeApp.Calc(effectEnum.HeroAttackSpeed,1),this._roleArmature.animation.timeScale*=t.PVPFightManager.TIMESCALE;for(var e=0;e<this._skillArmaSet.length;e++)"dra"==this._skillArmaSet[e].type&&(this._skillArmaSet[e].animation.timeScale=t.PVPFightManager.TIMESCALE);for(var e=this._hitAniSet.length-1;e>=0;e--)"dra"==this._hitAniSet[e].type&&(this._hitAniSet[e].animation.timeScale=t.PVPFightManager.TIMESCALE);for(var e=0;e<this._buffArmaSet.length;e++)"dra"==this._buffArmaSet[e].type&&(this._buffArmaSet[e].animation.timeScale=t.PVPFightManager.TIMESCALE)},n.prototype._PlayAttackMusic=function(){for(var e=1;e<=t.RoleAttackAniGroupNames.AttackCount;e++)this.AttackAniGroupName=="attack"+e&&6>e&&SoundManager.PlayMusic(SoundManager["Attack"+e+"_Music"],1)},n.prototype.judgeAndClearCurFightData=function(){var e=this._skillArmaSet[this._skillArmaSet.length-1];return(this.status.current==t.SoldierStatusList.attackBefore||this.status.current==t.SoldierStatusList.attackEnd||this.status.current==t.SoldierStatusList.attacking)&&this.curAniGroup&&this.curAniIndex<this.curAniGroup.length&&(e&&0==t.RoleAttackAniGroupNames.skillMoveAni(this.AttackAniGroupName,this.status.current,e.curAniIndex).isMove||e&&t.RoleAttackAniGroupNames.skillMoveAni(this.AttackAniGroupName,this.status.current,e.curAniIndex).isMove&&this.SkillTweenComplete||!e)?void this.PlayRoleSkillAniFun():void(this.RoleAniComplete&&this.RoleTweenComplete&&this.SkillAniComplete&&this.SkillTweenComplete&&(this.ClearSkillArmature(),this._roleArmature.aniData=null,this.status.ChangeWait(),"end"!=t.PVPFightManager.GetInstance().status.current&&this.Army.removeFightData(this.site)))},n.prototype.PlayRoleAnimation=function(t,e){null!=this._roleArmature&&(0==e?this._roleArmature.curPlayName!=t&&this._roleArmature.animation.gotoAndPlay(t,-1,-1,e):this._roleArmature.animation.gotoAndPlay(t,-1,-1,e),this._roleArmature.curPlayName=t)},n.prototype.RemoveArmature=function(t){null!=t&&(MovieManage.RemoveArmature(t),t.display.parent&&t.display.parent.removeChild(t.display),t=null)},n.prototype.ClearSkillArmature=function(){if(this._skillArmaSet.length>0){for(var e=0;e<this._skillArmaSet.length;e++)"dra"==this._skillArmaSet[e].type?this._skillArmaSet[e].display.parent&&(this._skillArmaSet[e].display.scaleX=1,this._skillArmaSet[e].display.rotation=0,t.PVPFightManager.GetInstance().removeChild(this._skillArmaSet[e].display),MovieManage.RemoveArmature(this._skillArmaSet[e])):"ima"==this._skillArmaSet[e].type?this._skillArmaSet[e].parent&&(this._skillArmaSet[e].scaleX=1,this._skillArmaSet[e].rotation=0,t.PVPFightManager.GetInstance().removeChild(this._skillArmaSet[e]),ObjectPool.getPool("eui.Image").returnObject(this._skillArmaSet[e])):this._skillArmaSet[e].parent&&(this._skillArmaSet[e].stop(),this._skillArmaSet[e].scaleX=1,this._skillArmaSet[e].rotation=0,t.PVPFightManager.GetInstance().removeChild(this._skillArmaSet[e]));this._skillArmaSet=[]}},n.prototype.PausePVPFight=function(){for(var t=0;t<this._skillArmaSet.length;t++)egret.Tween.pauseTweens(this._skillArmaSet[t]),"dra"==this._skillArmaSet[t].type?this._skillArmaSet[t].animation.stop():"mov"==this._skillArmaSet[t].type&&this._skillArmaSet[t].stop();this._roleArmature.animation.stop(),egret.Tween.pauseTweens(this)},n.prototype.ContinuePVPFight=function(){for(var t=0;t<this._skillArmaSet.length;t++)egret.Tween.resumeTweens(this._skillArmaSet[t]),"dra"==this._skillArmaSet[t].type?this._skillArmaSet[t].animation.play():"mov"==this._skillArmaSet[t].type&&this._skillArmaSet[t].play();this._roleArmature.animation.play(),egret.Tween.resumeTweens(this)},n.prototype.EndPVPFight=function(){for(var t=0;t<this._skillArmaSet.length;t++)egret.Tween.removeTweens(this._skillArmaSet[t]),"dra"==this._skillArmaSet[t].type?this._skillArmaSet[t].animation.stop():"mov"==this._skillArmaSet[t].type&&this._skillArmaSet[t].stop();this._roleArmature.animation.stop(),egret.Tween.removeTweens(this),this.ClearSkillArmature()},Object.defineProperty(n.prototype,"Army",{get:function(){var e=t.PVPFightManager.GetInstance().armyOfEnemy;return this._isMineArmy&&(e=t.PVPFightManager.GetInstance().armyOfMine),e},enumerable:!0,configurable:!0}),n.prototype.getArmy=function(e){return 1==e||1==e?t.PVPFightManager.GetInstance().armyOfMine:t.PVPFightManager.GetInstance().armyOfEnemy},Object.defineProperty(n.prototype,"RoleHeight",{get:function(){return this._roleArmature.display?this._roleArmature.Height:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"RoleWidth",{get:function(){return this._roleArmature.display?this._roleArmature.Width:0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"RoleAniComplete",{get:function(){return this._isRoleAniComplete},set:function(t){this._isRoleAniComplete=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"RoleTweenComplete",{get:function(){return this._isRoleTweenComplete},set:function(t){this._isRoleTweenComplete=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SkillAniComplete",{get:function(){return this._isSkillAniComplete},set:function(t){this._isSkillAniComplete=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"SkillTweenComplete",{get:function(){return this._isSkillTweenComplete},set:function(t){this._isSkillTweenComplete=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"factor",{get:function(){return 0},set:function(t){for(var e=this._skillArmaSet.length-1;e>=0;e--){var i=this._skillArmaSet[e].tarX-this._skillArmaSet[e].oriX,n=this._skillArmaSet[e].tarY-this._skillArmaSet[e].oriY;this._skillArmaSet[e].rotation=180*Math.atan2(n,i)/Math.PI,this._skillArmaSet[e].x=(1-t)*(1-t)*this._skillArmaSet[e].oriX+2*t*(1-t)*(this._skillArmaSet[e].oriX+i/2)+t*t*this._skillArmaSet[e].tarX,this._skillArmaSet[e].y=(1-t)*(1-t)*this._skillArmaSet[e].oriY+2*t*(1-t)*(this._skillArmaSet[e].oriY-300)+t*t*this._skillArmaSet[e].tarY}},enumerable:!0,configurable:!0}),n}(egret.Sprite);t.PVPSoldier=i,__reflect(i.prototype,"PVPManager.PVPSoldier",["IObjectPool"])}(PVPManager||(PVPManager={}));var Mixin;!function(t){function e(t,e){e.forEach(function(e){Object.getOwnPropertyNames(e.prototype).forEach(function(i){t.prototype[i]=e.prototype[i]})})}t.applyMixins=e}(Mixin||(Mixin={}));var Mixin;!function(t){var e=function(){function t(){}return t.prototype.getx=function(t){return this[t]},t.prototype.setx=function(t,e){return this[t]=e,this},t}();t.asSettable=e,__reflect(e.prototype,"Mixin.asSettable")}(Mixin||(Mixin={}));var DailyTaskWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.DailyTaskWindowMediator,e)||this;return i.page.RegisterDataSource([CommandList.TASK_GET_LIST]),i}return __extends(e,t),e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Task]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Task:FacadeApp.fetchData([CommandList.M_NET_TASK,"&oper=0"],[function(t){FacadeApp.dispatchAction(CommandList.TASK_GET_LIST,t.data.items),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(DailyTaskWindowMediator.prototype,"DailyTaskWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var GameConfigOfRuntime=function(){function t(){}return Object.defineProperty(t,"IsDebug",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Date",{get:function(){return new Date},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Time",{get:function(){var e=t.Date;return Math.floor(e.getTime()/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ServerTime",{get:function(){return t.serverTime},enumerable:!0,configurable:!0}),t.getStoneEffect=function(){return(.1*FacadeApp.read(CommandList.Re_Status).stoneHero+.01*Math.max(0,FacadeApp.read(CommandList.Re_FightInfo).rt-1)).toFixed(0)},t}();GameConfigOfRuntime.ServerUrl="h5.gamegold.xin",GameConfigOfRuntime.ServerPort=9202,GameConfigOfRuntime.commMode=CommMode.socket,GameConfigOfRuntime.TestUserId=Math.floor(1e5*Math.random())+"",GameConfigOfRuntime.serverTime=0,GameConfigOfRuntime.gameWidth=640,GameConfigOfRuntime.gameHeight=1136,GameConfigOfRuntime.panelListHeight=775,GameConfigOfRuntime.panelInitY=525,GameConfigOfRuntime.roleX=-100,GameConfigOfRuntime.roleEnemyX=450,GameConfigOfRuntime.roleY=660,GameConfigOfRuntime.roleMaxX=230,GameConfigOfRuntime.roleEnemyMaxX=370,GameConfigOfRuntime.roleSpeed=6,GameConfigOfRuntime.attackRange=250,GameConfigOfRuntime.monsterX=850,GameConfigOfRuntime.monsterY=660,GameConfigOfRuntime.monsterMinX=400,GameConfigOfRuntime.monsterSpeed=6,GameConfigOfRuntime.createTime=40,GameConfigOfRuntime.monsterCount=17,GameConfigOfRuntime.bossCount=13,GameConfigOfRuntime.CPMCount=4,GameConfigOfRuntime.HangupInterval=1,__reflect(GameConfigOfRuntime.prototype,"GameConfigOfRuntime");var ButtonActiveStatus={OfflineButton:1,HangupButton:2,HangupBonusButton:4,BonusOfPassGate:8},ShopTypeEnum={diamond:1,Gold:2,common:4,secret:8},r_activityInfo=FacadeApp.cr({act:[],starttime:"",endtime:"",id:null,rank:null,score:null,type:null,state:""},(_a={},_a[CommandList.M_DAT_ActivityInfo]=function(t,e){var i=e.data;return t.act=i.act,t.starttime=i.starttime,t.endtime=i.endtime,t.id=i.id,t.rank=i.rank,t.score=i.score,t.type=i.type,t},_a)),_a,Amulet=function(){function t(t){this._id=t.id,this._icon=t.iconRes,this._nameIma=t.nameRes,this._level=0,0==parseInt(t.maxLevel)?this._maxlevel="无限":this._maxlevel=t.maxLevel,this._description=t.desc}return Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NameIma",{get:function(){return this._nameIma},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this._level},set:function(t){this._level=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GhostId1",{set:function(t){this._level=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GhostIdLevel1",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GhostId2",{set:function(t){this._level=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GhostIdLevel2",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"MaxLevel",{get:function(){return this._maxlevel},set:function(t){this._maxlevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HasGet",{get:function(){return this._level>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UpLVInternaldan",{get:function(){var t=new Digit([100]);return t},enumerable:!0,configurable:!0}),t}();__reflect(Amulet.prototype,"Amulet");var r_amuletInfo=FacadeApp.cr({init:!1,list:{},stone:0,stoneHero:0},(_a={},_a[CommandList.M_DAT_Amulet]=function(t,e){var i=e.data;if("undefined"!=typeof i&&null!=i){if(t.stone=i.stone,t.stoneHero=i.stoneHero,!t.init){t.init=!0;var n=ConfigStaticManager.getList(ConfigTypeName.Amulet);Object.keys(n).map(function(e){t.list[e]=new Amulet(n[e])})}Object.keys(i.items).map(function(e){var n=i.items[e];t.list[e].Level=n.l})}return t},_a)),_a,AmuletManager=function(){function t(){}return t.Init=function(){t._amuletSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Amulet);Object.keys(e).map(function(i){var n=new Amulet(e[i]);t._amuletSet[n.ID]=n})},Object.defineProperty(t,"AmuletSet",{get:function(){return t._amuletSet},enumerable:!0,configurable:!0}),t.GetAmuletByID=function(t){return this._amuletSet[t]},t.fromData=function(e){var i=t.GetAmuletByID(e.ID);return i.Level=e.Level,i},t}();__reflect(AmuletManager.prototype,"AmuletManager");var Card=function(){function t(t){this._prototype=new CardPrototype(t)}return Object.defineProperty(t.prototype,"ori",{get:function(){return FacadeApp.read(CommandList.Re_CardtInfo).list[this.ID]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Chip",{get:function(){return FacadeApp.read(CommandList.Re_CardtInfo).chip},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AdChip",{get:function(){return FacadeApp.read(CommandList.Re_CardtInfo).adChip},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this._prototype.ID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Prototype",{get:function(){return this._prototype},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._prototype.Name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._prototype.Description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"En",{get:function(){return this.ori.en},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ad",{get:function(){return this.ori.ad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lv",{get:function(){return this.ori.l},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Maxlv",{get:function(){return 20*this.ori.en>99?99:20*this.ori.en},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Suipian",{get:function(){return this.ori.p},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"State",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Chip_en",{get:function(){return parseInt(this.ori.c_en.split(",")[0])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Chip_adv",{get:function(){return parseInt(this.ori.c_adv)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Chip_up",{get:function(){return parseInt(this.ori.c_up)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Attack",{get:function(){return this.ori.Attack},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Defense",{get:function(){return this.ori.Defense},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Valor",{get:function(){return this.ori.bp.Valor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Sacrifice",{get:function(){return this.ori.bp.Sacrifice},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Spirituality",{get:function(){return this.ori.bp.Spirituality},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Honesty",{get:function(){return this.ori.bp.Honesty},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Justice",{get:function(){return this.ori.bp.Justice},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Hamility",{get:function(){return this.ori.bp.Hamility},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Honor",{get:function(){return this.ori.bp.Honor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Compassion",{get:function(){return this.ori.bp.Compassion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ChooseButton",{get:function(){var t=0;return t=0==this.Lv?4:this.Lv!=this.Maxlv?1:this.En==this.Ad?3:2},enumerable:!0,configurable:!0}),t}();__reflect(Card.prototype,"Card");var r_cardInfo=FacadeApp.cr({init:!1,list:[],canMarshList:[],adChip:0,chip:0,FightingCard:null,_cardPrototypeSet:[],maxId:0,marshallingList:[],power:null,CardTotalGJ:function(){var t=this,e=new Digit([0]);return Object.keys(this.list).map(function(i){e=CalculateMgr.Add(e,Digit.fromObject(t.list[i].b))}),e}},(_a={},_a[CommandList.M_DAT_CardList]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(Object.keys(i.items).map(function(e){t.list[e]=i.items[e]}),t.adChip=i.adChip,t.chip=i.chip,t.FightingCard=null),t},_a[CommandList.M_DAT_MarshallingList]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.adChip=i.adChip,t.chip=i.chip,t.FightingCard=null,t.power=i.power,Object.keys(i.loc).map(function(e){t.marshallingList[e]=i.loc[e]})),t},_a)),_a,CardManager=function(){function t(){}return t.Init=function(){t._cardSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Card);
Object.keys(e).map(function(i){var n=new Card(e[i]);t._cardSet[n.ID]=n})},Object.defineProperty(t,"CardSet",{get:function(){return t._cardSet},enumerable:!0,configurable:!0}),t.GetCardByID=function(t){return this._cardSet[t]},t.fromData=function(e){var i=t.GetCardByID(e.i);return i},t}();__reflect(CardManager.prototype,"CardManager");var CardPrototype=function(){function t(t){this._allskillSet=[],this._id=parseInt(t.id),this._name=t.name,this._nameRes=t.nameRes,this._qsIcon=t.QSRes,this._headIcon=t.headRes,this._description=t.desc,this._allskillSet.push(t.action1),this._allskillSet.push(t.action2),this._allskillSet.push(t.action3),this._allskillSet.push(t.action4),this._allskillSet.push(t.action5),this._profession=parseInt(t.profession),this._nature=parseInt(t.nature)}return Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NameIcon",{get:function(){return""==this._nameRes?"fabao_wz_ryjgb_png":this._nameRes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"QSRes",{get:function(){return""==this._qsIcon?"jingubang_png":this._qsIcon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HeadRes",{get:function(){return""==this._headIcon?"jingubang_png":this._headIcon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Pinzhi",{get:function(){return this._pinzhi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Suipian",{get:function(){return this._suipian},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gongji",{get:function(){return new Digit([100])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Fangyu",{get:function(){return this._fangyu},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Minjie",{get:function(){return this._minjie},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Baoji",{get:function(){return this._baoji},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Zhanli",{get:function(){return this._zhanli},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Shengming",{get:function(){return this._shengming},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Skill",{get:function(){return this._allskillSet[0].split(";")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Nature",{get:function(){return this._nature},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Profession",{get:function(){return this._profession},enumerable:!0,configurable:!0}),t}();__reflect(CardPrototype.prototype,"CardPrototype");var CheckPointStatusType;!function(t){t[t.Normal=0]="Normal",t[t.Unlimited=1]="Unlimited"}(CheckPointStatusType||(CheckPointStatusType={}));var r_fightInfo=FacadeApp.cr({LEVEL:1,his:1,_monsterCount:0,checkPointStatus:CheckPointStatusType.Normal,TOTALMONSTER:30,BOSSTIME:0,BOSSLIFEPROGRESS:0,events:[],rl:0,rt:0,aStone:0,BOSSID:null,eid:0,HangUpLeftTime:0,UnlimitedMode:function(){return this.LEVEL>0&&this.checkPointStatus==CheckPointStatusType.Unlimited&&0==this.eid},TollgateProgressLeft:function(){return Math.max(0,this.TOTALMONSTER-this._monsterCount)},historyData:{eid:0,_monsterCount:0,TOTALMONSTER:0}},(_a={},_a[CommandList.SetTollgateProgress]=function(t,e){var i=e.data;return t._monsterCount=i,t},_a[CommandList.M_AT_BattleWithFlyBoss]=function(t,e){var i=e.data;return t.eid=i.eid,t.events=[],t.historyData._monsterCount=t._monsterCount,t.historyData.TOTALMONSTER=t.TOTALMONSTER,t._monsterCount=0,t.TOTALMONSTER=1,t},_a[CommandList.M_AT_EventHandleResult]=function(t,e){var i=e.data;return t.events=i.events,t},_a[CommandList.M_AT_ReturnTollgate]=function(t,e){e.data;return t.eid=0,t._monsterCount=t.historyData._monsterCount,t.TOTALMONSTER=t.historyData.TOTALMONSTER,t},_a[CommandList.M_AT_SyncCheckpoint]=function(t,e){var i=e.data;return t.historyData._monsterCount=0,t.historyData.TOTALMONSTER=0,t.historyData.eid=0,t.LEVEL=i.gateNo,t.his=i.his,t._monsterCount=i.monsterNum,t.TOTALMONSTER=i.totalMonster,t.events=i.events,t.rl=i.rl,t.rt=i.rt,t.aStone=i.aStone,t.BOSSID=i.bossId,t.BOSSLIFEPROGRESS=null,"goBack"==i.status?t.checkPointStatus=1:t.checkPointStatus=0,t.LEVEL%5!=0&&(t.BOSSLIFEPROGRESS=0),t},_a[CommandList.BossLifeProgress]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.BOSSLIFEPROGRESS=i),t},_a[CommandList.BOSSTIME]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.BOSSTIME=i),t},_a[CommandList.M_CMD_FIGHT_GiveUpOrFight]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.GIVEUPORFIGHT=i),t},_a[CommandList.M_CMD_Login]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.LEVEL=i.gateNo,t.his=i.his,t.HangUpLeftTime=i.leftTime),t},_a)),_a,r_mailInfo=FacadeApp.cr({list:[],noReadList:[]},(_a={},_a[CommandList.M_DAT_MailList]=function(t,e){var i=e.data;if("undefined"!=typeof i&&null!=i){t.list=i.list,t.noReadList=[];for(var n=0;n<t.list.length;n++)0==t.list.state&&t.noReadList.push(t.list.id)}return t},_a)),_a,Pet=function(){function t(t){this._genius=[],this._isFighting=!1,this._isGet=!1,this._autoTimes=0,this._id=parseInt(t.id),this._name=t.name,this._dragonRes=t.draRes,this._nameRes=t.nameRes,this._description=t.desc,this._genius=t.genius.split(";"),this._autoTimes=parseInt(t.autoTimes),this._baseGJ=new Digit([parseInt(t.baseDamage)]),this._iniBonus=new Digit([parseInt(t.baseUpdate)]),this._iniConsume=new Digit([parseInt(t.baseCost)]),this._skillIDSet=[parseInt(t.level10SkillId),parseInt(t.level25SkillId),parseInt(t.level50SkillId),parseInt(t.level75SkillId),parseInt(t.level100SkillId),parseInt(t.level125SkillId),parseInt(t.level150SkillId),parseInt(t.level175SkillId),parseInt(t.level200SkillId),parseInt(t.level1000SkillId)],this._skillLevelSet=[10,25,50,75,100,125,150,175,200,1e3],this._level=0}return Object.defineProperty(t.prototype,"ori",{get:function(){return FacadeApp.read(CommandList.Re_PetInfo).list[this.ID]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DragonRes",{get:function(){return this._dragonRes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Genius",{get:function(){return this._genius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FSRes",{get:function(){return this._dragonRes+"fs_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DJRes",{get:function(){return this._dragonRes+"dj_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SJ1Res",{get:function(){return this._dragonRes+"sj_1_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SJ2Res",{get:function(){return this._dragonRes+"sj_2_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"QSRes",{get:function(){return this._dragonRes+"_qs_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HeadRes",{get:function(){return this._dragonRes+"_qs_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NameRes",{get:function(){return this._nameRes+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gongji",{get:function(){if(0==this._level)return new Digit([0]);var t=CalculateMgr.Add(this._baseGJ,CalculateMgr.Mul(this._iniBonus,new Digit([this._level-1])));return t=CalculateMgr.Mul(t,this._GetMultipleTotal(this._level))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NextLVGJ",{get:function(){var t=CalculateMgr.Add(this._baseGJ,CalculateMgr.Mul(this._iniBonus,new Digit([this._level])));return t=CalculateMgr.Mul(t,this._GetMultipleTotal(this._level+1))},enumerable:!0,configurable:!0}),t.prototype.UpLVMoney=function(t){if(this._level>=1){var e=this._iniConsume.clone.Mul(CalculateMgr.Pow(1.06,t+this._level-1));return e}return this._iniConsume.clone},t.prototype._GetMultipleTotal=function(t){for(var e=new Digit([1]);t>0;)e=CalculateMgr.Mul(e,this._GetMultiple(t)),t-=1;return e},t.prototype._GetZF=function(t){if(1==t)return this._iniBonus;var e=CalculateMgr.Mul(this._GetZF(t-1),this._GetMultiple(t-1));return e},t.prototype._GetMultiple=function(t){0>=t&&(t=1);var e=1;return 10==t||25==t||50==t?e=2:75==t?e=2.5:125==t||150==t?e=3:175==t?e=3.5:t>=200&&(t%1e3==0?e=10:t%25==0&&(e=4)),new Digit([e])},Object.defineProperty(t.prototype,"IsFighting",{get:function(){return this._isFighting},set:function(t){t!=this._isFighting&&(this._isFighting=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsGet",{get:function(){return this._isGet},set:function(t){this._isGet=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"AutoTimes",{get:function(){return this._autoTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Music",{get:function(){return this._id<3?SoundManager.PetAttack1_Music:this._id<5?SoundManager.PetAttack2_Music:SoundManager.PetAttack3_Music},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this._level},set:function(t){this._level=t},enumerable:!0,configurable:!0}),t}();__reflect(Pet.prototype,"Pet");var r_petInfo=FacadeApp.cr({list:{},active:0,PetLevel:1,FightingPetInfo:null,FightingPet:null},(_a={},_a[CommandList.M_DAT_PetList]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list=i.items,t.active=i.active),Object.keys(t.list).map(function(e){var i=t.list[e],n=PetManager.GetPetByID(i.i);n.IsFighting=i.i==t.active,n.IsGet=i.l>0,n.IsFighting&&(t.FightingPetInfo=i,t.FightingPet=n),i.l>t.PetLevel&&(t.PetLevel=i.l)}),t},_a)),_a,PetManager=function(){function t(){}return t.Init=function(){t._petSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Pet);return null==e?null:void Object.keys(e).map(function(i){var n=new Pet(e[i]);t._petSet[n.ID]=n})},Object.defineProperty(t,"PetSet",{get:function(){return t._petSet},enumerable:!0,configurable:!0}),t.GetPetByID=function(t){return this._petSet[t]},t.fromData=function(e){var i=t.GetPetByID(e.i);return i.Level=e.l,i},Object.defineProperty(t,"PetTotalGJ",{get:function(){var e=new Digit([0]);return Object.keys(t._petSet).map(function(i){var n=t._petSet[i];e=CalculateMgr.Add(e,n.Gongji)}),e},enumerable:!0,configurable:!0}),t}();__reflect(PetManager.prototype,"PetManager");var r_rankInfo=FacadeApp.cr({list1:[],list2:[],list3:[],rank1:1,rank2:1,rank3:1},(_a={},_a[CommandList.RANK_GET_LIST1]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list1=i.list,t.rank1=i.rank),t},_a[CommandList.RANK_GET_LIST2]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list2=i.list,t.rank2=i.rank),t},_a[CommandList.RANK_GET_LIST3]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list3=i.list,t.rank3=i.rank),t},_a)),_a,RewardItemManager=function(){function t(){}return t.Init=function(){t._rewardItemSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Task);Object.keys(e).map(function(i){t._rewardItemSet[e.id]=e[i]})},Object.defineProperty(t,"RewardItemSet",{get:function(){return t._rewardItemSet},enumerable:!0,configurable:!0}),t.GetRewardItemByID=function(t){return this._rewardItemSet[t]},t.GetRewardItemNameByID=function(t){return this._rewardItemSet[t].rewardType},t}();__reflect(RewardItemManager.prototype,"RewardItemManager");var Goods=function(){function t(t){this._id=parseInt(t.id),this._name=t.name,this._description=t.desc,this._iconRes=t.iconRes,this._costTypeRes=t.descres,this._nameRes=t.nameRes,this._buyTimesType=parseInt(t.buyTimesType),this._buyTimes=parseInt(t.buyTimes),this._buyType=parseInt(t.buyType),this._cost=parseInt(t.cost),this._goodsId=parseInt(t.goodsId),this._value=parseInt(t.value),this._listID=parseInt(t.listId)}return Object.defineProperty(t.prototype,"ori",{get:function(){return FacadeApp.read(CommandList.Re_ShopInfo).list[this.ID]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IconRes",{get:function(){return this._iconRes+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NameRes",{get:function(){return this._nameRes+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CostTypeRes",{get:function(){return this._costTypeRes+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BuyTimesType",{get:function(){return this._buyTimesType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BuyTimes",{get:function(){return this._buyTimes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BuyType",{get:function(){return this._buyType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Cost",{get:function(){return this._cost},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GoodsID",{get:function(){return this._goodsId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ListID",{get:function(){return this._listID},enumerable:!0,configurable:!0}),t}();__reflect(Goods.prototype,"Goods");var GoodsManager=function(){function t(){}return t.Init=function(){t._goodsSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Shop);Object.keys(e).map(function(i){var n=new Goods(e[i]);t._goodsSet[n.ID]=n})},Object.defineProperty(t,"GoodsSet",{get:function(){return t._goodsSet},enumerable:!0,configurable:!0}),t.GetGoodsByID=function(t){return this._goodsSet[t]},t.fromData=function(e){var i=t.GetGoodsByID(e.id);return i},t}();__reflect(GoodsManager.prototype,"GoodsManager");var r_shopInfo=FacadeApp.cr({list:[]},(_a={},_a[CommandList.SHOP_GET_LIST]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list=i),t},_a)),_a,ActiveSkill=function(){function t(t){this._timer=0,this._status=0,this._id=parseInt(t.id),this._name=t.name,this._icon=t.iconRes;var e=t.effectId.split(":");this._skillEffectID=parseInt(e[0]),e.length>1&&(this._effectNum=parseFloat(e[1])),this._description=t.desc,this._duration=parseInt(t.duration),this._coolTime=parseInt(t.cooldown),this._lastTime=0}return Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastTime",{get:function(){return this._lastTime},set:function(t){this._lastTime=Math.max(0,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CoolTime",{get:function(){return this._coolTime},set:function(t){0>t&&(t=0),this._coolTime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Status",{get:function(){return this._status},set:function(t){this._status=t},enumerable:!0,configurable:!0}),t.prototype.GetProgress=function(){var t=0;return t=2==this._status?this._lastTime/this._duration:this._lastTime/this.CoolTime,Math.min(t,1)},t.prototype.Process=function(t){1!=this.Status&&(this._timer+=t,this._timer>=1e3&&(this._timer-=1e3,this._lastTime>0&&(this.LastTime-=1),0==this._lastTime?(this.Status=1,FacadeApp.fetchData([CommandList.M_NET_SkillNum,"&oper=1&aid&pm"],[function(t){SkillManager.UpdateStatus(t.data.items),FacadeApp.dispatchAction(CommandList.M_AT_EFFECTS,t.data.effects),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])):FacadeApp.Notify(CommandList.M_CMD_SkillStatus,this.ID)))},t}();__reflect(ActiveSkill.prototype,"ActiveSkill");var CardSkill=function(){function t(t){this._id=parseInt(t.id),this._name=t.name,this._description=t.desc}return Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t}();__reflect(CardSkill.prototype,"CardSkill");var SkillManager=function(){function t(){}return t.Init=function(){t._InitTalismanSkill(),t._InitACSkill(),t._InitCardSkill(),FacadeApp.fetchData([CommandList.M_NET_SkillNum,"&oper=1&aid=1&pm=1"],[function(e){t.UpdateStatus(e.data.items),FacadeApp.dispatchAction(CommandList.M_AT_EFFECTS,e.data.effects),e.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[e.code])}]),t._isInit=!0},t.UpdateStatus=function(e){Object.keys(e).map(function(i){var n=e[i],a=n.id;if(7>a){var o=n.status,r=n.cd,s=t.GetActiveSkillByID(a);switch(s.Status=o,o){case 1:s.LastTime=0;break;case 3:case 2:s.LastTime=r-GameConfigOfRuntime.Time}FacadeApp.Notify(CommandList.M_CMD_SkillStatus,a)}})},t._InitACSkill=function(){t._activeSkillSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.ActiveSkill);Object.keys(e).map(function(i){var n=new ActiveSkill(e[i]);t._activeSkillSet.push(n)})},t._InitTalismanSkill=function(){t._talismanSkillSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.TalismanSkill);Object.keys(e).map(function(i){var n=new TalismanSkill(e[i]);t._talismanSkillSet.push(n)})},t._InitCardSkill=function(){t._cardSkillSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.CardSkill);Object.keys(e).map(function(i){var n=new CardSkill(e[i]);t._cardSkillSet.push(n)})},t.GetTalismanSkillByID=function(e){for(var i=0;i<t._talismanSkillSet.length;i++)if(e==t._talismanSkillSet[i].ID)return t._talismanSkillSet[i];return null},t.GetActiveSkillByID=function(e){for(var i=0;i<t._activeSkillSet.length;i++)if(e==t._activeSkillSet[i].ID)return t._activeSkillSet[i];return null},t.GetCardSkillByID=function(e){for(var i=0;i<t._cardSkillSet.length;i++)if(e==t._cardSkillSet[i].ID)return t._cardSkillSet[i];return null},Object.defineProperty(t,"ActiveSkill",{get:function(){return t._activeSkillSet},enumerable:!0,configurable:!0}),t.Process=function(e){if(t._isInit)for(var i=0;i<t._activeSkillSet.length;i++)t._activeSkillSet[i].Process(e)},t}();SkillManager._isInit=!1,__reflect(SkillManager.prototype,"SkillManager");var TalismanSkill=function(){function t(t){this._id=parseInt(t.id),this._name=t.name,this._icon=t.iconRes;var e=t.effectId.split(":");this._skillEffectID=parseInt(e[0]),e.length>1&&(this._effectNum=parseFloat(e[1])),this._description=t.desc}return Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),t}();__reflect(TalismanSkill.prototype,"TalismanSkill");var Talisman=function(){function t(t){this._level=0,this._id=t.id,this._name=t.name,this._icon=t.iconRes,this._description=t.desc,this._nameIma=t.nameRes,this._baseGJ=new Digit([parseInt(t.baseDamage)]),this._iniBonus=new Digit([parseInt(t.baseUpdate)]),this._iniConsume=new Digit([parseInt(t.baseCost)]),this._skillIDSet=[parseInt(t.level10SkillId),parseInt(t.level25SkillId),parseInt(t.level50SkillId),parseInt(t.level75SkillId),parseInt(t.level100SkillId),parseInt(t.level125SkillId),parseInt(t.level150SkillId),parseInt(t.level175SkillId),parseInt(t.level200SkillId),parseInt(t.level1000SkillId)],this._skillLevelSet=[10,25,50,75,100,125,150,175,200,1e3]}return Object.defineProperty(t.prototype,"ori",{get:function(){return FacadeApp.read(CommandList.Re_TalismanInfo).list[this.ID]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NameRes",{get:function(){return this._nameIma},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Level",{get:function(){return this._level},set:function(t){this._level=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HasGet",{get:function(){return this._level>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Gongji",{get:function(){if(0==this._level)return new Digit([0]);var t=CalculateMgr.Add(this._baseGJ,CalculateMgr.Mul(this._iniBonus,new Digit([this._level-1])));return t=CalculateMgr.Mul(t,this._GetMultipleTotal(this._level))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"NextLVGJ",{get:function(){var t=CalculateMgr.Add(this._baseGJ,CalculateMgr.Mul(this._iniBonus,new Digit([this._level])));return t=CalculateMgr.Mul(t,this._GetMultipleTotal(this._level+1))},enumerable:!0,configurable:!0}),t.prototype.UpLVMoney=function(t){if(this._level>=1){var e=this._iniConsume.clone.Mul(CalculateMgr.Pow(1.06,t+this._level)).Sub(this._iniConsume.clone.Mul(CalculateMgr.Pow(1.06,this._level)));return e}return this._iniConsume.clone},t.prototype._GetMultipleTotal=function(t){for(var e=new Digit([1]);t>0;)e=CalculateMgr.Mul(e,this._GetMultiple(t)),t-=1;return e},t.prototype._GetZF=function(t){if(1==t)return this._iniBonus;var e=CalculateMgr.Mul(this._GetZF(t-1),this._GetMultiple(t-1));return e},t.prototype._GetMultiple=function(t){0>=t&&(t=1);var e=1;return 10==t||25==t||50==t?e=2:75==t?e=2.5:125==t||150==t?e=3:175==t?e=3.5:t>=200&&(t%1e3==0?e=10:t%25==0&&(e=4)),new Digit([e])},t}();__reflect(Talisman.prototype,"Talisman");var r_talismanInfo=FacadeApp.cr({list:{},talismansNumOfActive:function(){var t=this,e=0;return Object.keys(this.list).map(function(i){t.list[i].l>0&&e++}),e},talismansTotalLevel:function(){var t=this,e=0;return Object.keys(this.list).map(function(i){e+=t.list[i].l}),e}},(_a={},_a[CommandList.M_DAT_TalismanList]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list=i.items),t},_a)),_a,TalismanManager=function(){function t(){}return t.Init=function(){t._talismanSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Talisman);Object.keys(e).map(function(i){var n=new Talisman(e[i]);t._talismanSet[n.ID]=n})},Object.defineProperty(t,"TalismanSet",{get:function(){return t._talismanSet},enumerable:!0,configurable:!0}),t.GetTalismanByID=function(t){return this._talismanSet[t]},t.fromData=function(e){var i=t.GetTalismanByID(e.i);return i.Level=e.l,i},Object.defineProperty(t,"TalismanTotalGJ",{get:function(){var e=new Digit([0]);return Object.keys(t._talismanSet).map(function(i){var n=t._talismanSet[i];e=CalculateMgr.Add(e,n.Gongji)}),e},enumerable:!0,configurable:!0}),t}();__reflect(TalismanManager.prototype,"TalismanManager");var Task=function(){function t(t){this._id=parseInt(t.id),this._name=t.name,this._description=t.desc,this._iconRes=t.iconRes,this._bonus=t.bonus}return Object.defineProperty(t.prototype,"ori",{get:function(){return FacadeApp.read(CommandList.Re_TaskInfo).list[this.ID]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IconRes",{get:function(){return this._iconRes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bonus",{get:function(){return this._bonus},enumerable:!0,configurable:!0}),t}();__reflect(Task.prototype,"Task");var r_taskInfo=FacadeApp.cr({list:[],TASK_FINISHED_NUM:0},(_a={},_a[CommandList.TASK_GET_LIST]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.list=i),t},_a[CommandList.TASK_FINISHED_NUM]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.TASK_FINISHED_NUM=i),t},_a)),_a,TaskManager=function(){function t(){}return t.Init=function(){t._taskSet=[];var e=ConfigStaticManager.getList(ConfigTypeName.Task);Object.keys(e).map(function(i){var n=new Task(e[i]);t._taskSet[n.ID]=n})},Object.defineProperty(t,"TaskSet",{get:function(){return t._taskSet},enumerable:!0,configurable:!0}),t.GetTaskByID=function(t){return this._taskSet[t]},t.fromData=function(e){var i=t.GetTaskByID(e.id);return i},t}();__reflect(TaskManager.prototype,"TaskManager");var Player=function(){function t(t,e){this._id=t,this._name=e}return Object.defineProperty(t.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),t}();__reflect(Player.prototype,"Player");var em_EffectCalcType;!function(t){t[t.em_EffectCalc_Multiplication=0]="em_EffectCalc_Multiplication",t[t.em_EffectCalc_Addition=1]="em_EffectCalc_Addition",t[t.em_EffectCalc_Subduction=2]="em_EffectCalc_Subduction",t[t.em_EffectCalc_Division=3]="em_EffectCalc_Division"}(em_EffectCalcType||(em_EffectCalcType={}));var effectEnum={None:0,PotentialEffect:1,Skill4_Enhance:2,StoneGetNum:3,BoxMoney:4,MoneyOutput:5,MoneyConsumeDiscount:6,Skill1_Timer:7,RevivalStartMoney:8,RevivalStartPoint:9,Skill6_Rcd:10,Skill5_Rcd:11,Skill1_Rcd:12,BoxRate:13,Skill6_Timer:14,Skill2_Timer:15,DoubleAttackValue:16,StoneEffect:17,Skill3_Timer:18,TenMultiMoney:19,ConvertPveToClick:20,Skill4_Rcd:21,Skill4_Timer:22,StoneGetRate:23,Skill5_Timer:24,DoubleAttackRate:25,Skill2_Rcd:26,ReduceBossBlood:27,ReduceMonsterNum:28,Skill3_Rcd:29,AutoAttack:30,Attack:31,GetMoneyPerHit:32,AttackForClick:33,HeroAttackSpeed:34,AttackToGold:38,AttackToAll:39,AttackToWater:40,AttackToWood:41,AttackToFire:42,AttackToEarth:43,AttackAndClick:44,MoneyOutput20:45,SkillCooldownTime:46,StoneOutput20:47,OfflineBonus:48,AttackForPveRevival:49,EquUpgradeCost:50,PotentialOutput20:51,AltarOutput:52,Exp_Added:101,RecoverAction:102,selfPower:103,AttackForPvpRelated:104,AttackForPvp:105,PetChipDropNum:231,PetChipDropNumRelated:232,SkillContinueTime:315,AltarGoldOutput:212,AltarSilverOutput:213,AltarStoneOutput:214,AltarGoldOutputNum:215,AltarSilverOutputNum:216,AltarStoneOutputNum:217},effectConfig={1:{name:"圣光加护效果提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},2:{name:"增加技能4效果",calc:em_EffectCalcType.em_EffectCalc_Multiplication},3:{name:"Boss携带魂石数量提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},4:{name:"宝箱怪金币掉落数量上升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},5:{name:"金币产出加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},6:{name:"金币消耗下降",calc:em_EffectCalcType.em_EffectCalc_Multiplication},7:{name:"增加技能1时间",calc:em_EffectCalcType.em_EffectCalc_Multiplication},8:{name:"转生后初始金币增加",calc:em_EffectCalcType.em_EffectCalc_Multiplication},9:{name:"转生后起始关卡增加",calc:em_EffectCalcType.em_EffectCalc_Multiplication},10:{name:"减少技能6的CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},11:{name:"减少技能5的CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},12:{name:"减少技能1的CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},13:{name:"宝箱怪出现几率",calc:em_EffectCalcType.em_EffectCalc_Multiplication},14:{name:"延长技能6时长",calc:em_EffectCalcType.em_EffectCalc_Multiplication},15:{name:"降低技能6CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},16:{name:"点击暴强",calc:em_EffectCalcType.em_EffectCalc_Multiplication},17:{name:"英雄之魂加成效果",calc:em_EffectCalcType.em_EffectCalc_Multiplication},18:{name:"延长技能3时长",calc:em_EffectCalcType.em_EffectCalc_Multiplication},19:{name:"十倍金币概率提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},20:{name:"PVE攻击力转为点击攻击力",calc:em_EffectCalcType.em_EffectCalc_Multiplication},21:{name:"降低技能4CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},22:{name:"延长技能4时长",calc:em_EffectCalcType.em_EffectCalc_Multiplication},23:{name:"Boss携带魂石概率提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},24:{name:"延长技能5时长",calc:em_EffectCalcType.em_EffectCalc_Multiplication},25:{name:"点击暴击概率",calc:em_EffectCalcType.em_EffectCalc_Addition},26:{name:"降低技能2CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},27:{name:"Boss血量下降",calc:em_EffectCalcType.em_EffectCalc_Multiplication},28:{name:"减少普通关卡怪物数量",calc:em_EffectCalcType.em_EffectCalc_Multiplication},29:{name:"降低技能3CD",calc:em_EffectCalcType.em_EffectCalc_Multiplication},30:{name:"自动攻击次数",calc:em_EffectCalcType.em_EffectCalc_Addition},31:{name:"通用PVE战力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},32:{name:"每次攻击都掉钱",calc:em_EffectCalcType.em_EffectCalc_Addition},33:{name:"点击攻击力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},34:{name:"PVE攻击速度",calc:em_EffectCalcType.em_EffectCalc_Multiplication},39:{name:"对各类属性的Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},40:{name:"对风属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},41:{name:"对木属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},42:{name:"对火属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},43:{name:"对土属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},44:{name:"提升攻击力和点击攻击力",calc:em_EffectCalcType.em_EffectCalc_Multiplication},45:{name:"通关奖励中获得额外的金币",calc:em_EffectCalcType.em_EffectCalc_Multiplication},46:{name:"主动技能冷却时间减少",calc:em_EffectCalcType.em_EffectCalc_Multiplication},47:{name:"通关奖励中获得额外的魂石",calc:em_EffectCalcType.em_EffectCalc_Multiplication},48:{name:"离线收益提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},49:{name:"转生次数正相关的PVE攻击力、点击攻击力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},50:{name:"降低法宝升级消耗",calc:em_EffectCalcType.em_EffectCalc_Multiplication},51:{name:"通关奖励中获得额外的圣光",calc:em_EffectCalcType.em_EffectCalc_Multiplication},52:{name:"祭坛产量",calc:em_EffectCalcType.em_EffectCalc_Multiplication},101:{name:"自动攻击",calc:em_EffectCalcType.em_EffectCalc_Addition},102:{name:"对水属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},103:{name:"对风属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},104:{name:"对火属性Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},105:{name:"对Boss攻击加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},106:{name:"点击攻击力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},107:{name:"特定卡牌的PVP攻击力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},108:{name:"卡牌的PVP攻击力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},110:{name:"Boss血量下降",calc:em_EffectCalcType.em_EffectCalc_Multiplication},111:{name:"转生后PVE攻击力加成额外君主经验加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},112:{name:"转生后点击攻击力加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},113:{name:"英雄攻击速度",calc:em_EffectCalcType.em_EffectCalc_Multiplication},201:{name:"金币产出加成",calc:em_EffectCalcType.em_EffectCalc_Multiplication},202:{name:"逢20关通关奖额外金币",calc:em_EffectCalcType.em_EffectCalc_Multiplication},203:{name:"金币消耗下降",calc:em_EffectCalcType.em_EffectCalc_Multiplication},204:{name:"升级法宝的金币消耗下降",calc:em_EffectCalcType.em_EffectCalc_Multiplication},211:{name:"逢20关通关奖励额外魂石",calc:em_EffectCalcType.em_EffectCalc_Multiplication},212:{name:"祭坛金产量",calc:em_EffectCalcType.em_EffectCalc_Multiplication},213:{name:"祭坛银产量",calc:em_EffectCalcType.em_EffectCalc_Multiplication},214:{name:"祭坛石产量",calc:em_EffectCalcType.em_EffectCalc_Multiplication},215:{name:"祭坛金产量 绝对值",calc:em_EffectCalcType.em_EffectCalc_Addition},216:{name:"祭坛银产量 绝对值",calc:em_EffectCalcType.em_EffectCalc_Addition},217:{name:"祭坛石产量 绝对值",calc:em_EffectCalcType.em_EffectCalc_Addition},221:{name:"逢20关通关奖励额外圣光",calc:em_EffectCalcType.em_EffectCalc_Addition},231:{name:"宠物碎片掉落数量增加",calc:em_EffectCalcType.em_EffectCalc_Addition},232:{name:"特定宠物碎片掉落数量增加",calc:em_EffectCalcType.em_EffectCalc_Addition},301:{name:"圣光加护效果提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},302:{name:"宝箱金币掉落数量上升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},303:{name:"转生后起始关卡增加",calc:em_EffectCalcType.em_EffectCalc_Multiplication},304:{name:"PVE攻击力转为点击攻击力",calc:em_EffectCalcType.em_EffectCalc_Multiplication},305:{name:"十倍金币概率提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},306:{name:"减少普通关卡怪物数量",calc:em_EffectCalcType.em_EffectCalc_Multiplication},307:{name:"点击暴击概率",calc:em_EffectCalcType.em_EffectCalc_Multiplication},308:{name:"英雄之魂加成效果",calc:em_EffectCalcType.em_EffectCalc_Multiplication},309:{name:"点击暴强",calc:em_EffectCalcType.em_EffectCalc_Multiplication},310:{name:"Boss携带魂石概率提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},311:{name:"转生后初始金币增加",calc:em_EffectCalcType.em_EffectCalc_Multiplication},312:{name:"宝箱怪出现几率",calc:em_EffectCalcType.em_EffectCalc_Multiplication},313:{name:"Boss携带魂石数量提升",calc:em_EffectCalcType.em_EffectCalc_Multiplication},314:{name:"主动技能冷却时间减少",calc:em_EffectCalcType.em_EffectCalc_Multiplication},315:{name:"主动技能生效时长增加",calc:em_EffectCalcType.em_EffectCalc_Multiplication}},r_status=FacadeApp.cr({money:{},diamond:0,power:{},powerClick:{},offline:{},stone:0,stoneHero:0,status:0,action:0,totem:0,freePoint:0,effects:[],execute:{},guideId:0,TestInternaldan:function(t,e){return void 0===e&&(e=!1),this.stoneHero>t?!0:(e&&UIPage.inst(UIPage).ShowPrompt().ShowWindow("内丹不足！"),!1)
},TestMoney:function(t,e){void 0===e&&(e=!1);var i=Digit.fromObject(this.money);return i.Larger(t)||i.Equal(t)?!0:(e&&UIPage.inst(UIPage).ShowPrompt().ShowWindow("金钱不足！"),!1)},TestCultivation:function(t,e){return void 0===e&&(e=!1),this.stone>t?!0:(e&&UIPage.inst(UIPage).ShowPrompt().ShowWindow("修为不足！"),!1)},Calc:function(t,e){if(!this.effects[t])return e;switch(effectConfig[t].calc){case em_EffectCalcType.em_EffectCalc_Multiplication:return e*(1+this.effects[t].value);case em_EffectCalcType.em_EffectCalc_Addition:return e+this.effects[t].value;case em_EffectCalcType.em_EffectCalc_Subduction:return e-this.effects[t].value;case em_EffectCalcType.em_EffectCalc_Division:return(1-this.effects[t].value)*e}return e}},(_a={},_a[CommandList.M_DAT_Amulet]=function(t,e){var i=e.data;return t.power=i.power,t.powerClick=i.powerClick,t},_a[CommandList.M_AT_SyncCheckpoint]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.offline=i.mOffline),t},_a[CommandList.M_AT_STATUSLIST]=function(t,e){var i=e.data;return"undefined"!=typeof i&&null!=i&&(t.money=i.money,t.diamond=i.diamond,t.power=i.power,t.powerClick=i.powerClick,t.offline=i.offline,t.stone=i.stone,t.stoneHero=i.stoneHero,t.status=i.status,t.action=i.action,t.totem=i.totem,t.effects=i.effects,t.guideId=i.newGuide),t},_a[CommandList.M_DAT_TalismanList]=function(t,e){var i=e.data;return i&&i.totem&&(t.totem=i.totem,t.freePoint=i.freePoint),t},_a[CommandList.M_AT_STATUS_Power]=function(t,e){var i=e.data;return t.power=i,t},_a[CommandList.M_DAT_Status_PowerClick]=function(t,e){var i=e.data;return t.powerClick=i,t},_a[CommandList.M_DAT_Change_Money]=function(t,e){var i=e.data;return t.money=i,t},_a[CommandList.M_AT_CHANGE_OFFLINE]=function(t,e){var i=e.data;return t.offline=i,t},_a[CommandList.M_AT_EFFECTS]=function(t,e){var i=e.data;return t.effects=i,t},_a[CommandList.M_AT_ACTIONEXECUTE]=function(t,e){var i=e.data;return t.execute=i,t},_a[CommandList.M_AT_GUIDE]=function(t,e){var i=e.data;return t.guideId=i.newGuide,t},_a)),_a,UnitManager=function(){function t(){}return t.Init=function(){FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(e){if(e.code==FacadeApp.SuccessCode){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,e.data);var i=parseInt(t.PlayID),n="猴子";e.data.diamond,new Digit([e.data.money.base,e.data.money.power]);t._player=new Player(i,n),FacadeApp.Notify(CommandList.M_CMD_CHANGE,2)}else UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[e.code])}])},Object.defineProperty(t,"Player",{get:function(){return t._player},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PlayID",{get:function(){var t=GameConfigOfRuntime.IsDebug?GameConfigOfRuntime.TestUserId:egret.localStorage.getItem("playkey");return(null==t||null==t)&&(t=Math.floor(1e10*(Math.random()+1)).toString(),egret.localStorage.setItem("playkey",t)),t},enumerable:!0,configurable:!0}),t}();__reflect(UnitManager.prototype,"UnitManager");var reducers=redux.combineReducers({r_amuletInfo:r_amuletInfo,r_taskInfo:r_taskInfo,r_shopInfo:r_shopInfo,r_status:r_status,r_rankInfo:r_rankInfo,r_petInfo:r_petInfo,r_talismanInfo:r_talismanInfo,r_cardInfo:r_cardInfo,r_fightInfo:r_fightInfo,r_mailInfo:r_mailInfo,r_activityInfo:r_activityInfo});FacadeApp.inst.registerAction(CommandList.M_AT_SyncCheckpoint,FacadeApp.ca(CommandList.M_AT_SyncCheckpoint,"data")),FacadeApp.inst.registerAction(CommandList.SetTollgateProgress,FacadeApp.ca(CommandList.SetTollgateProgress,"data")),FacadeApp.inst.registerAction(CommandList.BossLifeProgress,FacadeApp.ca(CommandList.BossLifeProgress,"data")),FacadeApp.inst.registerAction(CommandList.BOSSTIME,FacadeApp.ca(CommandList.BOSSTIME,"data")),FacadeApp.inst.registerAction(CommandList.M_CMD_FIGHT_GiveUpOrFight,FacadeApp.ca(CommandList.M_CMD_FIGHT_GiveUpOrFight,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_BattleWithFlyBoss,FacadeApp.ca(CommandList.M_AT_BattleWithFlyBoss,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_ReturnTollgate,FacadeApp.ca(CommandList.M_AT_ReturnTollgate,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_EventHandleResult,FacadeApp.ca(CommandList.M_AT_EventHandleResult,"data")),FacadeApp.inst.registerAction(CommandList.M_CMD_HangUp,FacadeApp.ca(CommandList.M_CMD_HangUp,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_MailList,FacadeApp.ca(CommandList.M_DAT_MailList,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_ActivityInfo,FacadeApp.ca(CommandList.M_DAT_ActivityInfo,"data")),FacadeApp.inst.registerAction(CommandList.TASK_FINISHED_NUM,FacadeApp.ca(CommandList.TASK_FINISHED_NUM,"data")),FacadeApp.inst.registerAction(CommandList.TASK_GET_LIST,FacadeApp.ca(CommandList.TASK_GET_LIST,"data")),FacadeApp.inst.registerAction(CommandList.SHOP_GET_LIST,FacadeApp.ca(CommandList.SHOP_GET_LIST,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_PetList,FacadeApp.ca(CommandList.M_DAT_PetList,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_TalismanList,FacadeApp.ca(CommandList.M_DAT_TalismanList,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_STATUSLIST,FacadeApp.ca(CommandList.M_AT_STATUSLIST,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_STATUS_Power,FacadeApp.ca(CommandList.M_AT_STATUS_Power,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_Status_PowerClick,FacadeApp.ca(CommandList.M_DAT_Status_PowerClick,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_Change_Money,FacadeApp.ca(CommandList.M_DAT_Change_Money,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_CHANGE_OFFLINE,FacadeApp.ca(CommandList.M_AT_CHANGE_OFFLINE,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_GUIDE,FacadeApp.ca(CommandList.M_AT_GUIDE,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_CardList,FacadeApp.ca(CommandList.M_DAT_CardList,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_MarshallingList,FacadeApp.ca(CommandList.M_DAT_MarshallingList,"data")),FacadeApp.inst.registerAction(CommandList.M_DAT_Amulet,FacadeApp.ca(CommandList.M_DAT_Amulet,"data")),FacadeApp.inst.registerAction(CommandList.RANK_GET_LIST1,FacadeApp.ca(CommandList.RANK_GET_LIST1,"data")),FacadeApp.inst.registerAction(CommandList.RANK_GET_LIST2,FacadeApp.ca(CommandList.RANK_GET_LIST2,"data")),FacadeApp.inst.registerAction(CommandList.RANK_GET_LIST3,FacadeApp.ca(CommandList.RANK_GET_LIST3,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_EFFECTS,FacadeApp.ca(CommandList.M_AT_EFFECTS,"data")),FacadeApp.inst.registerAction(CommandList.M_AT_ACTIONEXECUTE,FacadeApp.ca(CommandList.M_AT_ACTIONEXECUTE,"data"));var AchievementLine=function(t){function e(){var e=t.call(this)||this;return e._isCreat=!1,e.skinName="resource/game_skins/achievement/AchievementLineSkins.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"getId",{get:function(){return this._achievement?this._achievement.ID:-1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this._achievement=TaskManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._lingquBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick,this),this._isCreat=!0,this.Render()},e.prototype.Render=function(){var t=this;if(this._isCreat){this._nameLabel.text=this._achievement.Name,this._derLabel.text=this._achievement.Description,this._iconIma.source=this._achievement.IconRes;var e=this._achievement.ori.conditionMgr.conList;if(Object.keys(e).map(function(i){var n=e[i];t._jinduLabel.text=n.value+"/"+n.threshold,t._pregrossIma.width=316*Math.min(n.value/n.threshold,1)}),this._achievement.ori.bonusMgr){var i=this._achievement.ori.bonusMgr.bonusList;this._addLabel.visible=!0,Object.keys(i).map(function(e){var n=i[e];t._addLabel.text=RewardItemManager.GetRewardItemNameByID[n.type]+": "+n.value})}else this._addLabel.visible=!1;this._levelLabel.text=this._achievement.ori.layer,this._lingquBtn.enabled=!(0==this._achievement.ori.status),this._lingquBtn.visible=2!=this._achievement.ori.status}},e.prototype._OnButtonClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_TASK,"&oper=1&id="+this._achievement.ID],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.fetchData([CommandList.M_NET_TASK,"&oper=0"],[function(e){e.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.TASK_GET_LIST,t.data.items),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data)}])):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._SetFilter=function(){},e}(eui.Component);__reflect(AchievementLine.prototype,"AchievementLine",["IGroupLine","egret.DisplayObject"]);var AchievementWindow=function(t){function e(){var i=t.call(this,"resource/game_skins/achievement/AchievementWindowSkins.exml")||this;return i._cjLineSet=[],t.prototype.InitComponent.call(i,i._cjGroup,i._cjScroller,[function(){return e.genericsFactory(AchievementLine)}],[function(){var t=FacadeApp.read(CommandList.Re_TaskInfo).list,e=Object.keys(t).filter(function(e){var i=t[e];return i.id>=1e3&&i.id<2e3?!0:!1});return[t,e]}]),FacadeApp.inst.removeMediator(ViewerName.AchievementWindowMediator),FacadeApp.inst.registerMediator(new AchievementWindowMediator(i)),i}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,FacadeApp.Notify(CommandList.M_CMD_UiOpened_Achievement)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanelList);__reflect(AchievementWindow.prototype,"AchievementWindow");var AchievementWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.AchievementWindowMediator,e)||this;return i.page.RegisterDataSource([CommandList.TASK_GET_LIST]),i}return __extends(e,t),e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Achievement]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Achievement:FacadeApp.fetchData([CommandList.M_NET_TASK,"&oper=0"],[function(t){FacadeApp.dispatchAction(CommandList.TASK_GET_LIST,t.data.items),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(AchievementWindowMediator.prototype,"AchievementWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var AmuletDetail=function(t){function e(){return t.call(this,"resource/game_skins/amulet/AmuletDetailWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.anchorOffsetX=320,this.anchorOffsetY=568,this.x=320,this.y=568,this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype.ShowAmulet=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return null==t?[2]:(this._iconIma.source=t.Icon+"_png",this._nameIma.source=t.NameIma+"_png",this._curLevelLabel.text="Lv."+t.Level.toString(),this._descriptionLabel.text=t.Description,this._ShowMovie(),[2])})})},e.prototype._ShowMovie=function(){this.scaleX=0,this.scaleY=0;var t=egret.Tween.get(this);t.to({scaleX:1,scaleY:1},200)},e}(APanel);__reflect(AmuletDetail.prototype,"AmuletDetail");var AmuletDetailList=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/amulet/AmuletDetailListSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype._OnUpLevelClick=function(t){SoundManager.PlayButtonMusic()},e.prototype._ReceveUpdate=function(t){},e.prototype.ShowAmulet=function(t){null!=t&&(this._amulet=t,this._iconIma.texture=RES.getRes(t.Icon+"_png"),this._nameIma.texture=RES.getRes(t.NameIma+"_png"),this._stateIma.visible=!0)},Object.defineProperty(e.prototype,"Amulet",{get:function(){return this._amulet},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(AmuletDetailList.prototype,"AmuletDetailList");var AmuletLine=function(t){function e(){var e=t.call(this)||this;return e._isCreatCom=!1,e.skinName="resource/game_skins/amulet/AmuletListSkins.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"getId",{get:function(){return this._amulet?this._amulet.ID:-1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this._amulet=AmuletManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._upButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUpLevelClick,this),this._icoIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnImageClick,this),this._isCreatCom=!0,this.Render()},e.prototype.Render=function(){0!=this._isCreatCom&&(this._icoIma.source=this.Amulet.Icon+"_png",this._nameIma.source=this.Amulet.NameIma+"_png",this._leveLabel.text="Lv."+this.Amulet.Level.toString()+"/"+this.Amulet.MaxLevel,this._upNDString=this._amulet.UpLVInternaldan.ShowToString,this._upButton.updateShow(1,[this._upNDString,"升级"]),"无限"==this.Amulet.MaxLevel||this.Amulet.Level<parseInt(this.Amulet.MaxLevel)?(this._stateIma.visible=!1,this._upButton.visible=!0):(this._stateIma.visible=!0,this._upButton.visible=!1))},e.prototype._OnUpLevelClick=function(t){FacadeApp.fetchData([CommandList.M_NET_Amulet,"&oper=2&pm=1&id="+this.Amulet.ID],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_Amulet,t.data),t.code==FacadeApp.SuccessCode?SoundManager.PlayLvupMusic():UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},Object.defineProperty(e.prototype,"Amulet",{get:function(){return this._amulet},enumerable:!0,configurable:!0}),e.prototype._OnImageClick=function(t){FacadeApp.Notify(CommandList.M_CMD_ShowAmuletDetail,this._amulet)},e.prototype.changeState=function(t){"huidu"==t?(this._bgIma.setHuiduState(),this._icoIma.filters=[FilterManage.HuiDu],this._upButton.setEnabled(!1),this._upButton.setDisabled()):"gaoliang"==t?(this._bgIma.setGaoLiangState(),this._icoIma.filters=null,this._upButton.setEnabled(!0),this._upButton.setNormal()):"normal"==t&&(this._bgIma.setNormalState(),this._icoIma.filters=null,this._upButton.setEnabled(!0),this._upButton.setNormal())},e}(eui.Component);__reflect(AmuletLine.prototype,"AmuletLine",["IGroupLine","egret.DisplayObject"]);var AmuletPokedexWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/amulet/AmuletPokedexWindowSkins.exml")||this;return t.prototype.InitComponent.call(e,e._amuletGroup,e._amuletList,[function(){return AmuletWindow.genericsFactory(AmuletLine)}],[function(){var t=FacadeApp.read(CommandList.Re_AmuletInfo).list,e=Object.keys(t).filter(function(t){return!0});return[t,e]}]),e.RegisterDataSourceFun(),e}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.RegisterDataSource([CommandList.M_DAT_Amulet])},e.prototype.ComponentWillMount=function(){this.anchorOffsetX=320,this.anchorOffsetY=568,this.x=320,this.y=568,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,this._ShowMovie(),FacadeApp.Notify(CommandList.M_CMD_UiOpened_Amulet)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._ShowMovie=function(){this.scaleX=0,this.scaleY=0;var t=egret.Tween.get(this);t.to({scaleX:1,scaleY:1},200)},e}(APanelList);__reflect(AmuletPokedexWindow.prototype,"AmuletPokedexWindow");var AmuletWindow=function(t){function e(){var i=t.call(this,"resource/game_skins/amulet/AmuletWindowSkins.exml")||this;return i._listLength=AmuletManager.AmuletSet.length-1,t.prototype.InitComponent.call(i,i._amuletGroup,i._amuletList,[function(){return e.genericsFactory(AmuletLine)}],[function(){var t=FacadeApp.read(CommandList.Re_AmuletInfo).list,e=Object.keys(t).filter(function(t){return!0});return this._listLength=e.length,[t,e]}]),FacadeApp.inst.removeMediator(ViewerName.AmuletWindowMediator),FacadeApp.inst.registerMediator(new AmuletWindowMediator(i)),i}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.y=GameConfigOfRuntime.gameHeight,this._totalNDLabel.rotation=4,this._totalXWLabel.rotation=4,this._amuletList.height=250,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._upOrDownButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._UpOrDownPanel,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,FacadeApp.Notify(CommandList.M_CMD_UiOpened_Amulet)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),this._totalNDLabel.text=FacadeApp.read(CommandList.Re_AmuletInfo).stoneHero,this._totalXWLabel.text=FacadeApp.read(CommandList.Re_AmuletInfo).stone,[2]})})},e.prototype._OnCloseClick=function(t){this.CloseWindow()},e.prototype._UpOrDownPanel=function(){SoundManager.PlayButtonMusic(),t.prototype._UpOrDown.call(this,this._upOrDownButton.selected,this._amuletList)},e.prototype._Compelet=function(){this._amuletGroup.y<Math.min(this._amuletGroup.height-820,0)&&(this._amuletGroup.y=Math.min(this._amuletGroup.height-820,0))},e}(APanelList);__reflect(AmuletWindow.prototype,"AmuletWindow");var AmuletWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.AmuletWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.M_DAT_Amulet,CommandList.M_DAT_Change_Money])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Amulet]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Amulet:FacadeApp.fetchData([CommandList.M_NET_Amulet,"&oper=1&id=0&pm=0"],[function(t){t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]),FacadeApp.dispatchAction(CommandList.M_DAT_Amulet,t.data)}]),2==FacadeApp.read(CommandList.Re_Status).guideId&&GuideWindow.inst(GuideWindow).GuideFinish(FacadeApp.read(CommandList.Re_Status).guideId)}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(AmuletWindowMediator.prototype,"AmuletWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var BG=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._imageArr1=[],e._imageArr2=[],e._imageArr3=[],e}return __extends(e,t),e.GetInstance=function(){return this._instance||(this._instance=new e,this._instance._InIt()),this._instance},e.GetInstance2=function(){return this._instance2||(this._instance2=new e,this._instance2._InIt(),this._instance2.SetPVPBG()),this._instance2},e.prototype._InIt=function(){for(var t=-1;2>t;t++)this._image=new eui.Image,this._image.source=RES.getRes("yuanjing1_jpg"),this._image.x=1420*t,this.addChild(this._image),this._imageArr1.push(this._image);for(t=-1;2>t;t++)this._image=new eui.Image,this._image.source=RES.getRes("jinjing1_png"),this._image.x=1845*t,this.addChild(this._image),this._imageArr2.push(this._image);for(t=-1;2>t;t++)this._image=new eui.Image,this._image.source=RES.getRes("dimian1_png"),this._image.x=2488*t,this.addChild(this._image),this._imageArr3.push(this._image)},e.prototype.SetPVPBG=function(){for(var t=0;t<this._imageArr1.length;t++)this._imageArr1[t].source="yuanjing2_jpg";for(t=0;t<this._imageArr2.length;t++)this._imageArr2[t].source="jinjing2_png";for(t=0;t<this._imageArr3.length;t++)this._imageArr3[t].source="dimian2_png"},e.prototype._SetPosition=function(){if(this._imageArr1[0].x<-2840&&(this._imageArr1[0].x=this._imageArr1[2].x+1420,this._imageArr1.push(this._imageArr1[0]),this._imageArr1.splice(0,1)),this._imageArr2[0].x<-3690&&(this._imageArr2[0].x=this._imageArr2[2].x+1845,this._imageArr2.push(this._imageArr2[0]),this._imageArr2.splice(0,1)),this._imageArr3[0].x<-4976&&(this._imageArr3[0].x=this._imageArr3[2].x+2488,this._imageArr3.push(this._imageArr3[0]),this._imageArr3.splice(0,1)),this._imageArr1[2].x>2840){this._imageArr1[2].x=this._imageArr1[0].x-1420;var t=this._imageArr1[2];this._imageArr1.splice(2,1),this._imageArr1.splice(0,0,t)}if(this._imageArr2[2].x>3690){this._imageArr2[2].x=this._imageArr2[0].x-1845;var t=this._imageArr2[2];this._imageArr2.splice(2,1),this._imageArr2.splice(0,0,t)}if(this._imageArr3[2].x>4976){this._imageArr3[2].x=this._imageArr3[0].x-2488;var t=this._imageArr3[2];this._imageArr3.splice(2,1),this._imageArr3.splice(0,0,t)}},e.prototype.Move=function(t,e){this._SetPosition();for(var i=0;3>i;i++){egret.Tween.removeTweens(this._imageArr1[i]);var n=egret.Tween.get(this._imageArr1[i]),a=this._imageArr1[i].x-.6*t;n.to({x:a},e),egret.Tween.removeTweens(this._imageArr2[i]);var o=egret.Tween.get(this._imageArr2[i]),r=this._imageArr2[i].x-.8*t;o.to({x:r},e),egret.Tween.removeTweens(this._imageArr3[i]);var s=egret.Tween.get(this._imageArr3[i]),c=this._imageArr3[i].x-t;s.to({x:c},e)}Decoration.GetInstance().move(t,e)},e.prototype.RemoveTween=function(){for(var t=0;3>t;t++)egret.Tween.removeTweens(this._imageArr1[t]),egret.Tween.removeTweens(this._imageArr2[t]),egret.Tween.removeTweens(this._imageArr3[t])},e}(egret.Sprite);__reflect(BG.prototype,"BG");var Decoration=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._imageArr4=[],e}return __extends(e,t),e.GetInstance=function(){return this._instance||(this._instance=new e,this._instance._Init()),this._instance},e.GetInstance2=function(){return this._instance2||(this._instance2=new e,this._instance2._Init()),this._instance2},e.prototype._Init=function(){for(var t=0;2>t;t++)this._image=new eui.Image,this._image.source=RES.getRes("qianjing1_png"),this._image.x=2488*t,this.addChild(this._image),this._imageArr4.push(this._image)},e.prototype._SetPosition=function(){this._imageArr4[0].x<-2488&&(this._imageArr4[0].x=this._imageArr4[1].x+2488,this._imageArr4.push(this._imageArr4[0]),this._imageArr4.splice(0,1))},e.prototype.move=function(t,e){this._SetPosition();for(var i=0;2>i;i++){egret.Tween.removeTweens(this._imageArr4[i]);var n=egret.Tween.get(this._imageArr4[i]),a=this._imageArr4[i].x-1.2*t;n.to({x:a},e)}},e.prototype.RemoveTween=function(){for(var t=0;2>t;t++)egret.Tween.removeTweens(this._imageArr4[t])},e}(egret.Sprite);__reflect(Decoration.prototype,"Decoration");var BuddhaChange=function(t){function e(){var e=t.call(this)||this;return e._curChooseNum=0,e._isCreat=!1,e._talisman=null,e.skinName="resource/game_skins/buddha/BuddhaChangeSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._curChooseIma.visible=!1,this._curChooseIma.touchEnabled=!1,this._chooseOneIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnChooseOneClick,this),this._chooseTwoIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnChooseTwoClick,this),this._isCreat=!0,this.updataShow(this._talisman)},e.prototype._OnChooseOneClick=function(t){1==this._curChooseNum?(this._curChooseIma.visible=!1,this._curChooseNum=0):(this._curChooseIma.visible=!0,this._curChooseIma.x=t.target.x,this._curChooseIma.y=t.target.y,this._curChooseNum=1)},e.prototype._OnChooseTwoClick=function(t){2==this._curChooseNum?(this._curChooseIma.visible=!1,this._curChooseNum=0):(this._curChooseIma.visible=!0,this._curChooseIma.x=t.target.x,this._curChooseIma.y=t.target.y,this._curChooseNum=2)},e.prototype.updataShow=function(t){this._talisman=t,this._isCreat&&(this._iconIma.source=this._talisman.Icon+"_png",this._nameIma.source=this._talisman.NameRes+"_png")},Object.defineProperty(e.prototype,"CurChooseNum",{get:function(){return this._curChooseNum},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(BuddhaChange.prototype,"BuddhaChange");var BuddhaGuardWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/buddha/BuddhaGuardWindowSkins.exml")||this;return e._armature=null,FacadeApp.inst.removeMediator(ViewerName.BuddhaGuardMediator),FacadeApp.inst.registerMediator(new BuddhaManagerMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._shouhuBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnGuardClick,this),this._lookForBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnLookForClick,this)},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Talisman)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},e.prototype.onAccess=function(){t.prototype.onAccess.call(this),this._iconIma.visible=!1,this._iconBgIma.visible=!1,this._shouhuBtn.visible=!0,this._lookForBtn.enabled=!1},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnGuardClick=function(t){var e=this;this._shouhuBtn.visible=!1,FacadeApp.fetchData([CommandList.M_NET_TalismanNum,"&oper=4&id&pm="+FacadeApp.read(CommandList.Re_Status).totem],[function(t){t.code==FacadeApp.SuccessCode?Object.keys(t.data.reAssign).map(function(t){e.creatBuddhaGuardAni(t)}):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]),FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList,t.data)}])},e.prototype._OnLookForClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister(),FacadeApp.Notify(CommandList.M_CMD_UiOpened_Buddha)},e.prototype.creatBuddhaGuardAni=function(t){return __awaiter(this,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return e=this,[4,MovieManage.PromisifyGetDragonBonesMovie("foguang_sh",this)];case 1:return e._armature=n.sent(),this.addChild(this._armature.display),this._armature.display.x=0,this._armature.display.y=0,this._armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(e){i._iconIma.visible=!0,i._iconBgIma.visible=!0;var n=TalismanManager.GetTalismanByID(t);RES.getResAsync(n.Icon+"_png",function(t){i._iconIma.texture=t},i),MovieManage.RemoveArmature(e.target.parent),i.removeChild(e.target),i._armature=null,i._lookForBtn.enabled=!0},this),this._armature.animation.gotoAndPlay("foguang_sh"),[2]}})})},e}(APanel);__reflect(BuddhaGuardWindow.prototype,"BuddhaGuardWindow");var BuddhaGuardMediator=function(t){function e(e){var i=t.call(this,ViewerName.BuddhaGuardMediator,e)||this;return i.main.RegisterDataSource([CommandList.M_DAT_TalismanList]),i}return __extends(e,t),e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Talisman]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Talisman:FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList)}},Object.defineProperty(e.prototype,"main",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(BuddhaGuardMediator.prototype,"BuddhaGuardMediator",["puremvc.IMediator","puremvc.INotifier"]);var BuddhaLine=function(t){function e(e){var i=t.call(this)||this;return i.skinName="resource/game_skins/buddha/BuddhaLineSkins.exml",i.talisman=e,i}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._chooseBg.visible=!1,this.UpdateShow()},e.prototype.UpdateShow=function(){this._fgIconIma.source=this.talisman.Icon+"_png",this.talisman.ori?(this._fgBgIma.source="foguang_youxingk_png",this._fgNumText.text=this.talisman.ori.p):(this._fgBgIma.source="foguang_wuxingk_png",this._fgNumText.text="0"),this.talisman.Level<1?this._fgIconIma.filters=[FilterManage.HuiDu]:this._fgIconIma.filters=[]},Object.defineProperty(e.prototype,"Talisman",{get:function(){return this.talisman},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Icon",{get:function(){return this._fgIconIma},enumerable:!0,configurable:!0}),e.prototype.ChooseBg=function(t){this._chooseBg.visible=t},e}(eui.Component);__reflect(BuddhaLine.prototype,"BuddhaLine");var BuddhaManagerMediator=function(t){function e(e){var i=t.call(this,ViewerName.BuddhaManagerMediator,e)||this;return i.main.RegisterDataSource([CommandList.M_DAT_TalismanList]),i}return __extends(e,t),e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Talisman]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Talisman:FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList)}},Object.defineProperty(e.prototype,"main",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(BuddhaManagerMediator.prototype,"BuddhaManagerMediator",["puremvc.IMediator","puremvc.INotifier"]);var BuddhaManagerWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/buddha/BuddhaManagerWindowSkins.exml")||this;return e._armature=null,e.lineSelected=null,FacadeApp.inst.removeMediator(ViewerName.BuddhaManagerMediator),FacadeApp.inst.registerMediator(new BuddhaManagerMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._changeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnChangeClick,this),this._freeChangeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnChangeClick,this),this._changeBtn.updateShow(2,["佛光转移","-20"]),this._freeChangeBtn.updateShow(2,["免费转移","3"]),this.Render()},e.prototype.ComponentDidMount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return FacadeApp.Notify(CommandList.M_CMD_UiOpened_Talisman),this.lineSelected&&(this.lineSelected.ChooseBg(!0),this._fgChange.updataShow(this.lineSelected.Talisman),this._fgChange.visible=!0),[2]})})},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,a,o,r,s,c=this;return __generator(this,function(l){for(FacadeApp.read(CommandList.Re_Status).freePoint>0?(t=FacadeApp.read(CommandList.Re_Status).freePoint,this._freeChangeBtn.updateShow(2,["免费转移",t]),this._freeChangeBtn.visible=!0,this._changeBtn.visible=!1):(this._changeBtn.updateShow(2,["佛光转移","-20"]),this._freeChangeBtn.visible=!1,this._changeBtn.visible=!0),null==this._fgLineSet&&(this._fgLineSet=[]),e=this,i=FacadeApp.read(CommandList.Re_TalismanInfo).list,n=0,Object.keys(i).map(function(t){var a=i[t],o=null;"undefined"==typeof e._fgLineSet[a.i]||null==e._fgLineSet[a.i]?(o=new BuddhaLine(TalismanManager.fromData(a)),o.addEventListener(egret.TouchEvent.TOUCH_TAP,c._OnFoGuangImaClick,c),e._fgLineSet[a.i]=o):o=e._fgLineSet[a.i],n+=o.Talisman.ori.p,null==e.lineSelected&&(e.lineSelected=o,e._fgChange.updataShow(e.lineSelected.Talisman))}),this._fgNumLabel.text=n.toString(),a=1,o=0,r=0;null!=TalismanManager.GetTalismanByID(a);)s=null,"undefined"==typeof e._fgLineSet[a]||null==e._fgLineSet[a]?(s=new BuddhaLine(TalismanManager.GetTalismanByID(a)),e._fgLineSet[a]=s):(s=e._fgLineSet[a],s.UpdateShow()),s.x=r,s.y=o,e._fgGroup.addChild(s),r+=s.width,r>=5*s.width&&(r=0,o+=s.height),a++;return[2]})})},e.prototype._OnFoGuangImaClick=function(t){var e=t.target.parent;if(e!=this.lineSelected){if(!(e instanceof BuddhaLine))return;this.lineSelected.ChooseBg(!1),this.lineSelected=e,this.lineSelected.ChooseBg(!0),this._fgChange.updataShow(this.lineSelected.Talisman),this._fgChange.visible=!0
}},e.prototype._OnChangeClick=function(t){var e=this;if(this.lineSelected&&this.lineSelected.Talisman.ori){this.lineSelected&&this.lineSelected.ChooseBg(!1);var i=1;switch(this._fgChange._curChooseNum){case 1:i=FacadeApp.read(CommandList.Re_Status).freePoint>0?Math.min(10,Math.min(FacadeApp.read(CommandList.Re_Status).freePoint,this.lineSelected.Talisman.ori.p)):Math.min(10,this.lineSelected.Talisman.ori.p);break;case 2:i=FacadeApp.read(CommandList.Re_Status).freePoint>0?Math.min(FacadeApp.read(CommandList.Re_Status).freePoint,this.lineSelected.Talisman.ori.p):this.lineSelected.Talisman.ori.p}FacadeApp.fetchData([CommandList.M_NET_TalismanNum,"&oper=3&id="+this.lineSelected.Talisman.ori.i+"&pm="+i],[function(t){if(t.code==FacadeApp.SuccessCode){var i=[],n=e.lineSelected.Talisman.ori.i;Object.keys(t.data.reAssign).map(function(a){i.push(e.creatChangeAni(n,parseInt(a),t.data.reAssign[a]))}),Promise.all(i).then(function(e){FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList,t.data)})}else UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},e.prototype.creatChangeAni=function(t,e,i){var n=this;return new Promise(function(i,a){RES.getResAsync("foguang_fp02_png",function(a){var o=ObjectPool.getPool("eui.Image").borrowObject();o.texture=a,n._fgGroup.addChild(o),o.scaleX=.5,o.scaleY=.5,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,o.x=n._fgLineSet[t].x+n._fgLineSet[t].width/2,o.y=n._fgLineSet[t].y+n._fgLineSet[t].height/2;for(var r=[],s=0;4>s;s++){var c=0;if(r.length>1)if(3>s){do c=Math.floor(Math.random()*(n._fgLineSet.length-1))+1;while(r[r.length-1]==c)}else do c=Math.floor(Math.random()*(n._fgLineSet.length-1))+1;while(r[r.length-1]==c||c==e);else c=Math.floor(Math.random()*(n._fgLineSet.length-1))+1;r.push(c)}r.push(e),egret.Tween.get(o).to({x:n._fgLineSet[r[0]].x+n._fgLineSet[r[0]].width/2,y:n._fgLineSet[r[0]].y+n._fgLineSet[r[0]].height/2},300).to({x:n._fgLineSet[r[1]].x+n._fgLineSet[r[1]].width/2,y:n._fgLineSet[r[1]].y+n._fgLineSet[r[1]].height/2},300).to({x:n._fgLineSet[r[2]].x+n._fgLineSet[r[2]].width/2,y:n._fgLineSet[r[2]].y+n._fgLineSet[r[2]].height/2},300).to({x:n._fgLineSet[r[3]].x+n._fgLineSet[r[3]].width/2,y:n._fgLineSet[r[3]].y+n._fgLineSet[r[3]].height/2},300).to({x:n._fgLineSet[r[4]].x+n._fgLineSet[r[4]].width/2,y:n._fgLineSet[r[4]].y+n._fgLineSet[r[4]].height/2},300).call(function(){this.starMoveEnd(o,t,e),i()}.bind(n))},n)})},e.prototype.starMoveEnd=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var e,n,a,o=this;return __generator(this,function(r){switch(r.label){case 0:return ObjectPool.getPool("eui.Image").returnObject(t),this._fgGroup.removeChild(t),e=ObjectPool.getPool("eui.Image").borrowObject(),n=e,[4,MovieManage.PromisifyGetRes("foguang_fp02_png",this)];case 1:return n.texture=r.sent(),this._fgGroup.addChild(e),e.scaleX=1,e.scaleY=1,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=this._fgLineSet[i].x+this._fgLineSet[i].width/2,e.y=this._fgLineSet[i].y+this._fgLineSet[i].height/2,[4,MovieManage.PromisifyGetDragonBonesMovie("foguang_fp03",this)];case 2:return a=r.sent(),this._fgGroup.addChild(a.display),a.display.anchorOffsetX=0,a.display.anchorOffsetY=0,a.display.x=this._fgLineSet[i].x+this._fgLineSet[i].width/2,a.display.y=this._fgLineSet[i].y+this._fgLineSet[i].height-10,a.animation.gotoAndPlay("foguang_fp03"),a.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(t){ObjectPool.getPool("eui.Image").returnObject(e),o._fgGroup.removeChild(e),MovieManage.RemoveArmature(t.target.parent),o._fgGroup.removeChild(t.target),a=null},this),[2]}})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister(),FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_CONTINUE)},e}(APanel);__reflect(BuddhaManagerWindow.prototype,"BuddhaManagerWindow");var CardDetail=function(t){function e(){return t.call(this,"resource/game_skins/card/CardDetailSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.anchorOffsetX=320,this.anchorOffsetY=568,this.x=320,this.y=568,this._iconImage=new CardImage,this._iconImage.x=27,this._iconImage.y=159,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._upButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUpClick,this),this._strengthenButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStrengthenClick,this),this._jhButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStrengthenClick,this),this._jjButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAdvanceClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnUpClick=function(t){var e=this;SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=2&pm=1&id="+this._card.ID],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),e.ShowGhost(e._card,null)):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),console.log("升级")},e.prototype._OnStrengthenClick=function(t){var e=this;SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=3&id="+this._card.ID+"&pm=1"],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),e.ShowGhost(e._card,null)):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),console.log("解锁,强化")},e.prototype._OnAdvanceClick=function(t){var e=this;SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=4&pm=1&id="+this._card.ID],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),e.ShowGhost(e._card,null)):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),console.log("进阶")},e.prototype._OnAddClick=function(t){SoundManager.PlayButtonMusic(),console.log("添加")},e.prototype.ShowGhost=function(t,e){switch(void 0===e&&(e=1),this._card=t,this._iconImage.ShowCard(this._card),this.addChild(this._iconImage),this._upButton.visible=!1,this._jjButton.visible=!1,this._jhButton.visible=!1,this._strengthenButton.visible=!1,this._card.ChooseButton){case 1:this._upButton.visible=!0,this._progressLabel.text="强化碎片:"+this._card.Chip+"/"+this._card.Chip_up,this._progressTiaoIma.width=314*Math.min(this._card.Chip/this._card.Chip_up,1);break;case 2:this._strengthenButton.visible=!0,this._progressLabel.text="专属碎片:"+this._card.ori.p+"/"+this._card.Chip_en,this._progressTiaoIma.width=314*Math.min(this._card.ori.p/this._card.Chip_en,1);break;case 3:this._jjButton.visible=!0,this._progressLabel.text="进阶碎片:"+this._card.AdChip+"/"+this._card.Chip_adv,this._progressTiaoIma.width=314*Math.min(this._card.AdChip/this._card.Chip_adv,1);break;case 4:this._jhButton.visible=!0,this._progressLabel.text="专属碎片:"+this._card.ori.p+"/"+this._card.Chip_en,this._progressTiaoIma.width=314*Math.min(this._card.ori.p/this._card.Chip_en,1)}this._gjLabel.text=this._card.Attack.toString(),this._fyLabel.text=this._card.Defense.toString(),this._bjLabel.text=this._card.Spirituality.toString(),this._sbLabel.text=this._card.Hamility.toString(),this._llLabel.text=this._card.Valor.toString(),this._hjLabel.text=this._card.Sacrifice.toString(),this._rxLabel.text=this._card.Honesty.toString(),this._jzLabel.text=this._card.Honor.toString(),this._gdLabel.text=this._card.Compassion.toString(),this._mzLabel.text=this._card.Justice.toString(),1==e&&this._ShowMovie()},e.prototype._ShowMovie=function(){this.scaleX=0,this.scaleY=0;var t=egret.Tween.get(this);t.to({scaleX:1,scaleY:1},200)},e}(APanel);__reflect(CardDetail.prototype,"CardDetail");var CardImage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/card/CardImageSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.ShowCard=function(t,e){return void 0===e&&(e=!1),__awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:return i=this._iconIma,[4,MovieManage.PromisifyGetRes(t.Prototype.QSRes)];case 1:return i.texture=n.sent(),this._natureIma.source=this.getNatureRes(t.Prototype.Nature),this._professionIma.source=this.getProfessionRes(t.Prototype.Profession),this._rtypeIma.source=this.getRtypeRes(t.Ad),this._starIma1.source=t.En>=1?"shenmo_kapai_xing_png":"shenmo_kapai_kongxing_png",this._starIma2.source=t.En>=2?"shenmo_kapai_xing_png":"shenmo_kapai_kongxing_png",this._starIma3.source=t.En>=3?"shenmo_kapai_xing_png":"shenmo_kapai_kongxing_png",this._starIma4.source=t.En>=4?"shenmo_kapai_xing_png":"shenmo_kapai_kongxing_png",this._starIma5.source=t.En>=5?"shenmo_kapai_xing_png":"shenmo_kapai_kongxing_png",e?this._ifGetIma.visible=e?!1:!0:this._ifGetIma.visible=t.Lv<=0?!0:!1,[2]}})})},e.prototype.getNatureRes=function(t){switch(t){case 1:return"shenmo_shu_jin_png";case 2:return"shenmo_shu_mu_png";case 3:return"shenmo_shu_shui_png";case 4:return"shenmo_shu_huo_png";case 5:return"shenmo_shu_tu_png"}},e.prototype.getProfessionRes=function(t){switch(t){case 0:return"shenmo_xian_fu_png";case 1:return"shenmo_xian_mo_png";case 2:return"shenmo_xian_shen_png";case 3:return"shenmo_xian_xian_png"}},e.prototype.getRtypeRes=function(t){switch(t){case 1:return"shenmo_kapai_baikuang_png";case 2:return"shenmo_kapai_lvkuang_png";case 3:return"shenmo_kapai_lankuang_png";case 4:return"shenmo_kapai_zikuang_png";case 5:return"shenmo_kapai_jinkuang_png"}},e}(eui.Component);__reflect(CardImage.prototype,"CardImage");var CardLine=function(t){function e(){var e=t.call(this)||this;return e._isCreat=!1,e.skinName="resource/game_skins/card/CardListSkins.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"getId",{get:function(){return this.Card?this.Card.ID:-1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this._card=CardManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._stateButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStateClick,this),this._iconIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnImageClick,this),this._strengthenButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStrengthenClick,this),this._jhButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStrengthenClick,this),this._jjButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAdvanceClick,this),this._isCreat=!0,this.Render()},e.prototype.Render=function(){if(this._isCreat){switch(this._stateButton.visible=!1,this._jjButton.visible=!1,this._jhButton.visible=!1,this._strengthenButton.visible=!1,this._card.ChooseButton){case 1:this._stateButton.visible=!0,this._progressLabel.text=this._card.Chip+"/"+this._card.Chip_up,this._progressIma.width=192*Math.min(this._card.Chip/this._card.Chip_up,1);break;case 2:this._strengthenButton.visible=!0,this._progressLabel.text=this._card.ori.p+"/"+this._card.Chip_en,this._progressIma.width=192*Math.min(this._card.ori.p/this._card.Chip_en,1);break;case 3:this._jjButton.visible=!0,this._progressLabel.text=this._card.AdChip+"/"+this._card.Chip_adv,this._progressIma.width=192*Math.min(this._card.AdChip/this._card.Chip_adv,1);break;case 4:this._jhButton.visible=!0,this._progressLabel.text=this._card.ori.p+"/"+this._card.Chip_en,this._progressIma.width=192*Math.min(this._card.ori.p/this._card.Chip_en,1)}this._iconIma.source=this._card.Prototype.HeadRes,this._nameIma.source=this._card.Prototype.NameIcon,this._iconIma.filters=this._card.Lv<=0?[FilterManage.HuiDu]:[]}},e.prototype._OnStateClick=function(t){var e=this;SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=2&pm=1&id="+this.Card.ID],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),e.Render()):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._OnStrengthenClick=function(t){var e=this;SoundManager.PlayLvupMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=3&id="+this._card.ID+"&pm=1"],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),e.Render()):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._OnAdvanceClick=function(t){var e=this;SoundManager.PlayLvupMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=4&pm=1&id="+this._card.ID],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=1"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data)}]),e.Render()):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._OnImageClick=function(t){FacadeApp.Notify(CommandList.M_CMD_ShowCard,this._card)},Object.defineProperty(e.prototype,"Card",{get:function(){return this._card},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(CardLine.prototype,"CardLine",["IGroupLine","egret.DisplayObject"]);var CardWindow=function(t){function e(){var i=t.call(this,"resource/game_skins/card/CardWindowSkins.exml")||this;return t.prototype.InitComponent.call(i,i._cardGroup,i._cardList,[function(){return e.genericsFactory(CardLine)}],[function(){var t=FacadeApp.read(CommandList.Re_CardtInfo).list,e=Object.keys(t).filter(function(t){return!0});return[t,e]}]),FacadeApp.inst.removeMediator(ViewerName.CardWindowMediator),FacadeApp.inst.registerMediator(new CardWindowMediator(i)),i}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.y=GameConfigOfRuntime.gameHeight,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._tzzrButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnTZZRClick,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,FacadeApp.Notify(CommandList.M_CMD_UiOpened_Card)},e.prototype.BouncedPanel=function(t){return egret.Tween.removeTweens(this),egret.Tween.get(this).to({y:-26},208).to({y:0},250).to({y:6},83).to({y:0},83),this},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),[2]})})},e.prototype._OnCloseClick=function(t){this.CloseWindow()},e.prototype._OnTZZRClick=function(t){FacadeApp.Notify(CommandList.M_CMD_ShowPVPMarshalling,null)},e}(APanelList);__reflect(CardWindow.prototype,"CardWindow");var CardWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.CardWindowMediator,e)||this;return i.RegisterDataSource(),i}return __extends(e,t),e.prototype.RegisterDataSource=function(){this.page.RegisterDataSource([CommandList.M_DAT_CardList])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Card]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Card:FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=1"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(CardWindowMediator.prototype,"CardWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var ActiveSkillLine=function(t){function e(e,i){var n=t.call(this)||this;return n._isShowCD=!1,n._isLoadedComplete=!1,n._i=0,n._skillId=0,n.skinName="resource/game_skins/ui/ActiveSkillLineSkins.exml",n._i=e,n._skillId=i,n._skill=SkillManager.GetActiveSkillByID(n._skillId),n._cdMovie=new egret.MovieClip,n._cdMovie.x=38,n._cdMovie.y=38,MovieManage.GetMovieClipData("jineng_cd_json","jineng_cd_png","jineng_sd").then(function(t){return __awaiter(n,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return this._cdMovie.movieClipData=t,this._cdMovie.gotoAndStop(1),this._cdImage=new eui.Image,this._cdImage.width=44,this._cdImage.height=25,this._cdImage.x=18,this._cdImage.y=18,e=this._cdImage,[4,MovieManage.PromisifyGetRes("jineng_cdlq_png",this)];case 1:return e.texture=i.sent(),this._cdText=new eui.BitmapLabel,this._cdText.font="mainnum_fnt",this._cdText.y=43,this._cdText.width=200,this._cdText.x=-60,this._cdText.textAlign=egret.HorizontalAlign.CENTER,this.Progress=100,this._isLoadedComplete=!0,[2]}})})}),n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._skillButton.source=3==this._skill.Status?this._skill.Icon+"_off_png":this._skill.Icon+"_on_png",this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.OnTap,this)},e.prototype.OnTap=function(t){3==this._skill.Status?UIPage.inst(UIPage).ShowConsumeTipWindow().ShowWindow("是否花费10元宝消除所有技能的冷却时间?",function(){FacadeApp.fetchData([CommandList.M_NET_SkillNum,"&oper=3","&aid&pm"],[function(t){t.code==FacadeApp.SuccessCode?(SkillManager.UpdateStatus(t.data.items),FacadeApp.dispatchAction(CommandList.M_AT_EFFECTS,t.data.effects)):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}):1==this._skill.Status&&FacadeApp.fetchData([CommandList.M_NET_SkillNum,"&oper=2","&aid=",this._skill.ID,"&pm=1"],[function(t){t.code==FacadeApp.SuccessCode?(SoundManager.PlaySkillMusic(),1==FacadeApp.read(CommandList.Re_Status).guideId&&GuideWindow.inst(GuideWindow).GuideFinish(FacadeApp.read(CommandList.Re_Status).guideId),SkillManager.UpdateStatus(t.data.items),FacadeApp.dispatchAction(CommandList.M_AT_EFFECTS,t.data.effects)):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype.Update=function(){if(this.loaded){var t=3==this._skill.Status;this._skillButton.source=t?this._skill.Icon+"_off_png":this._skill.Icon+"_on_png";var e=TextManager.TimeFormat(this._skill.LastTime);this.SetContent(e,t),this.Progress=Math.floor(100*(1-this._skill.GetProgress()))}},Object.defineProperty(e.prototype,"Progress",{set:function(t){0>t||(t=Math.round(t),t>=100?this._IsShow(!1):100>t&&this._IsShow(!0),this._cdMovie.gotoAndStop(Math.min(t+1,100)))},enumerable:!0,configurable:!0}),e.prototype.SetContent=function(t,e){return void 0===e&&(e=!1),__awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(a){switch(a.label){case 0:return this._cdText.text=t,i=e?"jineng_cdlq_png":"jineng_cdsf_png",n=this._cdImage,[4,MovieManage.PromisifyGetRes(i,this)];case 1:return n.texture=a.sent(),[2]}})})},e.prototype._IsShow=function(t){t!=this._isShowCD&&(this._isShowCD=t,t?null==this._cdMovie.parent&&(this.addChild(this._cdMovie),this.addChild(this._cdImage),this.addChild(this._cdText)):null!=this._cdMovie.parent&&(this.removeChild(this._cdMovie),this.removeChild(this._cdImage),this.removeChild(this._cdText)))},Object.defineProperty(e.prototype,"loaded",{get:function(){return this._isLoadedComplete},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ID",{get:function(){return this._skillId},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(ActiveSkillLine.prototype,"ActiveSkillLine");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var a=RES.getRes(t);a?n(a):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ConsumeTipWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/ConsumeTipWindowSkins.exml")||this;return e._okFunction=null,e}return __extends(e,t),e.prototype.ComponentWillMount=function(){SoundManager.PlayError1Music(),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._waitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._rightNowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSureClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayError2Music(),this.UnRegister()},e.prototype._OnSureClick=function(t){SoundManager.PlayError2Music(),null!=this._okFunction&&this._okFunction(),this.UnRegister()},e.prototype.ShowWindow=function(t,e,i){this._msgLabel.text=t,this._okFunction=e},e}(APanel);__reflect(ConsumeTipWindow.prototype,"ConsumeTipWindow");var LabelButton=function(t){function e(){var e=t.call(this)||this;return e._upLevelbutton=null,e._eailybutton=null,e._buddhabutton=null,e.skinName="resource/game_skins/comm/LabelButtonSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._eailyLabel2.touchEnabled=!1,this._eailyLabel1.touchEnabled=!1,this._eailyIcon.touchEnabled=!1,this._upLevelIcon1.touchEnabled=!1,this._upLevelIcon2.touchEnabled=!1,this._upLevelLabel1.touchEnabled=!1,this._upLevelLabel2.touchEnabled=!1,this._buddhaIcon.touchEnabled=!1,this._buddhaLabel1.touchEnabled=!1,this._buddhaLabel2.touchEnabled=!1,this._freeNumLabel.touchEnabled=!1},e.prototype.updateShow=function(t,e){this._buttonType=t,this.invalidateState(),0==this._buttonType?this.showUpLevel(e[0],e[1]):1==this._buttonType?this.showOneNum(e[0],e[1]):2==this._buttonType&&this.showBuddha(e[0],e[1])},e.prototype.getCurrentState=function(){return 0==this._buttonType?"twoNum":1==this._buttonType?"oneNum":2==this._buttonType?"buddha":"twoNum"},e.prototype.showOneNum=function(t,e){var i=this;this._eailyIcon.visible=!0,"升级"==e?RES.getResAsync("ding_jp_png",function(t){i._eailyIcon.texture=t},this):"刷新"==e?RES.getResAsync("ding_yb_png",function(t){i._eailyIcon.texture=t},this):"领奖"==e?RES.getResAsync("ding_yb_png",function(t){i._eailyIcon.texture=t},this):"金币购买"==e?(RES.getResAsync("shengji_jb_png",function(t){i._eailyIcon.texture=t},this),e="购买"):"人民币购买"==e&&(this._eailyIcon.visible=!1,e="购买"),this._eailyLabel1.text=String(t),this._eailyLabel2.text=String(e)},e.prototype.showUpLevel=function(t,e){this._upLevelLabel1.text=String(t),this._upLevelLabel2.text=String(e)},e.prototype.showBuddha=function(t,e){"免费转移"==t?(this._buddhaLabel2.text="免费转移",this._freeNumLabel.text="（免费转移次数 "+String(e)+" )",this._freeNumLabel.visible=!0,this._buddhaIcon.visible=!1,this._buddhaLabel1.visible=!1):"佛光转移"==t&&(this._buddhaLabel2.text="佛光转移",this._buddhaLabel1.text=String(e),this._buddhaIcon.visible=!0,this._buddhaLabel1.visible=!0,this._freeNumLabel.visible=!1)},e.prototype.setEnabled=function(t){this.enabled=t,this._upLevelbutton.enabled=this.enabled,this._eailybutton.enabled=this.enabled,this._buddhabutton.enabled=this.enabled},e.prototype.setDisabled=function(){this._upLevelbutton.enabled=!1,this._eailybutton.enabled=!1,this._buddhabutton.enabled=!1},e.prototype.setNormal=function(){this._upLevelbutton.enabled=!0,this._eailybutton.enabled=!0,this._buddhabutton.enabled=!0},e}(eui.Component);__reflect(LabelButton.prototype,"LabelButton");var ListBgImage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/comm/ListBgImageSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.setHuiduState=function(){this.skin.currentState="huidu"},e.prototype.setGaoLiangState=function(){this.skin.currentState="gaoliang"},e.prototype.setNormalState=function(){this.skin.currentState="normal"},e}(eui.Component);__reflect(ListBgImage.prototype,"ListBgImage");var LoadingPage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/page/LoadingPage.exml",e}return __extends(e,t),e.Register=function(t){t.addChild(e.inst)},e.prototype.UnRegister=function(){this.parent.removeChild(this),e._self=null},Object.defineProperty(e,"inst",{get:function(){return null==e._self&&(e._self=new e),e._self},enumerable:!0,configurable:!0}),e.upDateProgress=function(t){e.inst.upDateProgress(t)},e.prototype.upDateProgress=function(t){this._progressLabel.text=t},e}(eui.Component);__reflect(LoadingPage.prototype,"LoadingPage",["eui.UIComponent","egret.DisplayObject"]);var LoginPage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/page/LoginPage.exml",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._startButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._StartTouchTap,this)},e.prototype._StartTouchTap=function(t){SoundManager.PlayButtonMusic(),this._startButton.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._StartTouchTap,this),FacadeApp.Notify(CommandList.M_CMD_Login)},e.Register=function(t){this.inst.UnRegister(),t.addChild(this.inst)},e.prototype.UnRegister=function(){this.parent&&this.parent.removeChild(this),e._self=null},Object.defineProperty(e,"inst",{get:function(){return null==e._self&&(e._self=new e),e._self},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(LoginPage.prototype,"LoginPage",["eui.UIComponent","egret.DisplayObject"]);var OfflineRewardsWindow=function(t){function e(){return t.call(this,"resource/game_skins/ui/OfflineRewardsWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSureClick,this)},e.prototype.ComponentDidMount=function(){this.RegisterDataSourceFunction(),FacadeApp.dispatchAction(CommandList.M_CMD_UiOpened_Online)},e.prototype.RegisterDataSourceFunction=function(){this.RegisterDataSource([CommandList.M_CMD_UiOpened_Online])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this._moneyLabel.text=Digit.fromObject(FacadeApp.read(CommandList.Re_Status).offline).ShowToString,[2]})})},e.prototype._OnCloseClick=function(t){this.UnRegister()},e.prototype._OnSureClick=function(t){FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=6","&gateNo&monsterNum"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),this.UnRegister()},e}(APanel);__reflect(OfflineRewardsWindow.prototype,"OfflineRewardsWindow");var PassRewardList=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/ui/PassRewardListSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.upDataShow=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n,a,o,r,s,c;return __generator(this,function(l){switch(l.label){case 0:return this._Object=e,"神魔"!=t?[3,4]:(n=this._Object,this._suipianIma.visible=!0,this._numLabel.visible=!0,e?(a=this._nameIma,[4,MovieManage.PromisifyGetRes(n.Prototype.NameIcon)]):[3,3]);case 1:return a.texture=l.sent(),o=this._iconIma,[4,MovieManage.PromisifyGetRes(n.Prototype.HeadRes)];case 2:o.texture=l.sent(),this._derLabel.text=n.Prototype.Description,l.label=3;case 3:return this._numLabel.text="数量：0",[3,8];case 4:return"魔宠"!=t?[3,8]:(r=this._Object,this._suipianIma.visible=!1,this._numLabel.visible=!1,e?(s=this._nameIma,[4,MovieManage.PromisifyGetRes(r.Name)]):[3,7]);case 5:return s.texture=l.sent(),c=this._iconIma,[4,MovieManage.PromisifyGetRes(r.HeadRes)];case 6:c.texture=l.sent(),this._derLabel.text=r.Description,l.label=7;case 7:this._numLabel.text="获得金币："+String(i),l.label=8;case 8:return[2]}})})},Object.defineProperty(e.prototype,"SureBtn",{get:function(){return this._sureButton},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(PassRewardList.prototype,"PassRewardList");var PassRewardWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/PassRewardWindowSkins.exml")||this;return e._lineSet=[],e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.creatList(),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype.creatList=function(){for(var t=56789,e=0;3>e;e++){var i=new PassRewardList;this._group.addChild(i),i.y=125*e,i.upDataShow("魔宠",null,t),i.SureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._lineSet.push(i)}},e}(APanel);__reflect(PassRewardWindow.prototype,"PassRewardWindow");var PromptWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/PromptWindowSkins.exml")||this;return e._okFunction=null,e._cancelFunction=null,e}return __extends(e,t),e.prototype.ComponentWillMount=function(){SoundManager.PlayError1Music(),this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._sureButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSureClick,this),this._shareButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnShareClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayError2Music(),this.UnRegister(),null!=this._okFunction&&this._okFunction()},e.prototype._OnSureClick=function(t){SoundManager.PlayError2Music(),this.UnRegister(),null!=this._cancelFunction&&this._cancelFunction()},e.prototype._OnShareClick=function(t){SoundManager.PlayError2Music(),this.UnRegister()},e.prototype.ShowWindow=function(t,e,i,n,a,o,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),void 0===a&&(a=null),void 0===o&&(o=null),void 0===r&&(r=!1),this._contentLabel.text=t,r?this._shareButton.visible=!0:this._shareButton.visible=!1,this._okFunction=e,this._cancelFunction=a},e}(APanel);__reflect(PromptWindow.prototype,"PromptWindow");var SetWindow=function(t){function e(){return t.call(this,"resource/game_skins/ui/SetWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._dhButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnDHClick,this),this._gmButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnGMClick,this),this._panelCloseButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnPanelCloseClick,this),this._gmqrButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnQRGMClick,this),this._yinyueCheck.addEventListener(egret.Event.CHANGE,this._OnYinyueChange,this),this._yinxiaoCheck.addEventListener(egret.Event.CHANGE,this._OnYinxiaoChange,this),this._idLabel.filters=[FilterManage.AddMiaoBian(3,3019008)],this._Init()},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Pet)},e.prototype._Init=function(){this._yinyueCheck.selected=!0,this._yinxiaoCheck.selected=!0,this._tongzhiCheck.selected=!0,this._tixingCheck.selected=!0,this._setNameGroup.visible=!1,this._nameLabel.text=UnitManager.Player.Name,this._idLabel.text="ID:"+UnitManager.Player.ID.toString()},e.prototype._OnYinyueChange=function(t){SoundManager.StopBackgroundMusic()},e.prototype._OnYinxiaoChange=function(t){SoundManager.YinXiao=this._yinxiaoCheck.selected},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnGMClick=function(t){SoundManager.PlayButtonMusic(),this._setNameGroup.visible=!0,this._gmLabel.text=UnitManager.Player.Name},e.prototype._OnDHClick=function(t){SoundManager.PlayButtonMusic()},e.prototype._OnPanelCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this._setNameGroup.visible=!1},e.prototype._OnQRGMClick=function(t){SoundManager.PlayButtonMusic();var e=this._gmLabel.text;null!=e&&""!=e&&(UnitManager.Player.Name=e,this._nameLabel.text=e,this._setNameGroup.visible=!1)},e}(APanel);__reflect(SetWindow.prototype,"SetWindow");var SkillLine=function(t){function e(){var e=t.call(this)||this;return e.requireLevel=0,e.sObj=null,e.obj=null,e.skinName="resource/game_skins/comm/SkillLineSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)
},e.prototype.updataTalismanShow=function(t,e,i){this.obj=i,this.requireLevel=t,this.sObj=SkillManager.GetTalismanSkillByID(e),null!=this.sObj&&(this._mengbanIma.alpha=this.obj.Level>=this.requireLevel?0:1,this._suoIma.alpha=this.obj.Level>=this.requireLevel?0:1,this._lvLabel.alpha=this.obj.Level>=this.requireLevel?0:1,this._levelNumLabel.alpha=this.obj.Level>=this.requireLevel?0:1,this._skillIma.source=this.sObj.Icon+"_png",this._levelNumLabel.text=this.requireLevel.toString())},e.prototype.updataPetShow=function(t,e,i){this.obj=i,this.requireLevel=t,this.sObj=SkillManager.GetTalismanSkillByID(e),this._skillIma.source=this.sObj.Icon+"_png",this._mengbanIma.alpha=this.obj.Level>=this.requireLevel?0:1,this._suoIma.alpha=this.obj.Level>=this.requireLevel?0:1,this._lvLabel.alpha=this.obj.Level>=this.requireLevel?0:1,this._levelNumLabel.alpha=this.obj.Level>=this.requireLevel?0:1,this._levelNumLabel.text=this.requireLevel.toString()},e}(eui.Component);__reflect(SkillLine.prototype,"SkillLine");var SkillsTips=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/SkillsTipsSkins.exml")||this;return e._derArray=["技能1","技能2","技能3","技能4","技能5","技能6"],e}return __extends(e,t),e.prototype.ComponentWillMount=function(){},e.prototype.ComponentDidMount=function(){},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},e.prototype.ShowData=function(t){this._derLabel.text=SkillManager.GetActiveSkillByID(t).Description},e.prototype.changDirection=function(t){this._bg.scaleX=t},e}(APanel);__reflect(SkillsTips.prototype,"SkillsTips");var TrottingHorseLampWindow=function(t){function e(){return t.call(this,"resource/game_skins/ui/ZouMaDengWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){},e.prototype.ComponentDidMount=function(){},e.prototype.ShowContent=function(t){this._derLabel.text=t,this.aniFun()},e.prototype.aniFun=function(){var t=this;this._derLabel.x=640,egret.Tween.get(this._derLabel).to({x:-this._derLabel.width},5e3).call(function(){t.UnRegister()})},e}(APanel);__reflect(TrottingHorseLampWindow.prototype,"TrottingHorseLampWindow");var UIListButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/ui/UIListButtonSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._pointIma.touchEnabled=!1,this._newIma.touchEnabled=!1},e.prototype.updateShowButton=function(t){return __awaiter(this,void 0,void 0,function(){var e,i;return __generator(this,function(n){return"邮件"==t?(e="youjian_png",i="youjian_g_png"):"每日"==t?(e="meirirenwu_png",i="meirirenwu_g_png"):"佛光"==t?(e="shengguang_png",i="shengguang_g_png"):"三界符"==t?(e="sanjiefu_png",i="sanjiefu_g_png"):"挂机"==t?(e="guaji_png",i="guaji_g_png"):"离线奖励"==t?(e="lixianjinbi_png",i="lixianjinbi_g_png"):"过关奖励"==t?(e="guoguanjiangli_png",i="guoguanjiangli_g_png"):"挂机奖励"==t&&(e="guajijiangli_png",i="guajijiangli_g_png"),this._button.skinName='<e:Skin class="skins.ButtonSkin" states="up,down,disabled" minHeight="50" minWidth="100" xmlns:e="http://ns.egret.com/eui"><e:Image width="100%" height="100%" source="'+e+'" source.down="'+i+'"/></e:Skin>',[2]})})},e.prototype.changeState=function(t){this.currentState=t},Object.defineProperty(e.prototype,"Button",{get:function(){return this._button},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(UIListButton.prototype,"UIListButton");var UIPage=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/UI.exml")||this;return e.ActiveStatus=0,e._panelState="",e._uiButtonArr=[],e._skillTipTimeOutFun=null,e._activeSkillTips=null,e._curSkillTipNum=-1,e._bossTimeObj=null,e._activeSkillPosiSet=[[28,908],[129,918],[230,923],[332,923],[433,918],[534,908]],FacadeApp.inst.registerMediator(new UIPageMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){FacadeApp.AddListener(CommandList.BossLifeProgress,this.UpdateBossLifeProgress.bind(this)),FacadeApp.AddListener(CommandList.BOSSTIME,this.UpdateBossTimeProgress.bind(this)),FacadeApp.AddListener(CommandList.BOSSBONUS,this.UpdateBossBonus.bind(this)),this._putAwayButton.touchEnabled=!0,this._clickNumLabel.textAlign=egret.HorizontalAlign.CENTER,this._shopButton.x=this._gonghui.x,this._gonghui.visible=!1,this._petButton.x=30,this._talismanButton.x=158,this._amuletButton.x=286,this._cardButton.x=414,this._shopButton.x=542,this._bossLifeUI.lifeProgressBar.slideDuration=500,this._bossLifeUI.timeProgressBar.slideDuration=500,this._activeSkillLineSet=[];for(var t=0;t<SkillManager.ActiveSkill.length;t++){var i=new ActiveSkillLine(t,SkillManager.ActiveSkill[t].ID);i.x=this._activeSkillPosiSet[t][0],i.y=this._activeSkillPosiSet[t][1],this._skillComponent.addChild(i),this._activeSkillLineSet[t]=i}this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this._OnSkillButtonClickBegin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this._OnSkillButtonClickEnd,this),FacadeApp.Notify(CommandList.M_CMD_SkillStatus),e.IsInit=!0,this.Render(),this.updateUIListButton()},e.prototype.ComponentDidMount=function(){},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return FacadeApp.read(CommandList.Re_FightInfo).UnlimitedMode()?(this._giveUpBossButton.visible=!0,this._beatProgressLabel.visible=!1):(this._giveUpBossButton.visible=!1,this._beatProgressLabel.visible=!0),this.UpdateBeatProgress(),this.UpdateBossLifeProgress(),this.UpdateLevel(),this.updateProperties(),this.UpdateUiButtonPosi(),[2]})})},e.prototype.updateUIListButton=function(){this._mailButton.updateShowButton("邮件"),this._dailyTaskButton.updateShowButton("每日"),this._buddhaButton.updateShowButton("佛光"),this._sjfButton.updateShowButton("三界符"),this._hangUpingButton.updateShowButton("挂机"),this._offlineRewardsButton.updateShowButton("离线奖励"),this._passRewardsButton.updateShowButton("过关奖励"),this._hangUpRewardsButton.updateShowButton("挂机奖励")},e.prototype.updateProperties=function(){var t=FacadeApp.read(CommandList.Re_Status);this._diamondLabel.text=t.diamond.toString(),this._moneyLabel.text=Digit.fromObject(t.money).ShowToString,this._roleGJLabel.text=Digit.fromObject(t.power).ShowToString,this._petGJLabel.text=Digit.fromObject(t.powerClick).ShowToString,this._stoneNumLabel.text=t.stoneHero.toString(),this._stoneHeroNumLabel.text=t.stone.toString();var e=Digit.fromObject(FacadeApp.read(CommandList.Re_Status).offline);e.Larger(0)?this.SetButtonActive(ButtonActiveStatus.OfflineButton):this.SetButtonUnactive(ButtonActiveStatus.OfflineButton),this.SetButtonUnactive(ButtonActiveStatus.BonusOfPassGate),this.SetButtonUnactive(ButtonActiveStatus.HangupBonusButton)},e.prototype.UpdateIsFighting=function(){SoldierManage.FightManager.GetInstance().status.current==SoldierManage.FightStatusList.running?this._giveUpBossButton.touchEnabled=!0:this._giveUpBossButton.touchEnabled=!1},e.prototype.UpdateBeatProgress=function(){this._beatProgressLabel.text=FacadeApp.read(CommandList.Re_FightInfo)._monsterCount+"/"+FacadeApp.read(CommandList.Re_FightInfo).TOTALMONSTER},e.prototype.UpdateLevel=function(){var t=FacadeApp.read(CommandList.Re_FightInfo).LEVEL;t>1?(this._prevComponent.visible=!0,this._prevComponent.bigImage.visible=!1,this._prevComponent.smallImage.visible=!1,this._prevComponent.bigBossImage.visible=!1,this._prevComponent.smallBossImage.visible=!1,this._prevComponent.label.visible=!1,(t-1)%ConfigStaticManager.bossLevel==0?this._prevComponent.smallBossImage.visible=!0:(this._prevComponent.smallImage.visible=!0,this._prevComponent.label.visible=!0,this._prevComponent.label.text=(t-1).toString())):this._prevComponent.visible=!1,this._middleComponent.smallImage.visible=!1,this._middleComponent.bigImage.visible=!1,this._middleComponent.smallImage.visible=!1,this._middleComponent.bigBossImage.visible=!1,this._middleComponent.smallBossImage.visible=!1,this._middleComponent.label.visible=!1,t%ConfigStaticManager.bossLevel==0?this._middleComponent.bigBossImage.visible=!0:(this._middleComponent.bigImage.visible=!0,this._middleComponent.label.visible=!0,this._middleComponent.label.text=t.toString()),this._nextComponent.bigImage.visible=!1,this._nextComponent.smallImage.visible=!1,this._nextComponent.bigBossImage.visible=!1,this._nextComponent.smallBossImage.visible=!1,this._nextComponent.label.visible=!1,(t+1)%ConfigStaticManager.bossLevel==0?this._nextComponent.smallBossImage.visible=!0:(this._nextComponent.smallImage.visible=!0,this._nextComponent.label.visible=!0,this._nextComponent.label.text=(t+1).toString()),t%ConfigStaticManager.bossLevel==0?(this._giveUpBossButton.visible=!0,this._giveUpBossButton.selected=!1,this._beatProgressLabel.visible=!1):FacadeApp.read(CommandList.Re_FightInfo).UnlimitedMode()?(this._giveUpBossButton.visible=!0,this._giveUpBossButton.selected=!0,this._beatProgressLabel.visible=!1):(this._giveUpBossButton.visible=!1,this._beatProgressLabel.visible=!0),this.SetButtonActive(ButtonActiveStatus.HangupButton,t<FacadeApp.read(CommandList.Re_FightInfo).his-10)},e.prototype.UpdateBossLifeProgress=function(){this._bossLifeUI.lifeProgressBar.value=FacadeApp.read(CommandList.Re_FightInfo).BOSSLIFEPROGRESS,this._bossLifeUI.lifeProgressBar.value<=0&&this._bossLifeUI.visible?this._bossLifeUI.visible=!1:this._bossLifeUI.lifeProgressBar.value>0&&!this._bossLifeUI.visible&&(this._bossLifeUI.visible=!0)},e.prototype.UpdateBossTimeProgress=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];null==e[1]?this._bossTimeObj&&this._bossTimeObj.destory():e[1]>0&&(this._bossTimeObj&&this._bossTimeObj.destory(),this._bossTimeObj=new ChangeLabelValue(this,function(e){t._bossLifeUI.timeLabel.text=t._bossTimeObj.getOriValue("boss_Time").toFixed(1).toString()+"m",t._bossLifeUI.timeProgressBar.value=t._bossTimeObj.getOriValue("boss_Time")/ConfigStaticManager.bossTotalTime*100},function(t){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_GiveUpOrFight,"giveup")},.1),this._bossTimeObj.setValue("boss_Time",e[1]))},e.prototype.UpdateBossBonus=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return t.length>0&&t[1].num>0?(this._bossLifeUI._NDIma.visible=!0,this._bossLifeUI._NDNumLabel.visible=!0,e=this._bossLifeUI._NDIma,[4,MovieManage.PromisifyGetRes(t[1].type+"_png",this)]):[3,2];case 1:return e.texture=i.sent(),this._bossLifeUI._NDNumLabel.text=t[1].num,[3,3];case 2:this._bossLifeUI._NDIma.visible=!1,this._bossLifeUI._NDNumLabel.visible=!1,i.label=3;case 3:return[2]}})})},e.prototype.UpdateSkill=function(t){for(var e=0;e<this._activeSkillLineSet.length;e++)if(this._activeSkillLineSet[e].ID==t){this._activeSkillLineSet[e].Update();break}},e.prototype.UpdateUiButtonPosi=function(){this._uiButtonArr=[this._mailButton,this._dailyTaskButton,this._buddhaButton,this._sjfButton,this._hangUpingButton,this._offlineRewardsButton,this._passRewardsButton,this._hangUpRewardsButton];for(var t=0,e=0;e<this._uiButtonArr.length;e++)this._uiButtonArr[e].visible&&(this._uiButtonArr[e].y=t,t+=65);Indicator.getChecker(this.ActiveStatus)(ButtonActiveStatus.HangupButton)?this._hangUpingButton.visible=!0:this._hangUpingButton.visible=!1,Indicator.getChecker(this.ActiveStatus)(ButtonActiveStatus.HangupBonusButton)?this._hangUpRewardsButton.visible=!0:this._hangUpRewardsButton.visible=!1,Indicator.getChecker(this.ActiveStatus)(ButtonActiveStatus.OfflineButton)?this._offlineRewardsButton.visible=!0:this._offlineRewardsButton.visible=!1,Indicator.getChecker(this.ActiveStatus)(ButtonActiveStatus.BonusOfPassGate)?this._passRewardsButton.visible=!0:this._passRewardsButton.visible=!1},e.prototype._OnSkillButtonClickBegin=function(t){for(var e=-1,i=0;i<this._activeSkillLineSet.length;i++)if(t.target.parent==this._activeSkillLineSet[i]){e=i,this._curSkillTipNum=e;break}-1!=e&&(this._skillTipTimeOutFun=setTimeout(this.creatSkillsTips.bind(this),500))},e.prototype._OnSkillButtonClickEnd=function(t){this._skillTipTimeOutFun&&(clearTimeout(this._skillTipTimeOutFun),this._skillTipTimeOutFun=null,this._curSkillTipNum=-1),this._activeSkillTips&&this._activeSkillTips.parent&&this._activeSkillTips.parent.removeChild(this._activeSkillTips)},e.prototype.creatSkillsTips=function(){null!=this._skillTipTimeOutFun&&(null==this._activeSkillTips&&(this._activeSkillTips=new SkillsTips),this.addChild(this._activeSkillTips),this._curSkillTipNum>3?(this._activeSkillTips.x=this._activeSkillPosiSet[this._curSkillTipNum][0]-180,this._activeSkillTips.changDirection(-1)):(this._activeSkillTips.x=this._activeSkillPosiSet[this._curSkillTipNum][0]-5,this._activeSkillTips.changDirection(1)),this._activeSkillTips.y=this._activeSkillPosiSet[this._curSkillTipNum][1]-this._activeSkillTips.height,this._activeSkillTips.ShowData(this._activeSkillLineSet[this._curSkillTipNum].ID))},e.prototype.SetButtonActive=function(t,e){void 0===e&&(e=!0),e?this.ActiveStatus=Indicator.getInstance(this.ActiveStatus).set(t).indecate:this.ActiveStatus=Indicator.getInstance(this.ActiveStatus).unSet(t).indecate},e.prototype.SetButtonUnactive=function(t){this.ActiveStatus=Indicator.getInstance(this.ActiveStatus).unSet(t).indecate},e.prototype._PanelJudge=function(t){if("_gonghui"!=t){if(this._panel){if(this._panelState==t)return void this._panel.CloseWindow();this._panel.CloseWindow()}this._panelState=t,"_petWindow"==t?this._panel=PetWindow.inst(PetWindow).Register(this._windowCom,!1,this.closePanel.bind(this)).BouncedPanel(PetWindow.inst(PetWindow)._upOrDownButton.selected):"_talismanWindow"==t?this._panel=TalismanWindow.inst(TalismanWindow).Register(this._windowCom,!1,this.closePanel.bind(this)).BouncedPanel(TalismanWindow.inst(TalismanWindow)._upOrDownButton.selected):"_amuletWindow"==t?this._panel=AmuletWindow.inst(AmuletWindow).Register(this._windowCom,!1,this.closePanel.bind(this)).BouncedPanel(AmuletWindow.inst(AmuletWindow)._upOrDownButton.selected):"_cardWindow"==t?this._panel=CardWindow.inst(CardWindow).Register(this._windowCom,!1,this.closePanel.bind(this)).BouncedPanel(!1):"_shopWindow"==t&&(this._panel=ShopWindow.inst(ShopWindow).Register(this._windowCom,!1,this.closePanel.bind(this)).BouncedPanel(ShopWindow.inst(ShopWindow)._upOrDownButton.selected))}},e.prototype.closePanel=function(){this._panel=null,this._panelState=""},e.prototype.ShowPassRewardWindow=function(){return PassRewardWindow.inst(PassRewardWindow).Register(this,!1)},e.prototype.ShowOfflineRewardsWindow=function(){return OfflineRewardsWindow.inst(OfflineRewardsWindow).Register(this,!1)},e.prototype.ShowHangUpRewardsWindow=function(){return HangUpRewardsWindow.inst(HangUpRewardsWindow).Register(this,!1)},e.prototype.ShowHangUpTipWindow=function(){return HangUpTipWindow.inst(HangUpTipWindow).Register(this,!1)},e.prototype.ShowSetWindow=function(){return SetWindow.inst(SetWindow).Register(this,!1)},e.prototype.ShowDailyTaskWindow=function(){return DailyTaskWindow.inst(DailyTaskWindow).Register(this,!1)},e.prototype.ShowRankWindow=function(){return RankingWindow.inst(RankingWindow).Register(this,!1)},e.prototype.ShowHangUpingWindow=function(){return HangUpingWindow.inst(HangUpingWindow).Register(this)},e.prototype.ShowReviveTipsWindow=function(){return ReviveTipsWindow.inst(ReviveTipsWindow).Register(this,!1)},e.prototype.ShowSeniorReviveWindow=function(){return SeniorReviveWindow.inst(SeniorReviveWindow).Register(this,!1)},e.prototype.ShowZSWindow=function(){return ZSWindow.inst(ZSWindow).Register(this,!1)},e.prototype.ShowPrompt=function(){return PromptWindow.inst(PromptWindow).Register(this,!1)},e.prototype.ShowConsumeTipWindow=function(){return ConsumeTipWindow.inst(ConsumeTipWindow).Register(this,!1)},e.prototype.ShowPVPMarshallingWindow=function(t){return MarshallingWindow.inst(MarshallingWindow).Register(this,!1).show(t)},e.prototype.ShowBuddhaGuardWindow=function(){return BuddhaGuardWindow.inst(BuddhaGuardWindow).Register(this,!1)},e.prototype.ShowBuddhaManagerWindow=function(){return BuddhaManagerWindow.inst(BuddhaManagerWindow).Register(this,!1)},e.prototype.ShowPVPFightWindow=function(){return PVPWindow.inst(PVPWindow).Register(this).EnterPVPFight()},e.prototype.ShowAchievementWindow=function(){return AchievementWindow.inst(AchievementWindow).Register(this,!1)},e.prototype.ShowMailWindow=function(){return MailWindow.inst(MailWindow).Register(this,!1)},e.prototype.ShowMailDetailWindow=function(t){return MailDetailWindow.inst(MailDetailWindow).Register(this,!1).showMailContent(t)},e.prototype.ShowIntegralWindow=function(){return IntegralWindow.inst(IntegralWindow).Register(this,!1)},e.prototype.ShowActivityRule=function(){return IntegralRuleWindow.inst(IntegralRuleWindow).Register(this,!1)},e.prototype.ShowSJFWindow=function(){return SanJieFuWindow.inst(SanJieFuWindow).Register(this,!1)},e.prototype.ShowTalismanDetail=function(t){return null!=t?TalismanDetail.inst(TalismanDetail).Register(this,!1).ShowTalisman(t):void 0},e.prototype.ShowPetDetail=function(t){return null!=t?PetDetail.inst(PetDetail).Register(this,!1).ShowPet(t):void 0},e.prototype.ShowCardDetail=function(t){return null!=t?CardDetail.inst(CardDetail).Register(this,!1).ShowGhost(t):void 0},e.prototype.ShowPVPVS=function(t){return null!=t?PVPVSWindow.inst(PVPVSWindow).Register(this,!1).Show(t):void 0},e.prototype.ShowAmuletDetail=function(t){return null!=t?AmuletDetail.inst(AmuletDetail).Register(this,!1).ShowAmulet(t):void 0},e.prototype.ShowTrottingHorseLampWindow=function(t){return TrottingHorseLampWindow.inst(TrottingHorseLampWindow).Register(this,!1).ShowContent(t)},Object.defineProperty(e.prototype,"EffectGroup",{get:function(){return this._effectGroup},enumerable:!0,configurable:!0}),e.prototype.ShowGuideWindow=function(){return GuideWindow.inst(GuideWindow).Register(this,!1)},e}(APanel);UIPage.IsInit=!1,__reflect(UIPage.prototype,"UIPage");var UIPageMediator=function(t){function e(e){var i=t.call(this,ViewerName.UIPageMediator,e)||this;return i.page._cardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._ShowPanel,i),i.page._petButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._ShowPanel,i),i.page._amuletButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._ShowPanel,i),i.page._shopButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._ShowPanel,i),i.page._talismanButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._ShowPanel,i),i.page._dailyTaskButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._giveUpBossButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._putAwayButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._setButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._rankingButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._mailButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._sjfButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._hangUpingButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._buddhaButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._achievementButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._passRewardsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._offlineRewardsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._hangUpRewardsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),i.page._activeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnButtonClick,i),FacadeApp.fetchData([CommandList.M_NET_TalismanNum,"&oper=1","&id&pm"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList,t.data),FacadeApp.dispatchAction(CommandList.M_AT_STATUS_Power,t.data.power),FacadeApp.dispatchAction(CommandList.M_DAT_Status_PowerClick,t.data.powerClick),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),i.RegisterDataSource(),i}return __extends(e,t),e.prototype.RegisterDataSource=function(){this.page.RegisterDataSource([CommandList.M_CMD_FIGHT_GiveUpOrFight,CommandList.SetTollgateProgress,CommandList.M_DAT_Change_Money,CommandList.M_DAT_Status_PowerClick,CommandList.M_AT_STATUS_Power,CommandList.M_AT_STATUSLIST,CommandList.M_AT_SyncCheckpoint])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_ShowAmuletDetail,CommandList.M_CMD_ShowCard,CommandList.M_CMD_ShowTalisman,CommandList.M_CMD_UiOpened_Buddha,CommandList.M_CMD_UiOpened_BuddhaMgr,CommandList.M_CMD_ShowPVPMarshalling,CommandList.M_CMD_ShowPVPFightWindow,CommandList.M_CMD_SkillStatus,CommandList.M_MS_FightStatusChg,CommandList.M_CMD_ShowPVPVS,CommandList.M_CMD_UiOpened_ActivityRule]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Buddha:this.page.ShowBuddhaManagerWindow();break;case CommandList.M_CMD_UiOpened_BuddhaMgr:this.page.ShowBuddhaGuardWindow();break;case CommandList.M_CMD_ShowAmuletDetail:this.page.ShowAmuletDetail(t.getBody());break;case CommandList.M_CMD_ShowCard:this.page.ShowCardDetail(t.getBody());break;case CommandList.M_CMD_ShowTalisman:this.page.ShowTalismanDetail(t.getBody());break;case CommandList.M_CMD_ShowPVPMarshalling:this.page.ShowPVPMarshallingWindow(t.getBody());break;case CommandList.M_CMD_ShowPVPFightWindow:this.page.ShowPVPFightWindow();break;case CommandList.M_CMD_SkillStatus:var e=t.getBody();if(null!=e)this.page.UpdateSkill(e);else for(var i=0;i<SkillManager.ActiveSkill.length;i++)this.page.UpdateSkill(SkillManager.ActiveSkill[i].ID);break;case CommandList.M_MS_FightStatusChg:this.page.UpdateIsFighting();break;case CommandList.M_CMD_ShowPVPVS:this.page.ShowPVPVS(t.getBody());break;case CommandList.M_CMD_UiOpened_ActivityRule:this.page.ShowActivityRule()}},e.prototype._ShowPanel=function(t){switch(t.target){case this.page._petButton:this.page._PanelJudge("_petWindow");break;case this.page._talismanButton:this.page._PanelJudge("_talismanWindow");break;case this.page._amuletButton:this.page._PanelJudge("_amuletWindow");break;case this.page._cardButton:this.page._PanelJudge("_cardWindow");break;case this.page._shopButton:this.page._PanelJudge("_shopWindow")}},e.prototype._OnButtonClick=function(t){switch(SoundManager.PlayButtonMusic(),t.target){case this.page._dailyTaskButton.Button:this.page.ShowDailyTaskWindow();break;case this.page._hangUpRewardsButton.Button:this.page.ShowHangUpRewardsWindow();break;case this.page._passRewardsButton.Button:this.page.ShowPassRewardWindow();break;case this.page._offlineRewardsButton.Button:this.page.ShowOfflineRewardsWindow();break;case this.page._hangUpingButton.Button:this.page.ShowHangUpTipWindow();break;case this.page._sjfButton.Button:this.page.ShowSJFWindow();break;case this.page._mailButton.Button:this.page.ShowMailWindow();break;case this.page._buddhaButton.Button:var e=FacadeApp.read(CommandList.Re_Status).totem;e>0?FacadeApp.Notify(CommandList.M_CMD_UiOpened_BuddhaMgr):FacadeApp.Notify(CommandList.M_CMD_UiOpened_Buddha);break;case this.page._rankingButton:this.page.ShowRankWindow();break;case this.page._setButton:this.page.ShowSetWindow();break;case this.page._activeButton:this.page.ShowIntegralWindow();break;case this.page._achievementButton:this.page.ShowAchievementWindow();break;case this.page._putAwayButton:this.page._putAwayGroup.visible=!this.page._putAwayButton.selected;break;case this.page._giveUpBossButton:this.page._giveUpBossButton.selected?FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_GiveUpOrFight,"giveup"):FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_GiveUpOrFight,"fight")}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(UIPageMediator.prototype,"UIPageMediator",["puremvc.IMediator","puremvc.INotifier"]);var WaitPage=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/comm/WaitPageSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e}(eui.Component);__reflect(WaitPage.prototype,"WaitPage");var DailyTaskLine=function(t){function e(){var e=t.call(this)||this;return e._task=null,e._isCreat=!1,e.skinName="resource/game_skins/ui/TaskList.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"getId",{get:function(){return this._task?this._task.ID:-1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this._task=TaskManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._awardButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick,this),this._consAwaButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnConsAwaClick,this),this._isCreat=!0,this.Render()},e.prototype.Render=function(){var t=this;if(null!=this._task&&this._isCreat){this._nameLabel.text=this._task.Name,this._desLabel.text=this._task.Description,this._iconImage.source=this._task.IconRes,this._awardLabel.text=this._task.Bonus,1==this._task.ori.status?(this._consAwaButton.visible=!1,this._awardButton.visible=!0):0==this._task.ori.status&&(this._consAwaButton.visible=!0,this._awardButton.visible=!1);var e=this._task.ori.conditionMgr.conList;Object.keys(e).map(function(i){var n=e[i];t._timesLabel.text=n.value+"/"+n.threshold})}},e.prototype._OnButtonClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_TASK,"&oper=1&id="+this.getId],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.TASK_GET_LIST,t.data.items),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data)}])):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._OnConsAwaClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_TASK,"&oper=2&id="+this.getId],[function(t){t.code==FacadeApp.SuccessCode?(FacadeApp.dispatchAction(CommandList.TASK_GET_LIST,t.data.items),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._SetFilter=function(){},e}(eui.Component);__reflect(DailyTaskLine.prototype,"DailyTaskLine",["IGroupLine","egret.DisplayObject"]);var DailyTaskWindow=function(t){function e(){var i=t.call(this,"resource/game_skins/ui/DailyTaskSkins.exml")||this;return t.prototype.InitComponent.call(i,i._taskGroup,i._taskList,[function(){return e.genericsFactory(DailyTaskLine)}],[function(){var t=FacadeApp.read(CommandList.Re_TaskInfo).list,e=Object.keys(t).filter(function(e){return parseInt(e)>=2e3&&parseInt(e)<3e3&&2!=t[e].status},this);return[t,e]}],aniControlStatus.StartWave),FacadeApp.inst.removeMediator(ViewerName.DailyTaskWindowMediator),FacadeApp.inst.registerMediator(new DailyTaskWindowMediator(i)),i}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,this._refreshGroup.visible=!1,FacadeApp.Notify(CommandList.M_CMD_UiOpened_Task)},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanelList);__reflect(DailyTaskWindow.prototype,"DailyTaskWindow");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var SoldierManage;!function(t){var e=function(e){function i(n){var a=e.call(this)||this;if(a.TypeList=[],a.hero=null,a.pet=null,a._countTime=0,a._ifBaiXiangBoss=!1,a.AutoTimes=0,a.soldiers=new Array,a.runType=t.ArmyRunType["static"],a.runType=n,FacadeApp.AddListener(CommandList.M_CMD_FIGHT_HIT_ENEMY,function(t,e){a.monsterAttacked(e.aniName,e.src)},a),null==i.MonsterResSet||null==i.BossResSet){i.MonsterResSet=[],i.BossResSet=[];var o=ConfigStaticManager.getList(ConfigTypeName.Monster),r=0;Object.keys(o).map(function(t){var e=o[t].id,n=o[t].draRes;i.MonsterResSet[e]=n,r+=1}),i.MonsterResSet[r]="baoxiang_walk";var s=ConfigStaticManager.getList(ConfigTypeName.Boss);Object.keys(s).map(function(t){var e=s[t].id,n=s[t].draRes;i.BossResSet[e]=n})}return a}return __extends(i,e),i.prototype.rebuild=function(e){var i=this;this.TypeList=e,this._countTime=0,this.runType!=t.ArmyRunType.dyncCreate&&(this.soldiers=this.TypeList.map(function(e){var n=t.SoldierFactory.inst.newSildier(e);switch(e.utype){case t.SoldierType.hero:i.hero=n;break;case t.SoldierType.pet:i.pet=n;break;case t.SoldierType.boss:}return n}),this.Register(this))},i.prototype.monsterAttacked=function(e,i){void 0===i&&(i=t.HurtSourceType.role);var n=i==t.HurtSourceType.pet?!0:!1,a=FacadeApp.read(CommandList.Re_Status),o=n?Digit.fromObject(a.powerClick):Digit.fromObject(a.power);2!=SkillManager.GetActiveSkillByID(2)._status||n||o.Mul(2),2==SkillManager.GetActiveSkillByID(5)._status&&n&&o.Mul(2),Math.random()<FacadeApp.Calc(effectEnum.DoubleAttackRate,.1)&&o.Mul(FacadeApp.Calc(effectEnum.DoubleAttackValue,2));for(var r=this.soldiers.length-1;r>=0;r--){var s=this.soldiers[r];if((s.unitType==t.SoldierType.monster||s.unitType==t.SoldierType.boss)&&(!s.Life.Little(0)&&Math.abs(t.FightManager.GetInstance().armyOfMine.hero.x-s.x)<GameConfigOfRuntime.attackRange||n&&s.Life.Larger(0)&&Math.abs(t.FightManager.GetInstance().armyOfMine.hero.x-s.x)<GameConfigOfRuntime.attackRange+50||t.FightManager.GetInstance().armyOfMine.hero.AttackAniGroupName==t.RoleAttackAniGroupNames.Attack7&&s.Life.Larger(0)&&Math.abs(t.FightManager.GetInstance().armyOfMine.hero.x-s.x)<GameConfigOfRuntime.attackRange+100)){if(s.unitType==t.SoldierType.boss){switch(s.Trait){case t.SoldierTrait.Gold:o.CalcFinallyValue([effectEnum.AttackToGold]);break;case t.SoldierTrait.Wood:o.CalcFinallyValue([effectEnum.AttackToWood]);break;case t.SoldierTrait.Water:o.CalcFinallyValue([effectEnum.AttackToWater]);break;case t.SoldierTrait.Fire:o.CalcFinallyValue([effectEnum.AttackToFire]);break;case t.SoldierTrait.Earth:o.CalcFinallyValue([effectEnum.AttackToEarth])}o.CalcFinallyValue([effectEnum.AttackToAll])}this.ShowLife(s.x-200,GameConfigOfRuntime.monsterY-s.MonsterHeight-30,o,n),n?s.Life=s.Life.Sub(o):(s.status.attacked(e),s.Life=s.Life.Sub(o))}}},i.prototype.ShowLife=function(t,e,i,n){void 0===n&&(n=!1);var a=new LifeNumber(n);this.addChildAt(a,0),a.x=t,a.y=e-30,a.scaleX=a.scaleY=.7,a.number=i.Power>8?i.Base.toFixed(2)+"e"+i.Power:i.Number.toFixed(0);var o=egret.Tween.get(a);Math.random()<.5?o.wait(150).to({x:t-150,y:e-200,alpha:0},500).call(this._RemoveLife,this,[a]):o.wait(150).to({x:t+150,y:e-200,alpha:0},500).call(this._RemoveLife,this,[a])},i.prototype._RemoveLife=function(t){this.removeChild(t)},i.prototype.Framing=function(e,i){if(this.runType==t.ArmyRunType.dyncCreate){var n=FacadeApp.read(CommandList.Re_FightInfo);if(this._countTime--,this.TypeList.length>0&&this._countTime<=0&&this.soldiers.length<5&&(n.TollgateProgressLeft()>this.soldiers.length||n.UnlimitedMode())){var a=Math.floor(this.TypeList.length*Math.random());this.CreateMonster(this.TypeList[a].uid,this.TypeList[a].utype==t.SoldierType.boss),this._countTime=GameConfigOfRuntime.createTime,this.TypeList[a].utype==t.SoldierType.boss&&t.FightManager.GetInstance().status.current==t.FightStatusList.running?(FacadeApp.dispatchAction(CommandList.BossLifeProgress,100),FacadeApp.dispatchAction(CommandList.BOSSTIME,30),FacadeApp.dispatchAction(CommandList.BOSSBONUS,{type:"ding_nd",num:FacadeApp.read(CommandList.Re_FightInfo).aStone})):FacadeApp.dispatchAction(CommandList.BossLifeProgress,0)
}for(var o=this.soldiers.length-1;o>=0;o--)this.soldiers[o]&&this.soldiers[o].status.current==t.SoldierStatusList.move&&this.soldiers[o].x>GameConfigOfRuntime.monsterMinX&&(this.soldiers[o].x-=GameConfigOfRuntime.monsterSpeed);for(var r=FacadeApp.Calc(effectEnum.GetMoneyPerHit,0)>0,s=this.soldiers.length-1;s>=0;s--)if(this.soldiers[s]&&!this.soldiers[s].Life.Larger(0)&&null==this.soldiers[s].isTween&&this.soldiers[s].status.current==t.SoldierStatusList.death){var c=this.soldiers[s],l=0;c.IsBaoXiang?l=1:c.unitType==t.SoldierType.boss&&(l=2),FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_MonsterKilled,{t:l,x:c.x,y:c.y,w:c.width,h:c.height}),this.reduceMonster(s);var u=n._monsterCount+1;n._monsterCount>0&&u%5==0&&(u<n.TOTALMONSTER||n.UnlimitedMode())&&FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=3","&gateNo=",n.LEVEL,"&monsterNum=",u],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),FacadeApp.dispatchAction(CommandList.SetTollgateProgress,u)}else r&&FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_MonsterHitted,{t:3,x:this.soldiers[s].x,y:this.soldiers[s].y,w:this.soldiers[s].width,h:this.soldiers[s].height});for(var s=this.soldiers.length-1;s>=0;s--)if(this.soldiers[s]&&this.soldiers[s].status.current!=t.SoldierStatusList.death&&Math.abs(i.x-this.soldiers[s].x)<GameConfigOfRuntime.attackRange){FacadeApp.dispatchAction(CommandList.M_CMD_RoleAttack);break}n.TOTALMONSTER<=n._monsterCount&&0==n.UnlimitedMode()&&(FacadeApp.dispatchAction(CommandList.BOSSTIME),FacadeApp.dispatchAction(CommandList.M_CMD_ArmyDestory))}this.soldiers.map(function(t){t.Framing(e)})},i.prototype.reduceMonster=function(t){var e=this,i=this.soldiers[t];i&&i.parent&&null==i.isTween&&(i.isTween=!0,egret.Tween.get(i).to({alpha:0},0).wait(80).to({alpha:1},0).wait(80).to({alpha:0},0).wait(80).to({alpha:1},0).wait(80).to({alpha:0},0).wait(80).to({alpha:1},0).wait(80).to({alpha:0},0).call(function(){for(var t=null,n=0;n<e.soldiers.length;n++)if(e.soldiers[n]==i){t=e.soldiers[n],e.soldiers[n]=null,e.soldiers.splice(n,1);break}t&&(egret.Tween.removeTweens(t),ObjectPool.getPool("SoldierManage.MonsterSoldier").returnObject(i),i.isTween=null)}))},i.prototype.CreateMonster=function(t,e){return __awaiter(this,void 0,void 0,function(){var n,a,o;return __generator(this,function(r){switch(r.label){case 0:return n=ObjectPool.getPool("SoldierManage.MonsterSoldier").borrowObject(),a="",a=e?i.BossResSet[t]:i.MonsterResSet[t],[4,MovieManage.PromisifyGetDragonBonesMovie(a,this)];case 1:return o=r.sent(),null==o?(console.log("create monster armature error: "+a),[2]):(n.setData(t,e,o),this.addChild(n),this.soldiers.push(n),[2])}})})},i.prototype.suspend=function(){this.soldiers.map(function(t){t.RemoveTweenAndSetTimeout(),t.status.moveEvent()});for(var e=this.soldiers.length-1;e>=0;e--)this.soldiers[e].unitType==t.SoldierType.monster&&this.reduceMonster(e),this.soldiers[e].unitType==t.SoldierType.boss&&this.reduceMonster(e)},i.prototype.goAhead=function(){var t=this;return Promise.all(this.soldiers.map(function(e){return new Promise(function(i,n){e.status.moveEvent(),egret.Tween.get(e).to({x:1e3},1700).call(function(){e.x=GameConfigOfRuntime.roleX,i()},t)})}))},i.prototype.disappear=function(){return Promise.all(this.soldiers.map(function(t){return new Promise(function(e,i){t.status.moveEvent(),t.x=GameConfigOfRuntime.roleX,e()})}))},i.prototype.retreat=function(){var t=this;return Promise.all(this.soldiers.map(function(e){return new Promise(function(i,n){e.status.moveEvent(),egret.Tween.get(e).to({x:-100},1e3).call(function(){i()},t)})}))},Object.defineProperty(i.prototype,"soldierNum",{get:function(){return this.soldiers.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"soldierOfFirst",{get:function(){return this.soldiers[0]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"soldierSet",{get:function(){return this.soldiers},enumerable:!0,configurable:!0}),i.prototype.Register=function(t){this.soldiers.map(function(e){t.addChild(e)})},i}(egret.DisplayObjectContainer);e.MonsterResSet=null,e.BossResSet=null,t.Army=e,__reflect(e.prototype,"SoldierManage.Army")}(SoldierManage||(SoldierManage={}));var SoldierManage;!function(t){var e;!function(t){t[t.None=0]="None",t[t.Enemy=1]="Enemy",t[t.BossAppear=2]="BossAppear",t[t.BossAttack=102]="BossAttack",t[t.BossStoneAttack=202]="BossStoneAttack",t[t.Rabbit=3]="Rabbit"}(e||(e={}));var i=function(){function t(t,e){this.container=null,this.evt=null,this._ViewArmature=null,this.container=e,this.evt=t}return t.prototype.createView=function(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return e=this,[4,MovieManage.PromisifyGetDragonBonesMovie(t,this)];case 1:return e._ViewArmature=i.sent(),Main.Instance.TopSence.addChild(this._ViewArmature.display),this._ViewArmature.display.ifCanMove=!0,this._ViewArmature.display.x=150,this._ViewArmature.display.y=270,this._ViewArmature.animation.gotoAndPlay("move"),this._ViewArmature.display.direction=1,this._ViewArmature.display.touchEnabled=!0,this._ViewArmature.display.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onViewTouched,this),[2]}})})},t.prototype.onViewTouched=function(t){this._ViewArmature.display.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onViewTouched,this),this._ViewArmature.display.ifCanMove=!1,this._ViewArmature.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.onViewCompleted,this),this._ViewArmature.animation.gotoAndPlay("hit",-1,-1,1)},t.prototype.onViewCompleted=function(t){this._ViewArmature.removeEventListener(dragonBones.AnimationEvent.COMPLETE,this.onViewCompleted,this),this._ViewArmature=null,MovieManage.RemoveArmature(t.target.parent),Main.Instance.TopSence.removeChild(t.target)},t.prototype.FrameIng=function(){null!=this._ViewArmature&&1==this._ViewArmature.display.ifCanMove&&(this._ViewArmature.display.x+=2*this._ViewArmature.display.direction,this._ViewArmature.display.x>=550?(this._ViewArmature.display.direction*=-1,this._ViewArmature.display.skewY=-180):this._ViewArmature.display.x<=150&&(this._ViewArmature.display.direction*=-1,this._ViewArmature.display.skewY=0))},t}();__reflect(i.prototype,"EventObject");var n=function(i){function n(t,e){var n=i.call(this,t,e)||this;return n.createView("baoxiang_fly"),n}return __extends(n,i),n.prototype.onViewTouched=function(e){this.container.current==t.FightStatusList.running&&(this.container.stop(),i.prototype.onViewTouched.call(this,e))},n.prototype.onViewCompleted=function(t){var n=this;i.prototype.onViewCompleted.call(this,t),FacadeApp.fetchData([CommandList.M_NET_CheckEvent,"&eid=",this.evt.type],[function(t){if(o.EventUnRegister(n),FacadeApp.dispatchAction(CommandList.M_AT_EventHandleResult,t.data),t.code==FacadeApp.SuccessCode&&FacadeApp.read(CommandList.Re_FightInfo).LEVEL%5!=0){var i=FacadeApp.read(CommandList.Re_FightInfo).events;Object.keys(i).map(function(t){switch(i[t].type){case e.BossAttack:case e.BossStoneAttack:n.container.stop(),FacadeApp.dispatchAction(CommandList.M_AT_BattleWithFlyBoss,{eid:t})}})}else UIPage.inst(UIPage).ShowTrottingHorseLampWindow("宝箱怪逃跑了！"),n.container["continue"]()},function(t){UIPage.inst(UIPage).ShowTrottingHorseLampWindow("宝箱怪逃跑了！"),n.container["continue"]()}])},n}(i);__reflect(n.prototype,"EventObjectOfBoss");var a=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.createView("baoxiang"),n}return __extends(e,t),e.prototype.onViewCompleted=function(e){var i=this;t.prototype.onViewCompleted.call(this,e),FacadeApp.fetchData([CommandList.M_NET_CheckEvent,"&eid=",this.evt.type],[function(t){if(o.EventUnRegister(i),FacadeApp.dispatchAction(CommandList.M_AT_EventHandleResult,t.data),t.code==FacadeApp.SuccessCode){var e=t.data.params.bonus.split(",");UIPage.inst(UIPage).ShowTrottingHorseLampWindow("恭喜您获得了 "+e[1]+" "+ConfigStaticManager.getItem(ConfigTypeName.RewardType,parseInt(e[0])).rewardType+"！今日可领取次数："+(i.evt.numOfMax-i.evt.numOfCur));var n=FacadeApp.read(CommandList.Re_Status);n.diamond+=parseInt(e[1]),FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,n)}else UIPage.inst(UIPage).ShowTrottingHorseLampWindow("小飞兔不见了!")}])},e}(i);__reflect(a.prototype,"EventObjectOfBaoXiang");var o=function(){function t(){}return t.Framing=function(){t.eventList.map(function(t){t.FrameIng()})},t.EventRegister=function(e){t.eventList.push(e)},t.EventUnRegister=function(e){t.eventList.splice(t.eventList.indexOf(e),1)},t.createEvent=function(o,r){var s=!1;if(t.eventList.map(function(t){t.evt.type==o.type&&(s=!0)}),!s)switch(o.type){case e.Rabbit:t.EventRegister(new a(o,r));break;case e.BossAppear:t.EventRegister(new n(o,r));break;default:t.EventRegister(new i(o,r))}},t}();o.eventList=new Array,t.EventHandler=o,__reflect(o.prototype,"SoldierManage.EventHandler")}(SoldierManage||(SoldierManage={}));var SoldierManage;!function(t){t.FightStatusList={ready:"ready",running:"running",suspend:"suspend"};var e;!function(t){t[t.pet=1]="pet",t[t.card=2]="card",t[t.role=3]="role"}(e=t.HurtSourceType||(t.HurtSourceType={}));var i;!function(t){t[t["static"]=0]="static",t[t.dyncCreate=1]="dyncCreate"}(i=t.ArmyRunType||(t.ArmyRunType={})),t.RoleAttackAniGroupNames={Attack1:"attack1",Attack2:"attack2",Attack3:"attack3",Attack4:"attack4",Attack5:"attack5",Attack6:"attack6",Attack7:"attack7",AttackCount:7},t.SoldierStatusList={ready:"ready",move:"move",hit:"hit",death:"death",running:"running",suspend:"suspend",stand:"stand",attacking:"attacking"};var n;!function(t){t[t.None=0]="None",t[t.Gold=1]="Gold",t[t.Wood=2]="Wood",t[t.Water=3]="Water",t[t.Fire=4]="Fire",t[t.Earth=5]="Earth"}(n=t.SoldierTrait||(t.SoldierTrait={}));var a;!function(t){t[t.hero=0]="hero",t[t.pet=1]="pet",t[t.ghost=2]="ghost",t[t.monster=3]="monster",t[t.boss=4]="boss"}(a=t.SoldierType||(t.SoldierType={}))}(SoldierManage||(SoldierManage={}));var SoldierManage;!function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.state={LEVEL:0,_monsterCount:0,checkPointStatus:0,_timer:0,TOTALMONSTER:30},i.armyOfMine=null,i.armyOfEnemy=null,i.succAni=null,i.RegisterDataSource([CommandList.SetTollgateProgress],i.refreshState.bind(i)),i.RegisterDataSource([CommandList.M_CMD_ArmyDestory],i.ChangeTollgate.bind(i)),i.RegisterDataSource([CommandList.M_AT_BattleWithFlyBoss,CommandList.M_AT_SyncCheckpoint,CommandList.M_AT_ReturnTollgate],i.refreshState.bind(i),!0),i.RegisterDataSource([CommandList.M_CMD_Fight_Suspend],i.FrameCheckStop.bind(i)),i.RegisterDataSource([CommandList.M_CMD_FIGHT_CONTINUE],i.FrameCheckStart.bind(i)),i.RegisterDataSource([CommandList.M_CMD_FIGHT_MonsterKilled,CommandList.M_CMD_FIGHT_MonsterHitted],i.creatJinBi.bind(i)),i.RegisterDataSource([CommandList.M_CMD_FIGHT_GiveUpOrFight],i.giveUpOrFight.bind(i)),i.RegisterDataSource([CommandList.PVP_SRART],i._RemoveGuaJiStartPVP.bind(i)),i.loadData(t),i}return __extends(i,e),i.prototype.RegisterDataSource=function(t,e,i){void 0===i&&(i=null),t.map(function(t){FacadeApp.AddListener(t,function(t,n){t==CommandList.M_CMD_ArmyDestory,e(null==i&&null!=n?n:i)})})},i.prototype.loadData=function(e){var i=this;FacadeApp.PromisifyFetchList([[CommandList.M_NET_Card,"&oper=1&id=0&pm=0"],[CommandList.M_NET_PetNum,"&oper=1&pm=0&id=0"]]).then(function(n){i.createStatusMachine(e),FacadeApp.dispatchAction(CommandList.M_DAT_CardList,n[0].data),FacadeApp.dispatchAction(CommandList.M_DAT_PetList,n[1].data);var a=FacadeApp.read(CommandList.Re_PetInfo).FightingPet,o=1;i.armyOfMine=new t.Army(t.ArmyRunType["static"]),i.armyOfMine.rebuild([new t.SoldierConfigInfo(t.SoldierType.hero,o),new t.SoldierConfigInfo(t.SoldierType.pet,a.ID)]),i.addChild(i.armyOfMine),i.armyOfEnemy=new t.Army(t.ArmyRunType.dyncCreate),i.addChildAt(i.armyOfEnemy,0),i.refreshState(!0),i.status.start()})["catch"](function(t){setTimeout(function(){i.loadData(e)},1e3)})},i.prototype.createStatusMachine=function(e){var i=this;this.status=StateMachine.create({initial:{state:e,event:"initialize"},events:[{name:"start",from:t.FightStatusList.ready,to:t.FightStatusList.running},{name:"stop",from:t.FightStatusList.running,to:t.FightStatusList.suspend},{name:"continue",from:t.FightStatusList.suspend,to:t.FightStatusList.running}],callbacks:{onstart:function(t,e,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return i.FrameCheckStart(),[2]})})},oncontinue:function(t,e,n){i.FrameCheckStart()},onstop:function(t,e,n){i.FrameCheckStop(),BG.GetInstance().RemoveTween(),Decoration.GetInstance().RemoveTween(),i.armyOfMine.suspend(),i.armyOfEnemy.suspend()}},error:function(t,e,i,n,a,o){return"event "+t+": "+o}})},i.prototype.refreshState=function(e){return void 0===e&&(e=!1),__awaiter(this,void 0,void 0,function(){var i,n,a,o,r,s,c,l,u,h,p,d,_=this;return __generator(this,function(m){switch(m.label){case 0:return i=FacadeApp.read(CommandList.Re_Status),this.armyOfMine.hero.Damage=Digit.fromObject(i.power),this.armyOfMine.pet.Damage=Digit.fromObject(i.powerClick),this.armyOfMine.AutoTimes=this.armyOfMine.pet.FightingPet.AutoTimes+FacadeApp.Calc(effectEnum.AutoAttack,0),this.state.LEVEL=FacadeApp.read(CommandList.Re_FightInfo).LEVEL,this.state._monsterCount=FacadeApp.read(CommandList.Re_FightInfo)._monsterCount,this.state.checkPointStatus=FacadeApp.read(CommandList.Re_FightInfo).checkPointStatus,this.state.TOTALMONSTER=FacadeApp.read(CommandList.Re_FightInfo).TOTALMONSTER,parseInt(FacadeApp.read(CommandList.Re_FightInfo).eid)<=0&&(n=this,a=FacadeApp.read(CommandList.Re_FightInfo).events,Object.keys(a).map(function(e){t.EventHandler.createEvent(a[e],_.status)})),e?(this.status.stop(),o=Math.max(this.state.LEVEL%(GameConfigOfRuntime.monsterCount-3),1),r=FacadeApp.read(CommandList.Re_FightInfo).BOSSID,s=ConfigStaticManager.getItem(ConfigTypeName.Boss,r),(null==s||void 0==s)&&(r=13,s=ConfigStaticManager.getItem(ConfigTypeName.Boss,r)),UIPage.inst(UIPage)._bossLifeUI.bossIconIma.source=s.iconRes+"_png",parseInt(FacadeApp.read(CommandList.Re_FightInfo).eid)>0||this.state.LEVEL%ConfigStaticManager.bossLevel==0?0!=this.armyOfEnemy.soldierNum&&this.armyOfEnemy.soldierOfFirst.unitType==t.SoldierType.boss?[3,3]:this._countdownArmature?[3,2]:(c=this,[4,MovieManage.PromisifyGetDragonBonesMovie("countdown",this)]):[3,4]):[2];case 1:c._countdownArmature=m.sent(),this._countdownArmature.display.x=320,this._countdownArmature.display.y=400,this._countdownArmature.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){_.removeChild(_._countdownArmature.display),parseInt(FacadeApp.read(CommandList.Re_FightInfo).eid)>0?(_.state._monsterCount=FacadeApp.read(CommandList.Re_FightInfo)._monsterCount,_.state.TOTALMONSTER=FacadeApp.read(CommandList.Re_FightInfo).TOTALMONSTER,r=36,s=ConfigStaticManager.getItem(ConfigTypeName.Boss,r),UIPage.inst(UIPage)._bossLifeUI.bossIconIma.source=s.iconRes+"_png",_.armyOfEnemy.rebuild([new t.SoldierConfigInfo(t.SoldierType.boss,r)])):(r=FacadeApp.read(CommandList.Re_FightInfo).BOSSID,s=ConfigStaticManager.getItem(ConfigTypeName.Boss,r),(null==s||void 0==s)&&(r=13,s=ConfigStaticManager.getItem(ConfigTypeName.Boss,r)),UIPage.inst(UIPage)._bossLifeUI.bossIconIma.source=s.iconRes+"_png",_.armyOfEnemy.rebuild([new t.SoldierConfigInfo(t.SoldierType.boss,r)])),UIPage.inst(UIPage)._bossLifeUI.visible=!0,_.status["continue"]()},this),m.label=2;case 2:this.addChild(this._countdownArmature.display),this._countdownArmature.animation.gotoAndPlay("start",0),m.label=3;case 3:return[3,5];case 4:for(UIPage.inst(UIPage)._bossLifeUI.visible=!1,l=new Array,u=0;u<GameConfigOfRuntime.CPMCount;u++)h=Math.random(),p=0,d=Math.floor(10*Math.random()),p=0==d?t.Army.MonsterResSet.length-1:Math.floor(h*(GameConfigOfRuntime.CPMCount+1))+o,l.push(new t.SoldierConfigInfo(t.SoldierType.monster,p));this.armyOfEnemy.rebuild(l),this.status["continue"](),m.label=5;case 5:return[2]}})})},i.prototype.creatJinBi=function(t){if(0==t.t){var e=["ding_jb_png"];physicsWorld.addOneBox(e[Math.floor(Math.random()*e.length)],t.x,t.y,1,Main.Instance.TopSence)}else 1==t.t?physicsWorld.addOneBox("ding_jb_png",t.x,t.y,10,Main.Instance.TopSence):2==t.t?physicsWorld.addOneBox("ding_jb_png",t.x,t.y,20,Main.Instance.TopSence):3==t.t&&physicsWorld.addOneBox("ding_jb_png",t.x,t.y,1,Main.Instance.TopSence);SoundManager.PlayGoldMusic()},i.prototype._Framing=function(e){this.status.current==t.FightStatusList.running&&(this.armyOfMine.Framing(e,{x:0,y:0}),this.armyOfEnemy.Framing(e,{x:this.armyOfMine.hero.x,y:this.armyOfMine.hero.y}),t.EventHandler.Framing())},i.prototype.ChangeTollgate=function(){var t=this;null==this.succAni&&(this.status.stop(),this.succAni=setTimeout(function(){t._passImage||(t._passImage=new eui.Image,t._passImage.source=RES.getRes("gxguoguan_png"),t._passImage.y=50),t.addChild(t._passImage),t.succAni=setTimeout(function(){t._passImage.parent&&t.removeChild(t._passImage),t.armyOfMine.goAhead().then(function(){t.succAni=null,parseInt(FacadeApp.read(CommandList.Re_FightInfo).eid)>0?(FacadeApp.dispatchAction(CommandList.M_AT_ReturnTollgate,{}),FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint)):FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=1","&gateNo=",t.state.LEVEL,"&monsterNum=",t.state.TOTALMONSTER],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])},function(e){t.status["continue"]()}])})["catch"](function(e){t.succAni=null,t.status["continue"]()})},1500)},500))},i.prototype.readyZS=function(){this.status.stop(),this.armyOfMine.disappear(),this.status["continue"]()},i.prototype._TouchTap=function(e){this.status&&this.status.current!=t.FightStatusList.suspend&&(e.stageY>=680||e.stageY<=200||FacadeApp.dispatchAction(CommandList.M_CMD_PetAttack))},i.prototype.creatShangDian=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(a){switch(a.label){case 0:return null==this.armyOfEnemy||0==this.armyOfEnemy.soldierNum?[2]:[4,MovieManage.PromisifyGetDragonBonesMovie("shandian",this)];case 1:return e=a.sent(),this.addChild(e.display),e.display.x=t.stageX,e.display.y=t.stageY,this.armyOfEnemy.soldierNum>0?this.armyOfEnemy.soldierOfFirst.x>640?(e.display.posiX=400,e.display.posiY=this.armyOfMine.hero.y):(e.display.posiX=this.armyOfEnemy.soldierOfFirst.x,e.display.posiY=this.armyOfEnemy.soldierOfFirst.y-60):(e.display.posiX=400,e.display.posiY=this.armyOfMine.hero.y),i=e.display.posiX-e.display.x,n=e.display.posiY-e.display.y,e.display.scaleX=Math.sqrt(i*i+n*n)/(e.display.width-20),e.display.rotation=180*Math.atan2(n,i)/Math.PI,e.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,a=this;return __generator(this,function(o){switch(o.label){case 0:return MovieManage.RemoveArmature(t.target.parent),this.removeChild(t.target),e=t.target,i=ObjectPool.getPool("eui.Image").borrowObject(),n=i,[4,MovieManage.PromisifyGetRes("shoudian_png",this)];case 1:return n.texture=o.sent(),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,i.x=e.posiX,i.y=e.posiY,this.addChild(i),setTimeout(function(){a.removeChild(i),ObjectPool.getPool("eui.Image").returnObject(i)},100),[2]}})})},this),e.animation.gotoAndPlay("shandian"),[2]}})})},i.prototype.giveUpOrFight=function(){var e=this;this.status.current==t.FightStatusList.running&&("fight"==FacadeApp.read(CommandList.Re_FightInfo).GIVEUPORFIGHT?(this.status.stop(),FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=5","&gateNo=",this.state.LEVEL,"&monsterNum=",this.state.TOTALMONSTER],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),t.code==FacadeApp.SuccessCode||UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])},function(t){e.status["continue"]()}])):this._GiveUp())},i.prototype._GiveUp=function(){var t=this;this.status.stop(),this.armyOfEnemy.goAhead().then(function(){t.armyOfEnemy.suspend()}),this.armyOfMine.retreat().then(function(){parseInt(FacadeApp.read(CommandList.Re_FightInfo).eid)>0?FacadeApp.dispatchAction(CommandList.M_AT_ReturnTollgate,{}):FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=2","&gateNo=",t.state.LEVEL,"&monsterNum=",0],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])},function(e){t.status["continue"]()}])})["catch"](function(e){t.status["continue"]()})},i.prototype._RemoveGuaJiStartPVP=function(){this.status.stop(),this.armyOfMine.retreat().then(function(){FacadeApp.dispatchAction(CommandList.PVP_StartComeIn)})},i.prototype.FrameCheckStart=function(){egret.Ticker.getInstance().register(this._Framing,this),FacadeApp.Notify(CommandList.M_MS_FightStatusChg)},i.prototype.FrameCheckStop=function(){egret.Ticker.getInstance().unregister(this._Framing,this),FacadeApp.Notify(CommandList.M_MS_FightStatusChg)},i.GetInstance=function(){return i._instance||(i._instance=new i(t.FightStatusList.ready)),i._instance},i}(egret.DisplayObjectContainer);t.FightManager=e,__reflect(e.prototype,"SoldierManage.FightManager")}(SoldierManage||(SoldierManage={}));var LifeNumber=function(t){function e(e){var i=t.call(this)||this;return e?i.skinName="resource/game_skins/monster/PetLifeNumber.exml":i.skinName="resource/game_skins/monster/LifeNumber.exml",i}return __extends(e,t),Object.defineProperty(e.prototype,"number",{set:function(t){this._lifeBitmapLabel.text=t},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(LifeNumber.prototype,"LifeNumber",["eui.UIComponent","egret.DisplayObject"]);var MonsterLifeBar=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/monster/MonsterLifeBar.exml",e}return __extends(e,t),e}(eui.ProgressBar);__reflect(MonsterLifeBar.prototype,"MonsterLifeBar",["eui.UIComponent","egret.DisplayObject"]);var SoldierManage;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.onInit(),t}return __extends(n,e),n.prototype.onReady=function(t,e,i){},n.prototype.onMove=function(t,e,i){this._armature&&this._armature.animation.gotoAndPlay("move")},n.prototype.onRunning=function(t,e,i){this.status.moveEvent()},n.prototype.onHit=function(t,e,i,n){this.y=GameConfigOfRuntime.monsterY;var a=egret.Tween.get(this);switch(this._armature.animation.gotoAndPlay("hit"),n){case"hit2":a.to({y:GameConfigOfRuntime.monsterY-80},Math.floor(4e3/24)).to({y:GameConfigOfRuntime.monsterY,x:this.x+81},Math.floor(5e3/24)).call(this.status.moveEvent,this.status);break;case"hit3":a.to({x:this.x+80},Math.floor(5e3/24)).call(this.status.moveEvent,this.status);break;case"hit1":default:a.wait(Math.floor(250)).to({x:this.x+20},100).call(this.status.moveEvent,this.status)}},n.prototype.onInit=function(){return this._id=0,this.x=GameConfigOfRuntime.monsterX,this.y=GameConfigOfRuntime.monsterY,this.alpha=1,this},n.prototype.setData=function(e,n,a){this._armature=a,this.addChild(this._armature.display),this.unitType=n?t.SoldierType.boss:t.SoldierType.monster,this.ID=e,this.IsBoss?(this.unitType=t.SoldierType.boss,this.traitType=ConfigStaticManager.getItem(ConfigTypeName.Boss,this.ID).trait):this.unitType=t.SoldierType.monster,0==this.IsBoss&&(this._monsterLifeBar=this._monsterLifeBar||new MonsterLifeBar,this.addChild(this._monsterLifeBar),this._monsterLifeBar.x=-this._monsterLifeBar.width/2,this._monsterLifeBar.y=-this._armature.display.height,this._monsterLifeBar.slideDuration=500);var o=i.life(FacadeApp.read(CommandList.Re_FightInfo).LEVEL),r=FacadeApp.read(CommandList.Re_FightInfo).TOTALMONSTER;return n?(this.totalLife=o.clone.Mul(FacadeApp.Calc(effectEnum.ReduceBossBlood,1)),this.Life=this.totalLife.clone):(this.totalLife=o.clone.Div(r),this.Life=this.totalLife.clone),this.status.moveEvent(),this},n.prototype.onReturn=function(){return this.parent.removeChild(this),this.RemoveArmature(),this._id=0,this.x=GameConfigOfRuntime.monsterX,this.y=GameConfigOfRuntime.monsterY,this._monsterLifeBar&&(this._monsterLifeBar.parent&&this._monsterLifeBar.parent.removeChild(this._monsterLifeBar),this._monsterLifeBar=null),this},Object.defineProperty(n.prototype,"IsBoss",{get:function(){return this.unitType==t.SoldierType.boss},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"IsBaoXiang",{get:function(){return t.Army.MonsterResSet&&this._id==t.Army.MonsterResSet.length-1},enumerable:!0,configurable:!0}),n}(t.Soldier);t.MonsterSoldier=e,__reflect(e.prototype,"SoldierManage.MonsterSoldier");var i=function(){function t(){}return t.life=function(t){if("undefined "==typeof this.lifeList[t]||null==this.lifeList[t]){for(var e=new Digit([200,0]),i=7*t/200;i>0;){var n=i>=100?100:i;e.Mul(Math.pow(150,n)),i-=n}this.lifeList[t]=e}return this.lifeList[t]},t}();i.lifeList=[],t.MonsterLiftConfig=i,__reflect(i.prototype,"SoldierManage.MonsterLiftConfig")}(SoldierManage||(SoldierManage={}));var SoldierManage;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.UpdatePet(),t.skewY=0,FacadeApp.AddListener(CommandList.M_CMD_PetAttack,function(){t.PetAttacking()},t),FacadeApp.AddListener(CommandList.M_CMD_Change_Pet,t.UpdatePet,t),t}return __extends(i,e),i.prototype.Framing=function(e){this.timerOfResent+=e,this.FightingPet&&(t.FightManager.GetInstance().armyOfMine.pet.FightingPet.AutoTimes+FacadeApp.Calc(effectEnum.AutoAttack,0)>0&&this.timerOfResent>=1e3/(t.FightManager.GetInstance().armyOfMine.pet.FightingPet.AutoTimes+FacadeApp.Calc(effectEnum.AutoAttack,0))&&(this.timerOfResent=0,FacadeApp.dispatchAction(CommandList.M_CMD_PetAttack)),this.status.current==t.SoldierStatusList.move&&this.x<70&&(this.x+=GameConfigOfRuntime.roleSpeed))},i.prototype.UpdatePet=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,MovieManage.PromisifyGetDragonBonesMovie(this.FightingPet.DragonRes,this)];case 1:return t=e.sent(),null!=this._armature&&(MovieManage.RemoveArmature(this._armature),this._armature.display.parent&&this._armature.display.parent.removeChild(this._armature.display)),this._armature=t,this.x=100,this.y=350,this.addChild(this._armature.display),this._armature.animation.gotoAndPlay("move"),[2]}})})},i.prototype.PetFinishAttack=function(){this._armature.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.PetFinishAttack,this),this._armature.animation.gotoAndPlay("move")},i.prototype.PetAttacking=function(){var e=t.FightManager.GetInstance();if(SoundManager.PlayMusic(this.FightingPet.Music,1),this._armature){var i=this._armature.animation.getState("attack");(!i||i.isCompleted)&&(this._armature.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.PetFinishAttack,this),this._armature.animation.gotoAndPlay("attack",-1,-1,1))}var n=this.x+135,a=this.y+350,o=this;MovieManage.getResList([this.FightingPet.FSRes,this.FightingPet.DJRes,o.FightingPet.SJ1Res,o.FightingPet.SJ2Res],function(i){var o=ObjectPool.getPool("eui.Image").borrowObject();o.source=i[0],o.anchorOffsetX=0,o.anchorOffsetY=0,o.x=-110+n,o.y=-380+a,e.addChild(o),setTimeout(function(){e.removeChild(o),ObjectPool.getPool("eui.Image").returnObject(o)},100);var r=ObjectPool.getPool("eui.Image").borrowObject();r.source=i[1],r.anchorOffsetX=0,r.anchorOffsetY=0,r.x=-100+n,r.y=-370+a,e.addChild(r);var s=200*Math.random();egret.Tween.get(r).to({x:130+n+s,y:-125+a},300).call(function(n,a,o){e.removeChild(n),ObjectPool.getPool("eui.Image").returnObject(n);var r=ObjectPool.getPool("eui.Image").borrowObject();r.source=i[2],r.anchorOffsetX=0,r.anchorOffsetY=0,r.x=30+a+s,r.y=o,e.addChild(r),setTimeout(function(){e.removeChild(r),ObjectPool.getPool("eui.Image").returnObject(r);var t=ObjectPool.getPool("eui.Image").borrowObject();t.source=i[3],t.anchorOffsetX=0,t.anchorOffsetY=0,t.x=a+s,t.y=o,e.addChild(t),setTimeout(function(){e.removeChild(t),ObjectPool.getPool("eui.Image").returnObject(t)},100)},100),FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1",src:t.HurtSourceType.pet})},e,[r,130+n,-125+a])},this)},Object.defineProperty(i.prototype,"FightingPet",{get:function(){return FacadeApp.read(CommandList.Re_PetInfo).FightingPet},enumerable:!0,configurable:!0}),i}(t.Soldier);t.PetSoldier=e,__reflect(e.prototype,"SoldierManage.PetSoldier")}(SoldierManage||(SoldierManage={}));var SoldierManage;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.attackAniSet=[],i.curAniIndex=0,i.AttackAniGroupName="",FacadeApp.AddListener(CommandList.M_CMD_RoleAttack,function(){i.status.attackingEvent()}),i.createArmature(1),i.attackAniSet[t.RoleAttackAniGroupNames.Attack1]=["_1","_2","_3","_4"],i.attackAniSet[t.RoleAttackAniGroupNames.Attack2]=["_1","_2","_3","_4","_5"],i.attackAniSet[t.RoleAttackAniGroupNames.Attack3]=["_1","_2","_3"],i.attackAniSet[t.RoleAttackAniGroupNames.Attack4]=["_1","_2"],i.attackAniSet[t.RoleAttackAniGroupNames.Attack5]=["_1","_2"],i.attackAniSet[t.RoleAttackAniGroupNames.Attack6]=["_1","_2","_3","_4","_5","_6","_7"],i.attackAniSet[t.RoleAttackAniGroupNames.Attack7]=["_1","_2","_3"],i.skewY=0,i}return __extends(i,e),i.prototype.onReady=function(t,e,i){this.x=GameConfigOfRuntime.roleX,this.y=GameConfigOfRuntime.roleY,FacadeApp.dispatchAction(CommandList.M_CMD_Change_Pet)},i.prototype.onRunning=function(t,e,i){this.status.moveEvent()},i.prototype.onBeforeattacking=function(t,e,i){this._Attack()},i.prototype.onHit=function(t,e,i,n){},i.prototype.onDeath=function(t,e,i){},i.prototype.onSuspend=function(t,e,i){},i.prototype.onAttacking=function(t,e,i,n){},i.prototype.onMove=function(t,e,i){this._armature&&this._armature.animation.gotoAndPlay("move")},i.prototype.onStand=function(t,e,i){this._armature.animation.gotoAndPlay("stand")},i.prototype.createArmature=function(t){return __awaiter(this,void 0,void 0,function(){var e,i=this;return __generator(this,function(n){switch(n.label){case 0:return this._id=t,this._armature&&(this.removeChild(this._armature.display),MovieManage.RemoveArmature(this._armature),this._armature=null),e=this,[4,MovieManage.PromisifyGetDragonBonesMovie("wukong"+t,this)];case 1:return e._armature=n.sent(),this._armature.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){return i.curAniGroup&&i.curAniIndex<i.curAniGroup.length?(i._armature.animation.gotoAndPlay(i.AttackAniGroupName+i.curAniGroup[i.curAniIndex],-1,-1,1),void(i.curAniIndex+=1)):void i.status.moveEvent()},this),this.status.moveEvent(),this.addChild(this._armature.display),[2]}})})},i.prototype.Framing=function(e){this.timerOfResent+=e,this.status.current==t.SoldierStatusList.move&&this.x<GameConfigOfRuntime.roleMaxX?this.x+=GameConfigOfRuntime.roleSpeed:this.status.current==t.SoldierStatusList.move&&BG.GetInstance().Move(5,20)},i.prototype._PlayAttackMusic=function(){for(var e=1;e<=t.RoleAttackAniGroupNames.AttackCount;e++)this.AttackAniGroupName=="attack"+e&&SoundManager.PlayMusic(SoundManager["Attack"+e+"_Music"],1)},i.prototype._Attack=function(){if(this.status.current!=t.SoldierStatusList.attacking){var e=[];e=this.x>GameConfigOfRuntime.roleMaxX+50?[t.RoleAttackAniGroupNames.Attack1,t.RoleAttackAniGroupNames.Attack2,t.RoleAttackAniGroupNames.Attack3,t.RoleAttackAniGroupNames.Attack6,t.RoleAttackAniGroupNames.Attack7]:Math.random()<.4?[t.RoleAttackAniGroupNames.Attack4,t.RoleAttackAniGroupNames.Attack5]:[t.RoleAttackAniGroupNames.Attack1,t.RoleAttackAniGroupNames.Attack2,t.RoleAttackAniGroupNames.Attack3,t.RoleAttackAniGroupNames.Attack4,t.RoleAttackAniGroupNames.Attack5,t.RoleAttackAniGroupNames.Attack6];var i=Math.floor(e.length*Math.random());this.AttackAniGroupName==e[i]&&(e.splice(i,1),i=Math.floor(e.length*Math.random())),this.AttackAniGroupName=e[i],this.curAniGroup=this.attackAniSet[this.AttackAniGroupName],this.curAniIndex=0,this._armature.animation.timeScale=FacadeApp.Calc(effectEnum.HeroAttackSpeed,1),this._armature.animation.gotoAndPlay(this.AttackAniGroupName+this.curAniGroup[this.curAniIndex],-1,-1,1),this.curAniIndex+=1,this._PlayAttackMusic();
var n=this.x,a=egret.Tween.get(this);switch(this.AttackAniGroupName==t.RoleAttackAniGroupNames.Attack7&&a.wait(300).to({x:n-200},300),this.AttackAniGroupName){case t.RoleAttackAniGroupNames.Attack1:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1"})},Math.floor(11e3/24));break;case t.RoleAttackAniGroupNames.Attack2:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1"})},Math.floor(375)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit2"})},Math.floor(14e3/24));break;case t.RoleAttackAniGroupNames.Attack3:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1"})},Math.floor(7e3/24));break;case t.RoleAttackAniGroupNames.Attack4:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(4e3/24)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(13e3/24)),a.to({x:n+100},600),BG.GetInstance().Move(250,700);break;case t.RoleAttackAniGroupNames.Attack5:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(125)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(8e3/24)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(13e3/24)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(750)),a.to({x:n+150},500),BG.GetInstance().Move(200,600);break;case t.RoleAttackAniGroupNames.Attack6:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1"})},Math.floor(7e3/24)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1"})},Math.floor(625)),setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit1"})},Math.floor(28e3/24));break;case t.RoleAttackAniGroupNames.Attack7:setTimeout(function(){FacadeApp.dispatchAction(CommandList.M_CMD_FIGHT_HIT_ENEMY,{aniName:"hit3"})},Math.floor(1e4/24))}this.AttackAniGroupName!=t.RoleAttackAniGroupNames.Attack4&&this.AttackAniGroupName!=t.RoleAttackAniGroupNames.Attack5&&this.AttackAniGroupName!=t.RoleAttackAniGroupNames.Attack7&&this.x>GameConfigOfRuntime.roleMaxX&&(a.to({x:GameConfigOfRuntime.roleMaxX-20},1e3),BG.GetInstance().Move(this.x-(GameConfigOfRuntime.roleMaxX-20),1e3))}},i}(t.Soldier);t.RoleSoldier=e,__reflect(e.prototype,"SoldierManage.RoleSoldier")}(SoldierManage||(SoldierManage={}));var ConfigStaticManager=function(){function t(){}return t.Init=function(){t.localStorage={},Object.keys(ConfigTypeName).map(function(e){t.LoadJSON(ConfigTypeName[e])})},t.getItem=function(e,i){return t.localStorage[e][i]},t.getList=function(e){return t.localStorage[e]},t.LoadJSON=function(e){t.localStorage[e]=null;var i=RES.getRes(e);return null==i?void console.log("读取数据配置失败"):(t.localStorage[e]=i,void Object.keys(i).map(function(n){t.localStorage[e][i[n].id]=i[n]}))},t}();ConfigStaticManager.bossLevel=5,ConfigStaticManager.bossTotalTime=30,__reflect(ConfigStaticManager.prototype,"ConfigStaticManager");var ConfigTypeName={Talisman:"talismancfg_json",Task:"dailyTaskcfg_json",Shop:"goodscfg_json",Amulet:"amuletcfg_json",Card:"cardcfg_json",Boss:"bosscfg_json",RewardType:"rewardTypecfg_json",Pet:"petcfg_json",Monster:"monstercfg_json",ActiveSkill:"activeSkillscfg_json",TalismanSkill:"talismanSkillscfg_json",CardSkill:"cardSkill_json",PetGenius:"petGeniuscfg_json",PVPAni:"skillarmcfg_json"},SoldierManage;!function(t){var e=function(){function e(e,i){this.uid=0,this.utype=t.SoldierType.hero,this.uid=i,this.utype=e}return e}();t.SoldierConfigInfo=e,__reflect(e.prototype,"SoldierManage.SoldierConfigInfo");var i=function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.newSildier=function(e){var i=null;switch(e.utype){case t.SoldierType.hero:i=new t.RoleSoldier;break;case t.SoldierType.pet:i=new t.PetSoldier;break;case t.SoldierType.monster:case t.SoldierType.boss:i=new t.MonsterSoldier;break;default:i=new t.Soldier}return i.unitType=e.utype,i},e}();t.SoldierFactory=i,__reflect(i.prototype,"SoldierManage.SoldierFactory")}(SoldierManage||(SoldierManage={}));var GuideHand=function(t){function e(){var e=t.call(this)||this;return e._Init(),e}return __extends(e,t),e.prototype._Init=function(){this._image=new eui.Image("xinshou_jiantou_png"),this._image.x=-32.5,this._image.y=-65,this.addChild(this._image)},e.prototype.Play=function(){if(null!=this.parent){egret.Tween.removeTweens(this._image);var t=egret.Tween.get(this._image);t.to({y:-100},500).to({y:-65},500).call(this.Play,this)}},e.prototype.Stop=function(){this._image.x=-32.5,this._image.y=-65,egret.Tween.removeTweens(this._image)},e}(egret.DisplayObjectContainer);__reflect(GuideHand.prototype,"GuideHand");var GuideWindow=function(t){function e(){return t.call(this,"resource/game_skins/GuidePageSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype.Show=function(t){var e=this;this._shang.visible=!1,this._xia.visible=!1,this._zuo.visible=!1,this._you.visible=!1,this._group.visible=!0;var i=egret.Tween.get(this._group);switch(t){case 1:this._guideInfo.text="此处6个为主动技能长按查看详情,点击释放",this._group.x=170,this._group.y=710,this._xia.visible=!0,i.to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3);break;case 2:this._guideInfo.text="升级法宝、宠物、符咒以及神魔可以更快的过关哦！",this._group.x=150,this._group.y=800,this._xia.visible=!0,i.to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3);break;case 3:this._guideInfo.text="三界符抽奖可获得大量卡牌碎片，合成卡牌增加PVP战斗力哦！每日更有3次免费抽取机会",this._group.x=70,this._group.y=300,this._zuo.visible=!0,i.to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3).to({scaleX:1.1,scaleY:1.1},1e3).to({scaleX:1,scaleY:1},1e3);break;case 0:UIPage.inst(UIPage).ShowGuideWindow().UnRegister()}egret.setTimeout(function(){e._group.visible=!1},this,8e3)},e.prototype.GuideCheck=function(){if(this.Show(FacadeApp.read(CommandList.Re_Status).guideId),0==FacadeApp.read(CommandList.Re_Status).guideId){var t=FacadeApp.read(CommandList.Re_Status).diamond;FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(e){if(e.code==FacadeApp.SuccessCode){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,e.data);var i="恭喜您完成了新手引导，获得元宝：100";FacadeApp.read(CommandList.Re_Status).diamond-t>0&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(i)}}])}},e.prototype.GuideFinish=function(t){var e=this;void 0===t&&(t=0),(0==t||t==FacadeApp.read(CommandList.Re_Status).guideId)&&FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=12","&gid="+FacadeApp.read(CommandList.Re_Status).guideId],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_GUIDE,t.data),e.GuideCheck()}])},e}(APanel);__reflect(GuideWindow.prototype,"GuideWindow");var IntegralExchangeList=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/IntegralExchangeListSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.SetShow=function(t,e){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(this._haveReceiveIma.visible=!1,this._receiveButton.visible=!1,i=FacadeApp.read(CommandList.Re_ActivityInfo),this._integralNumLabel.text=Math.floor(i.score)+"/"+t.score,this._itemNumLabel1.text="X"+t.bonus[0].num.toString(),this._itemNumLabel2.text="X"+t.bonus[1].num.toString(),t.bonus[0].type){case 1:this._itemIcon1.source=RES.getRes("ding_yb_png");break;case 2:this._itemIcon1.source=RES.getRes("ding_jb_png");break;case 1e3:this._itemIcon1.source=RES.getRes("jifen_suipianty_png")}switch(t.bonus[1].type){case 1:this._itemIcon2.source=RES.getRes("ding_yb_png");break;case 2:this._itemIcon2.source=RES.getRes("ding_jb_png");break;case 1e3:this._itemIcon2.source=RES.getRes("jifen_suipianty_png")}return i.score>=t.score&&0==i.act[e]&&(this._receiveButton.visible=!0),0!=i.act[e]&&(this._haveReceiveIma.visible=!0,this._integralNumLabel.visible=!1),this._index=e,this._receiveButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onReceiveClick,this),[2]})})},e.prototype.onReceiveClick=function(t){var e=this;FacadeApp.fetchData([CommandList.M_NET_Activity,"&oper=3&id=",this._index],[function(t){t.code!=FacadeApp.SuccessCode?UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):(e._receiveButton.visible=!1,e._integralNumLabel.visible=!1,e._haveReceiveIma.visible=!0,FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data)}]))}])},e}(eui.Component);__reflect(IntegralExchangeList.prototype,"IntegralExchangeList");var IntegralRankList=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/IntegralRankListSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.SetShow=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(a){switch(a.label){case 0:return this._numLabel.visible=!1,1!=t.rank?[3,2]:(e=this._maxThreeIma,[4,MovieManage.PromisifyGetRes("jifendh_mc_1_png")]);case 1:return e.texture=a.sent(),[3,7];case 2:return 2!=t.rank?[3,4]:(i=this._maxThreeIma,[4,MovieManage.PromisifyGetRes("jifendh_mc_2_png")]);case 3:return i.texture=a.sent(),[3,7];case 4:return 3!=t.rank?[3,6]:(n=this._maxThreeIma,[4,MovieManage.PromisifyGetRes("jifendh_mc_3_png")]);case 5:return n.texture=a.sent(),[3,7];case 6:this._maxThreeIma.visible=!1,this._numLabel.visible=!0,this._numLabel.text=String(t.rank),a.label=7;case 7:return this._nameLabel.text=t.name,this._xiaofeiLabel.text="消费积分："+t.score.toString(),this._data=t,[2]}})})},e}(eui.Component);__reflect(IntegralRankList.prototype,"IntegralRankList");var IntegralRuleWindow=function(t){function e(){return t.call(this,"resource/game_skins/IntegralRulePageSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){},e.prototype.ComponentDidMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this);var t=FacadeApp.read(CommandList.Re_ActivityInfo);t.type==ActivityType.Money&&(this._ruleLabel.text="  本次活动为累计消耗金币，活动持续一周，周六晚9点结算活动排名奖励。 \n \n   结算活动后，本期活动结束，活动信息保留供用所有玩家查看，直至下一期活动开启，周天轮休。"),t.type==ActivityType.Diamond&&(this._ruleLabel.text="  本次活动为累计消耗元宝，活动持续一周，周六晚9点结算活动排名奖励。 \n \n   结算活动后，本期活动结束，活动信息保留供用所有玩家查看，直至下一期活动开启，周天轮休。")},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanel);__reflect(IntegralRuleWindow.prototype,"IntegralRuleWindow");var activityBonus={ActivityScoreBonus:{0:{0:{score:60,bonus:[{type:1e3,id:0,num:1},{type:2,num:2}]},1:{score:120,bonus:[{type:1e3,id:0,num:1},{type:2,num:2}]},2:{score:360,bonus:[{type:1e3,id:0,num:2},{type:2,num:3}]},3:{score:480,bonus:[{type:1e3,id:0,num:3},{type:2,num:3}]},4:{score:600,bonus:[{type:1e3,id:0,num:4},{type:2,num:4}]},5:{score:720,bonus:[{type:1e3,id:0,num:5},{type:2,num:5}]}},1:{0:{score:40,bonus:[{type:1e3,id:0,num:1},{type:2,num:1}]},1:{score:80,bonus:[{type:1e3,id:0,num:1},{type:2,num:5}]},2:{score:200,bonus:[{type:1e3,id:0,num:2},{type:2,num:10}]},3:{score:300,bonus:[{type:1e3,id:0,num:2},{type:2,num:10}]},4:{score:450,bonus:[{type:1e3,id:0,num:3},{type:2,num:10}]},5:{score:600,bonus:[{type:1e3,id:0,num:4},{type:2,num:10}]}}},ActivityRankBonus:{0:{1:{rank:1,bonus:[{type:1e3,id:0,num:10},{type:1,num:150}]},2:{rank:2,bonus:[{type:1e3,id:0,num:8},{type:1,num:120}]},3:{rank:3,bonus:[{type:1e3,id:0,num:5},{type:1,num:100}]}},1:{1:{rank:1,bonus:[{type:1e3,id:0,num:10},{type:1,num:150}]},2:{rank:2,bonus:[{type:1e3,id:0,num:8},{type:1,num:120}]},3:{rank:3,bonus:[{type:1e3,id:0,num:5},{type:1,num:100}]}}}},ActivityType={Money:0,Diamond:1},IntegralWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/IntegralWindowSkins.exml")||this;return e._rankArr=[],e._bonusArr=[],FacadeApp.inst.removeMediator(ViewerName.IntegralWindowMediator),FacadeApp.inst.registerMediator(new IntegralWindowMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){var t=new eui.RadioButtonGroup;t.addEventListener(egret.Event.CHANGE,this._UpdataPage,this),this._integralExchangeRadio.group=t,this._integralExchangeRadio.value=1,this._integralRankRadio.group=t,this._integralRankRadio.value=2,this._UpdataPage(null),this.touchEnabled=!0,this.touchChildren=!0,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._ruleButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onRuleClick,this)},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Integral)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var e,i,i,n,a,o,r,s=this;return __generator(this,function(c){if(t.prototype.Render.call(this),e=FacadeApp.read(CommandList.Re_ActivityInfo),this._myRankNumLabel.text=e.rank,this._integralTimeLabel.text="活动时间："+e.starttime+" 至 "+e.endtime,this._rankArr.length>0)for(i=0;i<this._rankArr.length;i++)this._rankGroup.removeChild(this._rankArr[i]);if(this._rankArr=[],this._bonusArr.length>0)for(i=0;i<this._bonusArr.length;i++)this._exchangeGroup.removeChild(this._bonusArr[i]);if(this._bonusArr=[],this._rankGroup.visible&&FacadeApp.fetchData([CommandList.M_NET_Activity,"&oper=2"],[function(t){if(t.code!=FacadeApp.SuccessCode)UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]);else{var e=0;for(var i in t.data.list){var n=t.data.list[i],a=new IntegralRankList;s._rankGroup.addChild(a),a.y=e,e+=a.height,s._rankArr.push(a),a.SetShow(n),s._rankListGroup.stopAnimation(),s._rankListGroup.viewport.scrollV=0,s._rankListGroup.bounces=!1,s._rankListGroup.verticalScrollBar.autoVisibility=!1,s._rankListGroup.verticalScrollBar.visible=!1}}}]),this._exchangeGroup.visible){n=0;for(a in activityBonus.ActivityScoreBonus[e.type])o=activityBonus.ActivityScoreBonus[e.type][a],r=new IntegralExchangeList,this._exchangeGroup.addChild(r),r.y=n,n+=r.height,this._bonusArr.push(r),r.SetShow(o,a),this._exchangeListGroup.stopAnimation(),this._exchangeListGroup.viewport.scrollV=0,this._exchangeListGroup.bounces=!1,this._exchangeListGroup.verticalScrollBar.autoVisibility=!1,this._exchangeListGroup.verticalScrollBar.visible=!1}return[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype.onRuleClick=function(t){FacadeApp.Notify(CommandList.M_CMD_UiOpened_ActivityRule)},e.prototype._UpdataPage=function(t){var e=1;if(null!=t){var i=t.target;e=i.selectedValue}this._exchangeGroup.visible=1==e,this._rankGroup.visible=2==e,this.Render()},e}(APanel);__reflect(IntegralWindow.prototype,"IntegralWindow");var IntegralWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.IntegralWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.M_DAT_ActivityInfo])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Integral]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Integral:FacadeApp.fetchData([CommandList.M_NET_Activity,"&oper=1"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_ActivityInfo,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(IntegralWindowMediator.prototype,"IntegralWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var MailDetailWindow=function(t){function e(){return t.call(this,"resource/game_skins/mail/MailDetailWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._deleteButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._closeButton1.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick2,this),this.Render()},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Mail)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),this._mail?(this.showMailContent(this._mail),[2]):[2]})})},e.prototype.showMailContent=function(t){var e=this;this._mail=t,this._titleLabel.text="",this._contentLabel.text="";var i=1;1==i?RES.getResAsync("youjian_xitonggg_png",function(t){e._mailTypeIma.texture=t},this):2==i?RES.getResAsync("youjian_xitongyj_png",function(t){e._mailTypeIma.texture=t},this):1==i&&RES.getResAsync("youjian_huodongyj_png",function(t){e._mailTypeIma.texture=t},this),this._mail.state?this._deleteButton.visible=!0:this._deleteButton.visible=!1},e.prototype._OnCloseClick=function(t){var e=this;FacadeApp.fetchData([CommandList.M_NET_Mail,"&oper=4&idx="+this._mail.id],[function(t){t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]),FacadeApp.Notify(CommandList.M_CMD_UiOpened_Mail),SoundManager.PlayCloseWinMusic(),e.UnRegister()}])},e.prototype._OnDeleteClick=function(t){var e=this;FacadeApp.fetchData([CommandList.M_NET_Mail,"&oper=2&idx="+this._mail.id],[function(t){t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]),FacadeApp.Notify(CommandList.M_CMD_UiOpened_Mail),SoundManager.PlayCloseWinMusic(),e.UnRegister()}])},e.prototype._OnCloseClick2=function(t){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Mail),SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanel);__reflect(MailDetailWindow.prototype,"MailDetailWindow");var MailLine=function(t){function e(){var e=t.call(this)||this;return e._mail=null,e.skinName="resource/game_skins/mail/MailLineSkins.exml",e}return __extends(e,t),e.prototype.update=function(t){return this._mail=t,this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTap,this),this.Render()},e.prototype.Render=function(){var t=this;if(this._mail){var e="188区 【日月通混】开服公告",i=1;1==i?RES.getResAsync("youjian_xitonggg_png",function(e){t._typeIma.texture=e},this):2==i?RES.getResAsync("youjian_xitongyj_png",function(e){t._typeIma.texture=e},this):1==i&&RES.getResAsync("youjian_huodongyj_png",function(e){t._typeIma.texture=e},this),this._mail.state?this._stateIma.source="youjian_yidu_png":this._stateIma.source="youjian_xin_png",this._derLabel.text=e}},e.prototype.onTap=function(t){UIPage.inst(UIPage).ShowMailDetailWindow(this._mail)},e}(eui.Component);__reflect(MailLine.prototype,"MailLine");var MailWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/mail/MailWindowSkins.exml")||this;return e._mailLineSet=[],FacadeApp.inst.removeMediator(ViewerName.MailWindowMediator),FacadeApp.inst.registerMediator(new MailWindowMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._chuliBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnChuLiClick,this)},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Mail)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var e,i,n,a,o,n;return __generator(this,function(r){for(t.prototype.Render.call(this),e=FacadeApp.read(CommandList.Re_MailInfo).list,i=0,n=0;n<e.length;n++)this._mailLineSet[n]||(a=new MailLine,this._mailGroup.addChild(a),this._mailLineSet.push(a)),this._mailLineSet[n].update(e[n]),this._mailLineSet[n].y=i,i+=this._mailLineSet[n].height;if(e.length<this._mailLineSet.length)for(o=this._mailLineSet.length-e.length,n=0;o>n;n++)this._mailGroup.removeChild(this._mailLineSet[this._mailLineSet.length-1]),this._mailLineSet.splice(this._mailLineSet.length-1,1);return[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnChuLiClick=function(t){var e=this;console.log("一键处理");var i=FacadeApp.read(CommandList.Re_MailInfo).noReadList;i.length>0&&FacadeApp.fetchData([CommandList.M_NET_Mail,"&oper=4&idx="+i],[function(t){t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]),FacadeApp.Notify(CommandList.M_CMD_UiOpened_Mail),SoundManager.PlayCloseWinMusic(),e.UnRegister()}])},e}(APanel);__reflect(MailWindow.prototype,"MailWindow");var MailWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.MailWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.M_DAT_MailList])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Mail]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Mail:FacadeApp.fetchData([CommandList.M_NET_Mail,"&oper=3&page=1&pageSize=30"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_MailList,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(MailWindowMediator.prototype,"MailWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var MarshallingLine=function(t){function e(){var e=t.call(this)||this;return e._card=null,e._isCreat=!1,e._type=null,e.skinName="resource/game_skins/marshalling/MarshallingBlockSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._group.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnClick,this),this._isCreat=!0,this.UpData(this._card,this._type)},e.prototype.UpData=function(t,e){return void 0===e&&(e=null),t?(this._card=t,this._type=e,this._iconIma.source=this._card.Prototype.HeadRes,this._toudi.source=this.getRtypeRes(this._card.Ad),void(this._touzuo.source=this.getTypeRes(this._card.Ad))):(this._iconIma.source="",this._toudi.source=this.getRtypeRes(1),void(this._touzuo.source=""))},e.prototype._OnClick=function(t){1==this._type?this._OnQuitClick():0==this._type&&this._OnStateClick()},e.prototype._OnStateClick=function(){SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=7&id="+this.Card.ID+"&gid="+this.MarshallingID],[function(t){FacadeApp.Notify(CommandList.M_CMD_Change_Marshalling),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(2034==t.code?"角色牌必须少于4张":FacadeApp._errorCodeSet[t.code])}])},e.prototype._OnQuitClick=function(){SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=8&id="+this.Card.ID+"&gid="+this.MarshallingID],[function(t){FacadeApp.Notify(CommandList.M_CMD_Change_Marshalling),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),this.UpData(this._card,this._type)},Object.defineProperty(e.prototype,"Card",{get:function(){return this._card},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MarshallingID",{get:function(){return MarshallingWindow.inst(MarshallingWindow).MarshallingID},enumerable:!0,configurable:!0}),e.prototype.getRtypeRes=function(t){switch(t){case 1:return"shenmo_toudi_dixian_png";case 2:return"shenmo_toudi_jinxian_png";case 3:return"shenmo_toudi_sanxian_png";case 4:return"shenmo_toudi_tianxian_png";case 5:return"shenmo_toudi_zhenxian_png"}},e.prototype.getTypeRes=function(t){switch(t){case 1:return"shenmo_xian_dixian_png";case 2:return"shenmo_xian_jinxian_png";case 3:return"shenmo_xian_sanxian_png";case 4:return"shenmo_xian_tianxian_png";case 5:return"shenmo_xian_zhenxian_png"}},e}(eui.Component);__reflect(MarshallingLine.prototype,"MarshallingLine");var MarshallingWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/marshalling/MarshallingWindowSkins.exml")||this;return e._marshaSet=[],e._allCardSet=[],e._kazuNum=0,e._emeyId=null,FacadeApp.inst.removeMediator(ViewerName.MarshallingWindowMediator),FacadeApp.inst.registerMediator(new MarshallingWindowMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._tgtzButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnTGTZClick,this),this._firstButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._firstClick,this),this._secondButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._secondClick,this),this._thirdButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._thirdClick,this)},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Marshalling)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var e,i,n,a,o,r,s,n,n,a,n;return __generator(this,function(c){for(t.prototype.Render.call(this),this._firstButton.selected=1==this.MarshallingID?!0:!1,this._secondButton.selected=2==this.MarshallingID?!0:!1,this._thirdButton.selected=3==this.MarshallingID?!0:!1,e=FacadeApp.read(CommandList.Re_CardtInfo).marshallingList,i=e[this.MarshallingID],n=0;10>n;n++)this._marshaSet[n]||(a=new MarshallingLine,this._marshallinGroup.addChild(a),this._marshaSet[n]=a,this._marshaSet[n].x=Math.floor(n%5)*a.width-7,this._marshaSet[n].y=Math.floor(n/5)*a.height+15),this._marshaSet[n].UpData(CardManager.GetCardByID(i[n]),1);for(o=FacadeApp.read(CommandList.Re_CardtInfo).list,r=Object.keys(o).filter(function(t){if("1"==t)return!1;for(var e=0;e<i.length;e++)if(t==i[e])return!1;return!0}),s=[],n=0;n<r.length;n++)CardManager.fromData(o[r[n]]).Lv>0&&s.push(CardManager.fromData(o[r[n]]));for(n=0;n<s.length;n++)this._allCardSet[n]||(a=new MarshallingLine,this._cardGroup.addChild(a),this._allCardSet[n]=a,this._allCardSet[n].x=Math.floor(n%5)*a.width-7,this._allCardSet[n].y=Math.floor(n/5)*a.height),this._allCardSet[n].UpData(s[n],0);if(this._allCardSet.length>s.length)for(n=this._allCardSet.length-1;n>s.length-1;n--)this._cardGroup.removeChild(this._allCardSet[n]),this._allCardSet.splice(n,1);return[2]})})},e.prototype.show=function(t){this._emeyId=t,this._tgtzButton.visible=t?!0:!1},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._firstClick=function(t){SoundManager.PlayButtonMusic(),e._marshallingID=1,FacadeApp.Notify(CommandList.M_CMD_Change_Marshalling)},e.prototype._secondClick=function(t){SoundManager.PlayButtonMusic(),e._marshallingID=2,FacadeApp.Notify(CommandList.M_CMD_Change_Marshalling)},e.prototype._thirdClick=function(t){SoundManager.PlayButtonMusic(),e._marshallingID=3,FacadeApp.Notify(CommandList.M_CMD_Change_Marshalling)},e.prototype._OnTGTZClick=function(t){var e=this;SoundManager.PlayCloseWinMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=6&openid="+this._emeyId+"&gid="+this.MarshallingID],[function(t){t.code!=FacadeApp.SuccessCode?UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):(PVPManager.PVPFightManager.GetInstance()._PVPFightControlSet=t.data.operation,e.UnRegister(),FacadeApp.Notify(CommandList.M_CMD_ShowPVPFightWindow))}])},Object.defineProperty(e.prototype,"MarshallingID",{get:function(){return e._marshallingID},set:function(t){e._marshallingID=t},enumerable:!0,configurable:!0}),e.GetMarshallingID=function(){return this._marshallingID},e}(APanel);MarshallingWindow._marshallingID=1,__reflect(MarshallingWindow.prototype,"MarshallingWindow");var MarshallingWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.MarshallingWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.M_DAT_CardList,CommandList.M_DAT_MarshallingList])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Marshalling,CommandList.M_CMD_Change_Marshalling]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Marshalling:case CommandList.M_CMD_Change_Marshalling:FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=9"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_MarshallingList,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=1"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_MarshallingList,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(MarshallingWindowMediator.prototype,"MarshallingWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var PetCurOutLine=function(t){function e(){var e=t.call(this)||this;return e._petSkillArr=[],e._curSkillNum=-1,e._ifShenjiAni=!1,e._isCreat=!1,e.skinName="resource/game_skins/pet/PetCurOutListSkins.exml",e}return __extends(e,t),e.prototype.update=function(t){return this._pet=PetManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._scroller.horizontalScrollBar.autoVisibility=!1,this._scroller.horizontalScrollBar.visible=!1,this._scroller.horizontalScrollBar.touchEnabled=!1,this._scroller.touchEnabled=!1,this._scroller.touchChildren=!1,this._upButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUpLevelClick,this),this._petImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnImageClick,this),this._isCreat=!0,this.Render()},e.prototype.Render=function(){if(this._isCreat&&this._pet){this._nameIma.source=this.Pet.NameRes,this._petImage.source=this.Pet.HeadRes,this._levelLabel.text="Lv."+this.Pet.Level.toString(),this._gjLabel.text=Digit.fromObject(this.Pet.ori.b).ShowToString;var t=this.Pet.UpLVMoney(PetWindow.curUpLevel);this._upMoneyNumString=t.ShowToString;var e=Digit.fromObject(this.Pet.ori.bn).Sub(Digit.fromObject(this.Pet.ori.b)).SetUpNum(PetWindow.curUpLevel).ShowToString;this._addGJNumString="+"+e,this._upButton.updateShow(0,[this._upMoneyNumString,this._addGJNumString]),this.oriSkill()}},e.prototype._OnUpLevelClick=function(t){var e=this;FacadeApp.read(CommandList.Re_Status).TestMoney(Digit.fromObject(this._pet.ori.m),!0)&&FacadeApp.fetchData([CommandList.M_NET_PetNum,"&oper=2","&pm="+PetWindow.curUpLevel],[function(t){t.code==FacadeApp.SuccessCode?(SoundManager.PlayLvupMusic(),e._curSkillNum=e.Pet.Level,FacadeApp.dispatchAction(CommandList.M_DAT_PetList,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),FacadeApp.dispatchAction(CommandList.M_AT_STATUS_Power,t.data.power),FacadeApp.dispatchAction(CommandList.M_DAT_Status_PowerClick,t.data.powerClick),e._ifShenjiAni=!0,FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data)
}])):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype.oriSkill=function(){if(this._petSkillArr=[this._skill1,this._skill2,this._skill3],this.judgeLevelSkill(),this._ifShenjiAni){var t=this.Pet.Level-this._curSkillNum;this._curSkillNum>=10?(t>=25||this._curSkillNum%25+t>=25)&&(this._scroller.viewport.scrollH=0,this.creatSkillAni()):(t>=10||this._curSkillNum%25+t>=10)&&(this._scroller.viewport.scrollH=0,this.creatSkillAni()),this._ifShenjiAni=!1,this._curSkillNum=this.Pet.Level}else this.Pet.Level>=25?this._scroller.viewport.scrollH=70:this._scroller.viewport.scrollH=0},e.prototype.judgeLevelSkill=function(){for(var t=[11,26,50,75,100,125,150,175,200,1e3],e=this.Pet.Level-this.Pet.Level%1e3,i=this.Pet.Level-this.Pet.Level%25,n=0;n<t.length;n++){if(this.Pet.Level<t[n]){0==n?(this._petSkillArr[0].updataPetShow(t[n]-1,this.Pet._skillIDSet[n],this.Pet),this._petSkillArr[1].updataPetShow(t[n+1]-1,this.Pet._skillIDSet[n+1],this.Pet),this._petSkillArr[2].updataPetShow(t[n+2],this.Pet._skillIDSet[n+2],this.Pet)):1==n?(this._petSkillArr[0].updataPetShow(t[n-1]-1,this.Pet._skillIDSet[n-1],this.Pet),this._petSkillArr[1].updataPetShow(t[n]-1,this.Pet._skillIDSet[n],this.Pet),this._petSkillArr[2].updataPetShow(t[n+1],this.Pet._skillIDSet[n+1],this.Pet)):0!=n&&1!=n&&8>=n?(this._petSkillArr[0].updataPetShow(t[n-2],this.Pet._skillIDSet[n-2],this.Pet),this._petSkillArr[1].updataPetShow(t[n-1],this.Pet._skillIDSet[n-1],this.Pet),this.Pet.Level%1e3+25<1e3?this._petSkillArr[2].updataPetShow(i+25,this.Pet._skillIDSet[8],this.Pet):this._petSkillArr[2].updataPetShow(i+25,this.Pet._skillIDSet[9],this.Pet)):(this._petSkillArr[0].updataPetShow(i-25,this.Pet._skillIDSet[8],this.Pet),this._petSkillArr[1].updataPetShow(i,this.Pet._skillIDSet[8],this.Pet),this.Pet.Level%1e3+25<1e3?this._petSkillArr[2].updataPetShow(i+25,this.Pet._skillIDSet[8],this.Pet):this._petSkillArr[2].updataPetShow(i+25,this.Pet._skillIDSet[9],this.Pet));break}this.Pet.Level%1e3<25?(this._petSkillArr[0].updataPetShow(e-25,this.Pet._skillIDSet[8],this.Pet),this._petSkillArr[1].updataPetShow(e,this.Pet._skillIDSet[9],this.Pet),this._petSkillArr[2].updataPetShow(e+25,this.Pet._skillIDSet[8],this.Pet)):(this._petSkillArr[0].updataPetShow(i-25,this.Pet._skillIDSet[8],this.Pet),this._petSkillArr[1].updataPetShow(i,this.Pet._skillIDSet[8],this.Pet),this.Pet.Level%1e3+25<1e3?this._petSkillArr[2].updataPetShow(i+25,this.Pet._skillIDSet[8],this.Pet):this._petSkillArr[2].updataPetShow(i+25,this.Pet._skillIDSet[9],this.Pet))}},e.prototype.creatSkillAni=function(){var t=this,e=[this._skill1,this._skill2,this._skill3];MovieManage.GetDragonBonesMovie("shengji_tx",function(i){var n=i;t._group.addChild(n.display),t.Pet.Level>=25?(n.display.x=e[1].x+e[1].width/2,n.display.y=e[1].y+e[1].height/2,egret.Tween.removeTweens(t._scroller.viewport),t._scroller.viewport.scrollH=0,egret.Tween.get(t._scroller.viewport).to({scrollH:70},1e3)):(n.display.x=e[0].x+e[0].width/2,n.display.y=e[0].y+e[0].height/2),n.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){this._group.removeChild(n.display)},t),n.animation.gotoAndPlay("shengji_tx")},this)},e.prototype.creatAni=function(t){var e=new eui.BitmapLabel;e.font="upZLNum_fnt",e.text=t,this.addChild(e),e.y=80,e.x=this.width/2,egret.Tween.get(e).to({y:0,alpha:0},2e3)},Object.defineProperty(e.prototype,"Pet",{get:function(){return this._pet},enumerable:!0,configurable:!0}),e.prototype._OnImageClick=function(t){UIPage.inst(UIPage).ShowPetDetail(this.Pet)},e}(eui.Component);__reflect(PetCurOutLine.prototype,"PetCurOutLine");var PetDetail=function(t){function e(){var e=t.call(this,"resource/game_skins/pet/PetDetailSkins.exml")||this;return e._geniusSet=[],e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._leftButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnLeftClick,this),this._rightButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRightClick,this),this._knowButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnKnowClick,this),this.RegisterDataSourceFunction()},e.prototype.ComponentDidMount=function(){},e.prototype.RegisterDataSourceFunction=function(){this.RegisterDataSource([CommandList.M_DAT_PetList])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.ShowPet(this._pet),[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnLeftClick=function(t){var e=PetManager.GetPetByID(this._pet.ID-1);null!=e?this.ShowPet(e):console.log("宠物为空"+this._pet.ID)},e.prototype._OnRightClick=function(t){var e=PetManager.GetPetByID(this._pet.ID+1);null!=e?this.ShowPet(e):console.log("宠物为空"+this._pet.ID)},e.prototype._OnKnowClick=function(t){this._OnCloseClick(null)},e.prototype.ShowPet=function(t){var e=this;if(null!=t){this._pet=t,RES.getResAsync(t.QSRes,function(t){e._petImage.texture=t},this),RES.getResAsync(t.NameRes,function(t){e._nameIma.texture=t},this),this._levelLabel.text="Lv."+FacadeApp.read(CommandList.Re_PetInfo).PetLevel.toString(),this._pet.IsGet||(this._levelLabel.text="Lv.0"),this._battleImage.visible=t.IsFighting,this._UpdateButton(),1==this._pet.ID?this._petGetTypeLabel.text="初始赠送":this._petGetTypeLabel.text="商店购买";for(var i=0,n=0;n<this._pet.Genius.length+1;n++){if(!this._geniusSet[n]){var a=new PetGeniusLine;this._geniusGroup.addChild(a),this._geniusSet.push(a)}0==n?this._geniusSet[n].upDataShow(0,this._pet.Description):this._geniusSet[n].upDataShow(parseInt(this._pet.Genius[n-1])),this._geniusSet[n].y=i,i+=this._geniusSet[n].height+15}if(this._pet.Genius.length<this._geniusSet.length-1)for(var o=this._geniusSet.length-1-this._pet.Genius.length,n=0;o>n;n++)this._geniusGroup.removeChild(this._geniusSet[this._geniusSet.length-1]),this._geniusSet.splice(this._geniusSet.length-1,1)}},e.prototype._UpdateButton=function(){var t=this._pet.ID;this._leftButton.visible=t>1?!0:!1,this._rightButton.visible=7>t?!0:!1},e}(APanel);__reflect(PetDetail.prototype,"PetDetail");var PetGeniusLine=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.upDataShow=function(t,e){void 0===e&&(e=null),null==this._iconIma&&(this._iconIma=new eui.Image,this.addChild(this._iconIma),this._iconIma.width=30,this._iconIma.height=30),null==this._descLabel&&(this._descLabel=new eui.Label,this.addChild(this._descLabel),this._descLabel.width=418,this._descLabel.x=40,this._descLabel.fontFamily="KaiTi",this._descLabel.size=22,this._descLabel.stroke=2.5,this._descLabel.strokeColor=0),0==t?(this._iconIma.visible=!1,this._descLabel.text=e):(this._iconIma.visible=!0,this._descLabel.text=e,ConfigStaticManager.getItem(ConfigTypeName.PetGenius,t).iconRes&&(this._iconIma.source=ConfigStaticManager.getItem(ConfigTypeName.PetGenius,t).iconRes+"_png"),this._descLabel.text=ConfigStaticManager.getItem(ConfigTypeName.PetGenius,t).desc)},e}(eui.Component);__reflect(PetGeniusLine.prototype,"PetGeniusLine");var PetLine=function(t){function e(){var e=t.call(this)||this;return e._isCreat=!1,e.skinName="resource/game_skins/pet/PetListSkins.exml",e}return __extends(e,t),e.prototype.update=function(t){return this._pet=PetManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._battleButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBattleClick,this),this._petImage.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnImageClick,this),this._isCreat=!0,this.Render()},e.prototype.Render=function(){this._isCreat&&this._pet&&(this._nameIma.source=this.Pet.NameRes,this._petImage.source=this.Pet.HeadRes,this._battleButton.visible=this.Pet.IsGet,this._battleButton.enabled=!this.Pet.IsFighting,this._unLockLabel.visible=!this.Pet.IsGet,this._gjcsLabel.text=this.Pet.AutoTimes.toString()+"次")},e.prototype._OnBattleClick=function(t){this.Pet.IsGet&&FacadeApp.fetchData([CommandList.M_NET_PetNum,"&oper=3&pm=0&id="+this.Pet.ID],[function(t){return FacadeApp.dispatchAction(CommandList.M_DAT_PetList,t.data),FacadeApp.dispatchAction(CommandList.M_CMD_Change_Pet),t.code!=FacadeApp.SuccessCode?void UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):void FacadeApp.fetchData([CommandList.M_NET_SkillNum,"&oper=1&aid=1&pm=1"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_EFFECTS,t.data.effects)}])}])},Object.defineProperty(e.prototype,"Pet",{get:function(){return this._pet},enumerable:!0,configurable:!0}),e.prototype._OnImageClick=function(t){UIPage.inst(UIPage).ShowPetDetail(this.Pet)},e}(eui.Component);__reflect(PetLine.prototype,"PetLine");var PetWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/pet/PetWindowSkins.exml")||this;return e._curUpLevelNum=1,e._lineSet=[],FacadeApp.inst.removeMediator(ViewerName.PetWindowMediator),FacadeApp.inst.registerMediator(new PetWindowMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._totalGJLabel.rotation=8,this._petList.height=250,this._upLevelLabel.touchEnabled=!1,this.y=GameConfigOfRuntime.gameHeight,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._upOrDownButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._UpOrDownPanel,this),this._upLevelButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._UpLevelClick,this)},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UiOpened_Pet)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var e,i,n,a;return __generator(this,function(o){for(t.prototype.Render.call(this),e=FacadeApp.read(CommandList.Re_PetInfo).list,i=Object.keys(e).filter(function(t){return e[t].i==FacadeApp.read(CommandList.Re_PetInfo).active?!1:!0}),n=0;n<i.length+1;n++)this._lineSet[n]||(a=null,a=0==n?new PetCurOutLine:new PetLine,this._petGroup.addChild(a),this._lineSet[n]=a,this._lineSet[n].y=n*a.height),0==n?this._lineSet[n].update(FacadeApp.read(CommandList.Re_PetInfo).FightingPetInfo):this._lineSet[n].update(e[i[n-1]]);return this._zsLine.y=125*this._lineSet.length,this._totalGJLabel.text=Digit.fromObject(FacadeApp.read(CommandList.Re_Status).powerClick).ShowToString,[2]})})},e.prototype._UpLevelClick=function(t){this._curUpLevelNum+=1,1==this._curUpLevelNum?(this._upLevelLabel.text="X1",e.curUpLevel=1):2==this._curUpLevelNum?(this._upLevelLabel.text="X25",e.curUpLevel=25):3==this._curUpLevelNum?(this._upLevelLabel.text="X100",e.curUpLevel=100):4==this._curUpLevelNum?(this._upLevelLabel.text="X1000",e.curUpLevel=1e3):5==this._curUpLevelNum&&(this._curUpLevelNum=1,this._upLevelLabel.text="X1",e.curUpLevel=1),this.Render()},e.prototype._OnCloseClick=function(t){this.CloseWindow()},e.prototype._UpOrDownPanel=function(){SoundManager.PlayButtonMusic(),t.prototype._UpOrDown.call(this,this._upOrDownButton.selected,this._petList)},e}(APanel);PetWindow.curUpLevel=1,__reflect(PetWindow.prototype,"PetWindow");var PetWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.PetWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.M_DAT_PetList,CommandList.M_DAT_Status_PowerClick])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Pet]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Pet:FacadeApp.fetchData([CommandList.M_NET_PetNum,"&oper=1&pm=0&id=0"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_PetList,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),2==FacadeApp.read(CommandList.Re_Status).guideId&&GuideWindow.inst(GuideWindow).GuideFinish(FacadeApp.read(CommandList.Re_Status).guideId)}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(PetWindowMediator.prototype,"PetWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var PVPManager;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.TypeList=[],t.soldiers=new Array,t.otherSoldiers=new Array,t.curFightDataSet=[],t.FightDataSet=[],t.eachFightDataSet=[],t.combooNum=0,t._fightPosiSet=[null,null,null,null,null,null,null,null,null],t._uid=null,FacadeApp.AddListener(CommandList.PVP_HIT_ROLE,t.addHitEvent.bind(t),t),FacadeApp.AddListener(CommandList.PVP_CheckAttackData,function(){t.StartCheckFight()},t),t}return __extends(i,e),i.prototype.rebuild=function(e){var i=this;this.TypeList=e,this.TypeList.map(function(e){var n=t.SoldierFactory.inst.newSildier(e);return n.site=e.site,i.soldiers.push(n),n}),this.Register(this)},i.prototype.retreatFun=function(){var t=this;return Promise.all(this.soldiers.map(function(e){return new Promise(function(i,n){e.status.ChangeMove(),egret.Tween.get(e).to({x:-100},1e3).call(function(){i()},t)})}))},i.prototype.goAheadFun=function(){var t=this;return Promise.all(this.soldiers.map(function(e){return new Promise(function(i,n){e.status.ChangeMove(),egret.Tween.get(e).to({x:1e3},1700).call(function(){e.x=GameConfigOfRuntime.roleX,i()},t)})}))},i.prototype.pauseFun=function(){this.soldiers.map(function(t){t.PausePVPFight()})},i.prototype.continuesFun=function(){this.soldiers.map(function(t){t.ContinuePVPFight()})},i.prototype.endFun=function(){this.soldiers.map(function(t){t.EndPVPFight()})},i.prototype.disappearFun=function(){return Promise.all(this.soldiers.map(function(t){return new Promise(function(e,i){t.status.ChangeMove(),t.x=GameConfigOfRuntime.roleX,e()})}))},i.prototype.Framing=function(t,e){},i.prototype.StartCheckFight=function(){if(null==this.FightDataSet[0]&&t.PVPFightManager.GetInstance().JudgeAniEventByIndex(t.PVPFightManager.GetInstance()._PVPFightControlSet[t.PVPFightManager.GetInstance()._PVPFightControlSet.length-1].PreCondition)&&"end"!=t.PVPFightManager.GetInstance().status.current)return console.log("整个战场结束!~"),void t.PVPFightManager.GetInstance().status.ChangeEnd();for(var e=0;e<this.eachFightDataSet.length;e++)if(this.eachFightDataSet[e].length>0)if(0==this.eachFightDataSet[e][0].PreCondition)this.judgeAniEvent(this.eachFightDataSet[e][0].params.site,this.eachFightDataSet[e][0]);else if(t.PVPFightManager.GetInstance().JudgeAniEventByIndex(this.eachFightDataSet[e][0].PreCondition))this.judgeAniEvent(this.eachFightDataSet[e][0].params.site,this.eachFightDataSet[e][0]);else{var i=this.curPosiSoldier(this.eachFightDataSet[e][0].params.site);i&&(i.status.ChangeWait(),this.curFightDataSet[this.eachFightDataSet[e][0].params.site]=null)}},i.prototype.judgeAniEvent=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,a,o,r,s,c,l,u,h,p,d=this;return __generator(this,function(_){switch(_.label){case 0:return t.PVPFightManager.GetInstance().status.current!=t.FightStatusList.running&&i.type!=t.OperationType.Enter?(this.curFightDataSet[e]=null,[2]):this.curFightDataSet[e]==i?[2]:(this.curFightDataSet[e]=i,n=e,a=this.curPosiSoldier(n),null==a?(this.curFightDataSet[n]=null,console.log("找不到形象"),[2]):i.type!=t.OperationType.Enter?[3,4]:(a._pvpRoleLifeBar&&(a._pvpRoleLifeBar.visible=!1),a.status.ChangeMove(),o=1,a._uid==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(o=2),r=t.ArmyOfPosiSet[o][n].x,s=t.ArmyOfPosiSet[o][n].y,a._roleid==t.AllRoleId.wukong?[3,2]:(a.visible=!1,a.x=r,a.y=s,[4,t.PVPArmatureManager.CreatHitEffectAni(a,t.RoleAttackAniGroupNames.CommAttack_JinChang)])));case 1:return c=_.sent(),l=null,l=t.ArmyRoleResNameSet[a._roleid]?t.ArmyRoleResNameSet[a._roleid].enterRes:t.ArmyRoleResNameSet[0].enterRes,u=new eui.Image(RES.getRes(l)),this.addChild(u),u.x=r-u.width/2,u.y=s-u.height,u.visible=!1,egret.Tween.get(u).wait(400).call(function(){a.visible=!0,u.visible=!0}).to({alpha:0},500).call(function(){d.removeChild(u),a._pvpRoleLifeBar&&(a._pvpRoleLifeBar.visible=!0),i.params.value&&a._pvpRoleLifeBar&&a._pvpRoleLifeBar.upData(i.params.value),a.status.ChangeWait(),d.removeFightData(n)}),[3,3];case 2:egret.Tween.get(a).to({x:r,y:s},500).call(function(){a._pvpRoleLifeBar&&(a._pvpRoleLifeBar.visible=!0),i.params.value&&a._pvpRoleLifeBar&&a._pvpRoleLifeBar.upData(i.params.value),a.status.ChangeWait(),1!=a._roleid?d.removeFightData(n):d.removeFightData(n,!1)}),_.label=3;case 3:return[3,5];case 4:i.type==t.OperationType.Skill?0==i.params.state?a.status.current!=t.SoldierStatusList.attackBefore&&a.status.ChangeReadyAttack(i.params.type):1==i.params.state?(t.SkillType.isZhaoHuanSkill(i.params.type)&&(h=i.params.sim,h.map(function(e){var i=e[0]==t.PVPFightManager.GetInstance().armyOfMine._uid?t.SoldierType.pvpMinePet:t.SoldierType.pvpEnemyPet,n=e[0]==t.PVPFightManager.GetInstance().armyOfMine._uid?t.PVPFightManager.GetInstance().armyOfMine:t.PVPFightManager.GetInstance().armyOfEnemy;n.rebuild([new t.SoldierConfigInfo(i,e[1],e[2],e[0])])})),a.status.current!=t.SoldierStatusList.attacking&&a.status.ChangeAttacking()):3==i.params.state?a.status.current!=t.SoldierStatusList.attackEnd&&a.status.ChangeAttackLater():2==i.params.state&&a.status.ChangeInterrupted():i.type==t.OperationType.AttrChanged?(i.params.value&&a._pvpRoleLifeBar.upData(i.params.value),i.params.type==t.AttrChangedType.Poisoned||i.params.type==t.AttrChangedType.Fire?(this.addHitEvent(null,{aniName:null,site:[a._uid,a._roleid,n],jiduan:1,eventIndex:i.PreCondition}),egret.setTimeout(this.removeFightData,this,500,n)):this.removeFightData(n)):i.type==t.OperationType.BuffChanged?(i.params.count>0?a._pvpRoleLifeBar.creatBuff(i.params.type):a._pvpRoleLifeBar.clearBuff(i.params.type),p=new Object,p.type=i.params.type,p.count=i.params.count,a.status.ChangeEffectChange(p)):i.type==t.OperationType.Alive?(a.status.ChangeWait(),this.removeFightData(n)):i.type==t.OperationType.Dead?(a.status.ChangeDeath(),this.removeFightData(n)):i.type==t.OperationType.Disappear?(this.noRegister(n),this.removeFightData(n)):i.type==t.OperationType.Combo?(this.ShowComboo(i.params.value),this.removeFightData(n)):(console.log("其他：",i.type,a.unitType,n,i.EventIndex),this.removeFightData(n)),_.label=5;case 5:return[2]}})})},i.prototype.curPosiSoldier=function(t){for(var e=0;e<this.soldiers.length;e++)if(this.soldiers[e].site==t)return this.soldiers[e];return null},i.prototype.getHitRoleObject=function(t){return 4==this.eachFightDataSet[t][0].type&&1==this.eachFightDataSet[t][0].params.state?this.eachFightDataSet[t][0].params.sim:4==this.eachFightDataSet[t][0].type&&0==this.eachFightDataSet[t][0].params.state?this.eachFightDataSet[t][1].params.sim:null},i.prototype.addHitEvent=function(e,i){var n=t.PVPFightManager.GetInstance().armyOfEnemy;if(i.site[0]!=n._uid&&(n=t.PVPFightManager.GetInstance().armyOfMine),n==this){var a=i.site[2],o=n.curPosiSoldier(a),r=n.eachFightDataSet[a];if(null!=r&&null!=o)for(var s=r.length-1;s>=0;s--)if(r[s].type==t.OperationType.AttrChanged&&r[s].PreCondition==i.eventIndex+1){var c=o._pvpRoleLifeBar.CurHealth-r[s].params.value.d,l=Math.floor(c/i.jiduan);n.ShowLife(n.curPosiSoldier(a).x-200,n.curPosiSoldier(a).y-200,l,r[s].params.type),o.HitFun(r[s].params.type,i.aniName);break}}},i.prototype.ShowLife=function(t,e,i,n){var a=new PVPNum(n);this.addChildAt(a,0),a.x=t,a.y=e-30,a.scaleX=a.scaleY=.7,0>i?a.number="+"+Math.abs(i):a.number=i;var o=egret.Tween.get(a);Math.random()<.5?o.wait(150).to({x:t-150,y:e-200,alpha:0},500).call(this._RemoveLife,this,[a]):o.wait(150).to({x:t+150,y:e-200,alpha:0},500).call(this._RemoveLife,this,[a])},i.prototype._RemoveLife=function(t){this.removeChild(t)},i.prototype.ShowComboo=function(e){var i=new PVPNum("comboo");this.addChildAt(i,0),i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,t.PVPFightManager.GetInstance().armyOfMine==this?(i.x=t.ArmyOfPosiSet[1][2].x,i.y=t.ArmyOfPosiSet[1][2].y+30):(i.x=t.ArmyOfPosiSet[2][2].x,i.y=t.ArmyOfPosiSet[2][2].y+30),i.scaleX=i.scaleY=1.7,i.number="cx"+e;egret.Tween.get(i).to({scaleX:1,scaleY:1},400).to({alpha:0},300).call(this._RemoveLife,this,[i])},i.prototype.removeFightData=function(e,i){if(void 0===i&&(i=!0),t.PVPFightManager.GetInstance().addAniEventToSet(this.eachFightDataSet[e][0])){for(var n=0;n<this.FightDataSet.length;n++)if(this.FightDataSet[n]==this.eachFightDataSet[e][0]){this.FightDataSet.splice(n,1);break}this.eachFightDataSet[e].splice(0,1)}this.curFightDataSet[e]=null,i&&FacadeApp.dispatchAction(CommandList.PVP_CheckAttackData)},i.prototype.Register=function(t){this.soldiers.map(function(e){t.addChild(e)})},i.prototype.noRegister=function(t){for(var e=0;e<this.soldiers.length;e++)this.soldiers[e].site==t&&(this.removeChild(this.soldiers[e]),this.soldiers.splice(e,1))},i}(egret.DisplayObjectContainer);t.PVPArmy=e,__reflect(e.prototype,"PVPManager.PVPArmy")}(PVPManager||(PVPManager={}));var PVPEndWindow=function(t){function e(){return t.call(this,"resource/game_skins/pvp/PVPEndWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),[2]})})},e.prototype.showPage=function(t){if(t.params.victory){console.log("胜利");var e=!0;e?(this._upRankGroup.visible=!0,this._winEndGroup.visible=!1,this.upAni()):(this._upRankGroup.visible=!1,this._winEndGroup.visible=!0,egret.Tween.removeTweens(this._upIma),this._winEndGroup.anchorOffsetX=this._winEndGroup.width,this._winEndGroup.anchorOffsetY=this._winEndGroup.height,this._winEndGroup.scaleX=0,this._winEndGroup.scaleY=0,egret.Tween.get(this._winEndGroup).to({scaleX:1,scaleY:1},1e3))}else console.log("失败")},e.prototype.upAni=function(){egret.Tween.removeTweens(this._upIma),egret.Tween.get(this._upIma).to({y:80},50).to({y:90},100).to({y:85},50).call(this.upAni)},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister(),PVPManager.PVPFightManager.GetInstance().EndPVPFight(),FacadeApp.fetchData([CommandList.M_NET_RankNum,"&oper=2"],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.dispatchAction(CommandList.RANK_GET_LIST2,t.data):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e}(APanel);__reflect(PVPEndWindow.prototype,"PVPEndWindow");var PVPManager;!function(t){var e=0,i=1e3;t.OperationType={Start:e++,Enter:e++,Dead:e++,Alive:e++,Skill:e++,BuffChanged:e++,AttrChanged:e++,Notify:e++,Combo:e++,ComboReady:e++,Effect:e++,Disappear:e++,End:i};var n=0;t.AttrChangedType={Miss:n++,Parry:n++,Bang:n++,Damage:n++,Reflect:n++,Encourage:n++,Recover:n++,Depression:n++,Absorb:n++,EXSkill:n++,SelfHurt:n++,Poisoned:n++,Fire:n++,Length:n++,ShouJiRes:function(e){switch(e){case t.RoleAttackAniGroupNames.WuKong_SanMeiZhenHuo:case t.RoleAttackAniGroupNames.CommAttack_LiuXingHuo:return{isCreat:!0,type:"dra",res:"pvp_sanmei_di",aniName:"pvp_sanmei_di",desc:"火焰爆破效果",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_HuiFu:return{isCreat:!0,type:"dra",res:"buff_blood",aniName:"buff_before",desc:"恢复效果",parX:0,parY:-50,zhenping:!1};case t.RoleAttackAniGroupNames.ZJB_NormalAttack1:return{isCreat:!0,type:"ima",res:"pvp-hit_png",aniName:null,desc:"紫金钵攻击的受击效果",parX:0,parY:-50,zhenping:!1};case t.RoleAttackAniGroupNames.CommAttack_DaDuan:return{isCreat:!0,type:"mov",res:"effect_lightningrods",aniName:"effect_lightningrods",desc:"打断技能",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_JinChang:return{isCreat:!0,type:"mov",res:"effect_call",aniName:"effect_call",desc:"进场特效",parX:0,parY:0,zhenping:!1};case t.RoleAttackAniGroupNames.WuKong_NormalAttack1:case t.RoleAttackAniGroupNames.WuKong_NormalAttack2:case t.RoleAttackAniGroupNames.WuKong_NormalAttack3:return{isCreat:!0,type:"mov",res:"effect_gethit",aniName:"effect_gethit",desc:"悟空普攻",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_LeiTing:return{isCreat:!0,type:"mov",res:"effect_gethit",aniName:"effect_gethit",desc:"雷霆一击",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_ShaBao:return{isCreat:!0,type:"mov",res:"effect_gethit",aniName:"effect_gethit",desc:"沙暴",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.WuKong_BaJiaoShan:return{isCreat:!1,type:"mov",res:"effect_manyhit",aniName:"effect_manyhit",desc:"芭蕉扇，多次攻击",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_zijinling:return{isCreat:!1,type:"mov",res:"effect_manyhit",aniName:"effect_manyhit",desc:"紫金玲",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_yinyangerqiping:return{isCreat:!1,type:"mov",res:"effect_manyhit",aniName:"effect_manyhit",desc:"阴阳二气瓶",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_jinnao:return{isCreat:!1,type:"mov",res:"effect_manyhit",aniName:"effect_manyhit",desc:"金铙",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_zijinhonghulu:return{isCreat:!1,type:"mov",res:"effect_manyhit",aniName:"effect_manyhit",desc:"紫金红葫芦",parX:0,parY:0,zhenping:!0};case t.RoleAttackAniGroupNames.CommAttack_renzhongdai:return{isCreat:!1,type:"mov",res:"effect_manyhit",aniName:"effect_manyhit",desc:"人种袋",parX:0,parY:0,zhenping:!0}}return{isCreat:!1,type:null,res:null,aniName:null,desc:null,parX:0,parY:0,zhenping:!1}}},t.BattleBuffEnum={None:1,Confused:4,Dazed:8,Poisoned:16,UnabledAction:32,PaoXiao:64,Bless:128,Stone:256,JiAng:512,BeDead:1024,DingHai:2048,Illusion:4096,Dead:8192,Fire:16384,WindFury:32768,HuiFu:65536,BingFeng:1<<17,BuffRes:function(e,i){var n=t.ArmyRoleResNameSet[i.toString()];switch(null==n&&(n=t.ArmyRoleResNameSet[0]),e){case t.BattleBuffEnum.Confused:return{res:"buff_hunluan",desc:"混乱",parX:0,parY:-n.Height-70};case t.BattleBuffEnum.Dazed:return{res:"buff_yunxuan",desc:"晕眩",parX:0,parY:-n.Height-30};case t.BattleBuffEnum.Poisoned:return{res:"buff_zhongdu",desc:"中毒",parX:0,parY:0};case t.BattleBuffEnum.UnabledAction:return{res:"buff_jingu",desc:"禁锢",parX:0,parY:0};case t.BattleBuffEnum.PaoXiao:return{res:"buff_chaofeng",desc:"咆哮",parX:50,parY:30};case t.BattleBuffEnum.Stone:return{res:"buff_jianshou",desc:"坚守",parX:40,parY:-20};case t.BattleBuffEnum.Bless:return{res:"buff_shengguang",desc:"圣光",parX:0,parY:0};case t.BattleBuffEnum.JiAng:return{res:"buff_kuangbao",desc:"激昂",parX:0,parY:-70};case t.BattleBuffEnum.BeDead:return{res:"buff_binsi",desc:"濒死",parX:0,parY:-n.Height-30};case t.BattleBuffEnum.Dead:return{res:"buff_die",desc:"死亡",parX:0,parY:0};case t.BattleBuffEnum.Fire:return{res:"buff_ranshao",desc:"燃烧",parX:0,parY:0};case t.BattleBuffEnum.BingFeng:return{res:"buff_bingfeng",desc:"冰封",parX:0,parY:0};case t.BattleBuffEnum.HuiFu:return{res:"buff_blood",desc:"恢复",parX:0,parY:-50}}return console.log("BattleBuffEnum.BingFeng:  ",t.BattleBuffEnum.BingFeng),{res:"buff_binsi",desc:"其他",parX:0,parY:0}}},t.SkillType={Counter:1,Attack:2,Recover:3,Encourage:4,Confuse:6,ConfuseAttack:7,Poison:8,Daze:9,Depression:10,UnableAction:11,PaoXiao:12,JianCi:13,Bless:14,Blood:15,Alive:16,Stone:17,Illusion:18,XueZhou:19,BloodRecover:20,GodBless:21,YongWu:30,BuQu:31,JiAng:32,XianJi:34,QuSan:35,LiZhi:37,DongCha:38,BaJiao:39,DingHai:40,AntiWind:41,BeDead:42,IncreaseAttack:43,IncreaseAttackAll:44,RealFire:45,AntiFire:46,RealWater:47,AntiWater:48,Unity:49,DecreaseFee:50,DecreaseFeeAll:51,Enchant:52,AttachBaJiao:53,Study:54,Insight:55,IncAtkOnRecovered:56,Comboo:57,DieGoGo:58,LiuXingHuo:59,LeiTing:60,ShaBao:61,ZiJinLing:75,YingYang:76,JinNao:77,Zijinhonghulu:79,HuangJinShen:80,RenZhongdai:81,YangLiuJingPing:82,BaoLianDeng:83,JinLangJiaSha:84,WuCaiXiaYi:85,BoLeBoLuoMi:86,Summon1:101,Summon2:102,Summon3:103,Summon4:104,Summon5:105,Summon6:106,Summon7:107,Summon8:108,Summon9:109,Summon10:110,Summon14:204,isZhaoHuanSkill:function(e){switch(parseInt(e)){case t.SkillType.Summon1:case t.SkillType.Summon2:case t.SkillType.Summon3:case t.SkillType.Summon4:case t.SkillType.Summon5:case t.SkillType.Summon6:case t.SkillType.Summon7:case t.SkillType.Summon8:case t.SkillType.Summon9:case t.SkillType.Summon10:case t.SkillType.Summon14:return!0}return!1},getSkillName:function(e,i){switch(parseInt(e)){case t.SkillType.Summon1:case t.SkillType.Summon2:case t.SkillType.Summon3:case t.SkillType.Summon4:case t.SkillType.Summon5:case t.SkillType.Summon6:case t.SkillType.Summon7:case t.SkillType.Summon8:case t.SkillType.Summon9:case t.SkillType.Summon10:case t.SkillType.Summon14:if(i==t.AllRoleId.wukong)return[t.RoleAttackAniGroupNames.WuKong_ZhaoHuan];case t.SkillType.Attack:return i==t.AllRoleId.wukong?[t.RoleAttackAniGroupNames.WuKong_NormalAttack1,t.RoleAttackAniGroupNames.WuKong_NormalAttack2,t.RoleAttackAniGroupNames.WuKong_NormalAttack3]:i==t.AllRoleId.baiguj||i==t.AllRoleId.other?[t.RoleAttackAniGroupNames.BGJ_NormalAttack1]:[t.RoleAttackAniGroupNames.ZJB_NormalAttack1];case t.SkillType.BaJiao:if(i==t.AllRoleId.wukong)return[t.RoleAttackAniGroupNames.WuKong_BaJiaoShan];case t.SkillType.DingHai:if(i==t.AllRoleId.wukong)return[t.RoleAttackAniGroupNames.WuKong_JinGangChu];case t.SkillType.Encourage:case t.SkillType.Insight:case t.SkillType.PaoXiao:case t.SkillType.Bless:case t.SkillType.JiAng:case t.SkillType.Stone:return[t.RoleAttackAniGroupNames.CommAttack_BuffAttack];case t.SkillType.Recover:return[t.RoleAttackAniGroupNames.CommAttack_HuiFu];case t.SkillType.RealFire:if(i==t.AllRoleId.wukong)return[t.RoleAttackAniGroupNames.WuKong_SanMeiZhenHuo];case t.SkillType.Comboo:if(i==t.AllRoleId.wukong)return[t.RoleAttackAniGroupNames.WuKong_Comboo];case t.SkillType.DieGoGo:if(i==t.AllRoleId.wukong)return[t.RoleAttackAniGroupNames.WuKong_QianChong];case t.SkillType.LiuXingHuo:return[t.RoleAttackAniGroupNames.CommAttack_LiuXingHuo];case t.SkillType.LeiTing:return[t.RoleAttackAniGroupNames.CommAttack_LeiTing];case t.SkillType.ShaBao:return[t.RoleAttackAniGroupNames.CommAttack_ShaBao];case t.SkillType.YingYang:return[t.RoleAttackAniGroupNames.CommAttack_yinyangerqiping];case t.SkillType.ZiJinLing:return[t.RoleAttackAniGroupNames.CommAttack_zijinling];case t.SkillType.RenZhongdai:return[t.RoleAttackAniGroupNames.CommAttack_renzhongdai];case t.SkillType.JinNao:return[t.RoleAttackAniGroupNames.CommAttack_jinnao];case t.SkillType.Zijinhonghulu:return[t.RoleAttackAniGroupNames.CommAttack_zijinhonghulu];case t.SkillType.JinLangJiaSha:return[t.RoleAttackAniGroupNames.CommAttack_jinrangjiasha];case t.SkillType.WuCaiXiaYi:return[t.RoleAttackAniGroupNames.CommAttack_wucaixiayi];case t.SkillType.HuangJinShen:return[t.RoleAttackAniGroupNames.CommAttack_huangjinshen];case t.SkillType.BoLeBoLuoMi:return[t.RoleAttackAniGroupNames.CommAttack_boreboluomi];case t.SkillType.YangLiuJingPing:return[t.RoleAttackAniGroupNames.CommAttack_yangliujingping];case t.SkillType.BaoLianDeng:return[t.RoleAttackAniGroupNames.CommAttack_baoliandeng]}return i==t.AllRoleId.wukong?[t.RoleAttackAniGroupNames.WuKong_ZhaoHuan]:i==t.AllRoleId.baiguj||i==t.AllRoleId.other?[t.RoleAttackAniGroupNames.BGJ_NormalAttack1]:[t.RoleAttackAniGroupNames.ZJB_NormalAttack1]}},t.RoleAttackAniGroupNames={WuKong_NormalAttack1:"WuKong_NormalAttack1",WuKong_NormalAttack2:"WuKong_NormalAttack2",WuKong_NormalAttack3:"WuKong_NormalAttack3",WuKong_BaJiaoShan:"WuKong_BaJiaoShan",WuKong_JinGangChu:"WuKong_JinGangChu",WuKong_SanMeiZhenHuo:"WuKong_SanMeiZhenHuo",WuKong_QianChong:"WuKong_QianChong",WuKong_Comboo:"WuKong_Comboo",WuKong_ZhaoHuan:"WuKong_ZhaoHuan",BGJ_NormalAttack1:"BGJ_NormalAttack1",ZJB_NormalAttack1:"ZJB_NormalAttack1",CommAttack_HuiFu:"CommAttack_HuiFu",CommAttack_BuffAttack:"CommAttack_BuffAttack",CommAttack_LiuXingHuo:"CommAttack_LiuXingHuo",CommAttack_LeiTing:"CommAttack_LeiTing",CommAttack_ShaBao:"CommAttack_ShaBao",CommAttack_yinyangerqiping:"CommAttack_yinyangerqiping",CommAttack_zijinling:"CommAttack_zijinling",CommAttack_renzhongdai:"CommAttack_renzhongdai",CommAttack_wucaixiayi:"CommAttack_wucaixiayi",CommAttack_huangjinshen:"CommAttack_huangjinshen",CommAttack_jinrangjiasha:"CommAttack_jinrangjiasha",CommAttack_boreboluomi:"CommAttack_boreboluomi",CommAttack_yangliujingping:"CommAttack_yangliujingping",CommAttack_baoliandeng:"CommAttack_baoliandeng",CommAttack_jinnao:"CommAttack_jinnao",CommAttack_zijinhonghulu:"CommAttack_zijinhonghulu",CommAttack_DaDuan:"CommAttack_DaDuan",CommAttack_JinChang:"CommAttack_JinChang",AttackCount:11,Common_NormalAttack1:"Common_NormalAttack1",Common_NormalAttack2:"Common_NormalAttack2",getHitNum:function(e){switch(e){case t.RoleAttackAniGroupNames.WuKong_NormalAttack2:return 2;
case t.RoleAttackAniGroupNames.WuKong_NormalAttack3:return 3;case t.RoleAttackAniGroupNames.WuKong_BaJiaoShan:return 2;case t.RoleAttackAniGroupNames.CommAttack_yinyangerqiping:return 2}return 1},isMove:function(e,i){switch(e){case t.RoleAttackAniGroupNames.Common_NormalAttack1:case t.RoleAttackAniGroupNames.WuKong_NormalAttack1:case t.RoleAttackAniGroupNames.WuKong_NormalAttack2:case t.RoleAttackAniGroupNames.WuKong_NormalAttack3:if(i==t.SoldierStatusList.attackBefore)return!0;case t.RoleAttackAniGroupNames.WuKong_QianChong:if(i==t.SoldierStatusList.attacking)return!0}return!1},isEmeryPosi:function(e){switch(e){case t.RoleAttackAniGroupNames.WuKong_Comboo:case t.RoleAttackAniGroupNames.CommAttack_LiuXingHuo:case t.RoleAttackAniGroupNames.CommAttack_LeiTing:case t.RoleAttackAniGroupNames.WuKong_NormalAttack1:case t.RoleAttackAniGroupNames.WuKong_NormalAttack2:case t.RoleAttackAniGroupNames.WuKong_NormalAttack3:case t.RoleAttackAniGroupNames.CommAttack_huangjinshen:case t.RoleAttackAniGroupNames.CommAttack_yangliujingping:case t.RoleAttackAniGroupNames.CommAttack_jinrangjiasha:case t.RoleAttackAniGroupNames.CommAttack_wucaixiayi:return!0}return!1},skillMoveAni:function(e,i,n){switch(e){case t.RoleAttackAniGroupNames.WuKong_BaJiaoShan:if(i==t.SoldierStatusList.attacking)return{isMove:!0,deviation:[0,0],tweenType:t.SkillAniType.bajiaoshan,speed:10,isMulti:!0,isHit:!1};case t.RoleAttackAniGroupNames.WuKong_Comboo:if(i==t.SoldierStatusList.attacking&&0==n)return{isMove:!0,deviation:[0,0],tweenType:t.SkillAniType.wukongComboo,speed:.5,isMulti:!0,isHit:!1};case t.RoleAttackAniGroupNames.CommAttack_HuiFu:if(i==t.SoldierStatusList.attacking)return{isMove:!0,deviation:[0,-30],tweenType:t.SkillAniType.huifu,speed:2,isMulti:!1,isHit:!0};case t.RoleAttackAniGroupNames.CommAttack_BuffAttack:if(i==t.SoldierStatusList.attacking)return{isMove:!0,deviation:[0,-50],tweenType:t.SkillAniType.dunwu,speed:10,isMulti:!1,isHit:!1};case t.RoleAttackAniGroupNames.ZJB_NormalAttack1:if(i==t.SoldierStatusList.attacking)return{isMove:!0,deviation:[0,0],tweenType:t.SkillAniType.paodan,speed:2,isMulti:!1,isHit:!0};case t.RoleAttackAniGroupNames.BGJ_NormalAttack1:if(i==t.SoldierStatusList.attacking)return{isMove:!0,deviation:[25,-50],tweenType:t.SkillAniType.normal,speed:1,isMulti:!1,isHit:!0}}return{isMove:!1,deviation:[0,0],tweenType:null,speed:0,isMulti:!1,isHit:!1}}},t.ArmyRoleResNameSet={0:{res:"pvp_baigujing",enterRes:"pvp_baigujing_png",Width:175.25,Height:192.65,scaleX:1,scaleY:1,desc:"其他",ansOffX:0,ansOffY:100},1:{res:"pvp_wukong",enterRes:"pvp_baigujing_png",Width:125.9,Height:164,desc:"悟空",scaleX:1,scaleY:1,ansOffX:0,ansOffY:-29.04},2:{res:"pvp_taozi",enterRes:"pvp_taozi_png",Width:147.85,Height:105.45,desc:"桃子",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},3:{res:"pvp_xiejiang",enterRes:"pvp_xiejiang_png",Width:147.85,Height:105.45,desc:"蟹将",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},4:{res:"pvp_tongnv",enterRes:"pvp_tongnv_png",Width:147.85,Height:105.45,desc:"童女",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},5:{res:"pvp_heixiongjing",enterRes:"pvp_heixiongjing_png",Width:147.85,Height:105.45,desc:"黑熊精",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},6:{res:"pvp_baigujing",enterRes:"pvp_baigujing_png",Width:175.25,Height:192.65,desc:"白骨精",scaleX:1,scaleY:1,ansOffX:0,ansOffY:100},7:{res:"pvp_benboba",enterRes:"pvp_benboba_png",Width:147.85,Height:105.45,desc:"奔波儿灞",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},8:{res:"pvp_nazha",enterRes:"pvp_nazha_png",Width:147.85,Height:105.45,desc:"哪吒",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},9:{res:"pvp_zijinbo",enterRes:"pvp_zijinbo_png",Width:147.85,Height:105.45,desc:"紫金钵",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50},10:{res:"pvp_tangseng",enterRes:"pvp_tangseng_png",Width:147.85,Height:105.45,desc:"唐僧",scaleX:1,scaleY:1,ansOffX:0,ansOffY:50}},t.AllRoleId={other:0,wukong:1,taozi:2,xiejiang:3,tongnv:4,heixiong:5,baiguj:6,benboba:7,ezha:8,zijinbo:9,tangseng:10,length:11},t.ArmyOfPosiSet={1:{0:{x:102,y:320},1:{x:102,y:460},2:{x:102,y:639},3:{x:223,y:320},4:{x:223,y:460},5:{x:223,y:639},6:{x:223,y:320},7:{x:223,y:460},8:{x:223,y:639}},2:{0:{x:550,y:320},1:{x:550,y:460},2:{x:550,y:639},3:{x:431,y:320},4:{x:431,y:460},5:{x:431,y:639},6:{x:223,y:320},7:{x:223,y:460},8:{x:223,y:639}}},t.SkillAniType={normal:0,paodan:1,huifu:2,dunwu:3,bajiaoshan:4,wukongComboo:5}}(PVPManager||(PVPManager={}));var PVPManager;!function(t){t.FightStatusList={noready:"noready",countDown:"countDown",running:"running",pause:"pause",end:"end"};var e=function(e){function i(t){var i=e.call(this)||this;return i.animationNameSet=new Object,i._countdownArmature=null,i._PVPFightControlSet=[],i._haveFightControlSet=[],i.createStatusMachine(t),FacadeApp.AddListener(CommandList.PVP_StartComeIn,function(){i.status.ChangeCountDown()}),i}return __extends(i,e),i.GetInstance=function(){return i._instance||(i._instance=new i(t.FightStatusList.noready)),i._instance},i.prototype.createStatusMachine=function(e){var i=this;this.status=StateMachine.create({initial:{state:e,event:"initialize"},events:[{name:"ChangeCountDown",from:"*",to:t.FightStatusList.countDown},{name:"ChangeStart",from:t.FightStatusList.countDown,to:t.FightStatusList.running},{name:"ChangePause",from:t.FightStatusList.running,to:t.FightStatusList.pause},{name:"ChangeContinue",from:t.FightStatusList.pause,to:t.FightStatusList.running},{name:"ChangeEnd",from:t.FightStatusList.running,to:t.FightStatusList.end}],callbacks:{oncountDown:function(t,e,n){i._countdownArmature||(i.creatCountDown(),FacadeApp.dispatchAction(CommandList.PVP_CheckAttackData))},onrunning:function(e,n,a){n==t.FightStatusList.pause&&(i.armyOfMine.continuesFun(),i.armyOfEnemy.continuesFun(),console.log("继续")),FacadeApp.dispatchAction(CommandList.PVP_CheckAttackData)},onpause:function(t,e,n){BG.GetInstance2().RemoveTween(),i.armyOfMine.pauseFun(),i.armyOfEnemy.pauseFun(),console.log("暂停")},onend:function(t,e,n){null==PVPEndWindow.inst(PVPEndWindow).parent&&(BG.GetInstance2().RemoveTween(),i.ChangeTollgate(),console.log("结算"))}},error:function(t,e,i,n,a,o){return"event "+t+": "+o}})},i.prototype.loadData=function(){var e=this;this._haveFightControlSet=[];var n=new egret.URLLoader,a=new egret.URLRequest;a.url="resource/config/skillarmcfg.json",n.load(a),n.addEventListener(egret.Event.COMPLETE,function(t){e.animationNameSet=JSON.parse(t.target.data)},this),i.TIMESCALE=1,this.armyOfMine||(this.armyOfMine=new t.PVPArmy),this.addChild(this.armyOfMine),this.armyOfEnemy||(this.armyOfEnemy=new t.PVPArmy),this.addChild(this.armyOfEnemy),this.FenJieFightJson();var o=this.armyOfMine.FightDataSet[0].params.uid,r=this.armyOfMine.FightDataSet[0].params.hid,s=this.armyOfMine.FightDataSet[0].params.site;this.armyOfMine.rebuild([new t.SoldierConfigInfo(t.SoldierType.pvpMineHero,r,s,o)]),o=this.armyOfEnemy.FightDataSet[0].params.uid,r=this.armyOfEnemy.FightDataSet[0].params.hid,s=this.armyOfEnemy.FightDataSet[0].params.site,this.armyOfEnemy.rebuild([new t.SoldierConfigInfo(t.SoldierType.pvpEnemyHero,r,s,o)]),this.refreshState(!0)},i.prototype.FenJieFightJson=function(){this.armyOfMine.FightDataSet=[],this.armyOfEnemy.FightDataSet=[],this.armyOfMine._uid=this._PVPFightControlSet[0].params.me,this.armyOfEnemy._uid=this._PVPFightControlSet[0].params.enemy;for(var t=1;t<this._PVPFightControlSet.length;t++)this._PVPFightControlSet[t].params.uid==this.armyOfMine._uid?this.armyOfMine.FightDataSet.push(this._PVPFightControlSet[t]):this._PVPFightControlSet[t].params.uid==this.armyOfEnemy._uid&&this.armyOfEnemy.FightDataSet.push(this._PVPFightControlSet[t]);for(var t=0;9>t;t++)this.armyOfMine.eachFightDataSet[t]=[],this.armyOfEnemy.eachFightDataSet[t]=[];for(var t=0;t<this.armyOfMine.FightDataSet.length;t++)this.armyOfMine.eachFightDataSet[this.armyOfMine.FightDataSet[t].params.site].push(this.armyOfMine.FightDataSet[t]);for(var t=0;t<this.armyOfEnemy.FightDataSet.length;t++)this.armyOfEnemy.eachFightDataSet[this.armyOfEnemy.FightDataSet[t].params.site].push(this.armyOfEnemy.FightDataSet[t]);console.log("敌方流程",this.armyOfEnemy.FightDataSet,this.armyOfEnemy.eachFightDataSet),console.log("我方流程",this.armyOfMine.FightDataSet,this.armyOfMine.eachFightDataSet)},i.prototype.refreshState=function(t){return void 0===t&&(t=!1),__awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){return e=FacadeApp.read(CommandList.Re_Status),t?[2]:[2]})})},i.prototype.creatCountDown=function(){return __awaiter(this,void 0,void 0,function(){var t,e=this;return __generator(this,function(i){switch(i.label){case 0:return this.status.ChangePause(),this._countdownArmature?[3,2]:(this._countdownArmature=new dragonBones.Armature,t=this,[4,MovieManage.PromisifyGetDragonBonesMovie("countdown",this)]);case 1:t._countdownArmature=i.sent(),this._countdownArmature.display.x=320,this._countdownArmature.display.y=400,this._countdownArmature.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){e._countdownArmature.animation.stop(),e.removeChild(e._countdownArmature.display),e.status.ChangeStart()},this),i.label=2;case 2:return this.addChild(this._countdownArmature.display),this._countdownArmature.animation.gotoAndPlay("start"),[2]}})})},i.prototype.ChangeTollgate=function(){this.armyOfMine.FightDataSet=[],this.armyOfEnemy.FightDataSet=[],PVPEndWindow.inst(PVPEndWindow).Register(this,!1).ShowWindow(this._PVPFightControlSet[this._PVPFightControlSet.length-1])},i.prototype.EndPVPFight=function(){this._countdownArmature=null,this.armyOfMine.endFun(),this.removeChild(this.armyOfMine),this.armyOfMine=null,SoldierManage.FightManager.GetInstance().status["continue"](),this.armyOfEnemy.endFun(),this.removeChild(this.armyOfEnemy),this.armyOfEnemy=null,SoldierManage.FightManager.GetInstance().status["continue"](),FacadeApp.dispatchAction(CommandList.PVP_RemoveFightWindow)},i.prototype.addAniEventToSet=function(t){return t?this.JudgeAniEventByIndex(t.PreCondition)?(-1==this._haveFightControlSet.indexOf(t)&&this._haveFightControlSet.push(t),!0):!1:(console.log(t),!1)},i.prototype.JudgeAniEventByIndex=function(t){if(0==t)return!0;for(var e=this._haveFightControlSet.length-1;e>=0;e--)if(t==this._haveFightControlSet[e].EventIndex)return!0;return!1},i.prototype.curAniEventIndex=function(){return this._haveFightControlSet[this._haveFightControlSet.length-1].EventIndex},i.prototype.EndFight=function(){i.GetInstance().status.ChangeEnd()},i.prototype.PauseFight=function(){i.GetInstance().status.ChangePause()},i.prototype.ContinueFight=function(){i.GetInstance().status.ChangeContinue()},i}(egret.DisplayObjectContainer);e.TIMESCALE=1,t.PVPFightManager=e,__reflect(e.prototype,"PVPManager.PVPFightManager")}(PVPManager||(PVPManager={}));var PVPNum=function(t){function e(e){var i=t.call(this)||this;return i.skinName="resource/game_skins/pvp/PVPNumSkins.exml",i._lifeBitmapLabel.visible=!0,i._missIma.visible=!1,e==PVPManager.AttrChangedType.Damage?i._lifeBitmapLabel.font="lifenumber_fnt":e==PVPManager.AttrChangedType.Bang?i._lifeBitmapLabel.font="petLifeNumber_fnt":e==PVPManager.AttrChangedType.Recover?i._lifeBitmapLabel.font="huifulifenum_fnt":e==PVPManager.AttrChangedType.Miss?(i._lifeBitmapLabel.visible=!1,i._missIma.visible=!0):"comboo"==e?i._lifeBitmapLabel.font="pvpcomboo_fnt":i._lifeBitmapLabel.font="lifenumber_fnt",i}return __extends(e,t),Object.defineProperty(e.prototype,"number",{set:function(t){this._lifeBitmapLabel.text=t},enumerable:!0,configurable:!0}),e}(eui.Component);__reflect(PVPNum.prototype,"PVPNum",["eui.UIComponent","egret.DisplayObject"]);var PVPManager;!function(t){var e=function(e){function i(i,n,a,o){var r=e.call(this)||this;r._curEventIndex=[],r._isWaitMove=!1,r.unitType=i,r._uid=o,r._direction=r._uid==t.PVPFightManager.GetInstance().armyOfMine._uid?1:-1,r._isMineArmy=r._uid==t.PVPFightManager.GetInstance().armyOfMine._uid?!0:!1,r._roleid=a,r.site=n,r._isMineArmy?r.x=GameConfigOfRuntime.roleX:r.x=640-GameConfigOfRuntime.roleX;var s=1;return r._isMineArmy||(s=2),r._posiXYSet=t.ArmyOfPosiSet[s],r.y=r._posiXYSet[n].y,r.createArmature(),r}return __extends(i,e),i.prototype.onReady=function(t,e,i){},i.prototype.onnoReady=function(t,e,i){},i.prototype.onMove=function(t,e,i){this.PlayRoleAnimation("move",0)},i.prototype.onReadyAttack=function(e,i,n,a){this.AttackAniGroupName=t.PVPArmatureManager.RandomAttack(this._roleid,a),this._AttackBefor(a)},i.prototype.onAttacking=function(t,e,i,n){this._Attacking()},i.prototype.onAttackLater=function(t,e,i,n){this._AttackLater()},i.prototype.onDeath=function(t,e,i){this.PlayRoleAnimation("stand",0)},i.prototype.onWait=function(t,e,i){this._Wait()},i.prototype.onInterrupted=function(t,e,i){this._Interrupted()},i.prototype.onSeeThrough=function(t,e,i){this._SeeThrough()},i.prototype.onEffectChange=function(t,e,i,n){this._EffectChange(n)},i.prototype._AttackBefor=function(e){var i=this;egret.Tween.removeTweens(this),this.x=this._posiXYSet[this.site].x,this.y=this._posiXYSet[this.site].y,this.rotation=0,this.curAniGroup=t.PVPFightManager.GetInstance().animationNameSet[this.AttackAniGroupName].before,this.curAniIndex=0,this.PlayRoleSkillAniFun();var n=this.Army.getHitRoleObject(this.site),a=[this._posiXYSet[this.site].x,this._posiXYSet[this.site].y];if(n&&t.RoleAttackAniGroupNames.isMove(this.AttackAniGroupName,this.status.current)){var o=1;n[0][0]==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(o=2),a=[t.ArmyOfPosiSet[o][n[0][2]].x-100*this._direction,t.ArmyOfPosiSet[o][n[0][2]].y]}if(this.x!=a[0]||this.y!=a[1]){this.RoleTweenComplete=!1;var r=egret.Tween.get(this);r.to({x:a[0],y:a[1]},400/t.PVPFightManager.TIMESCALE).call(function(){i.RoleTweenComplete=!0,i.judgeAndClearCurFightData()},this)}this._isWaitMove=!1},i.prototype._Attacking=function(){var e=this;this.curAniGroup=t.PVPFightManager.GetInstance().animationNameSet[this.AttackAniGroupName].attacking,this.curAniIndex=0,this._roleArmature.animation.timeScale=FacadeApp.Calc(effectEnum.HeroAttackSpeed,1),this.PlayRoleSkillAniFun();var i=1==this._uid?2:1,n=this.Army.getHitRoleObject(this.site);if(this.AttackAniGroupName==t.RoleAttackAniGroupNames.WuKong_Comboo){egret.Tween.removeTweens(this),BG.GetInstance2().Move(250,200/t.PVPFightManager.TIMESCALE),this.RoleTweenComplete=!0;var a=1;n[0][0]==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(a=2),this.x=t.ArmyOfPosiSet[a][2].x-100*this._direction}if(this.AttackAniGroupName==t.RoleAttackAniGroupNames.WuKong_QianChong){egret.Tween.removeTweens(this);var o=egret.Tween.get(this);if(this.RoleTweenComplete=!1,n){var a=1;n[0][0]==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(a=2),o.to({x:t.ArmyOfPosiSet[a][n[0][2]].x+50*this._direction},200/t.PVPFightManager.TIMESCALE).call(function(){e.RoleTweenComplete=!0,e.judgeAndClearCurFightData()},this)}else{var a=1;i==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(a=2),o.to({x:t.ArmyOfPosiSet[a][this.site].x+50*this._direction},200/t.PVPFightManager.TIMESCALE).call(function(){e.RoleTweenComplete=!0,e.judgeAndClearCurFightData()},this)}}},i.prototype._AttackLater=function(){var e=this;this.curAniGroup=t.PVPFightManager.GetInstance().animationNameSet[this.AttackAniGroupName].later,this.curAniIndex=0,this.PlayRoleSkillAniFun(),this.RoleTweenComplete=!1;var i=this._posiXYSet[this.site],n=egret.Tween.get(this);n.to({x:i.x,y:i.y},300/t.PVPFightManager.TIMESCALE).call(function(){e.RoleTweenComplete=!0,e.judgeAndClearCurFightData()},this)},i.prototype._Wait=function(){this.randMove(),this.PlayRoleAnimation("move",0)},i.prototype.randMove=function(){var e=this;if(this.y==this._posiXYSet[this.site].y&&Math.abs(this.x-this._posiXYSet[this.site].x)<=50&&0==this._isWaitMove&&this.RoleTweenComplete&&this.status.current==t.SoldierStatusList.wait){this._isWaitMove=!0;var i=10*Math.random()+10,n=Math.floor(1*Math.random());if(i=0==n?-i:i,this.x!=this._posiXYSet[this.site].x){var a=Math.abs(this.x-this._posiXYSet[this.site].x);egret.Tween.get(this).to({x:this._posiXYSet[this.site].x},20*a).call(function(){e._isWaitMove=!1,e.randMove},this)}else{var a=Math.abs(this.x-this._posiXYSet[this.site].x+i);egret.Tween.get(this).to({x:this._posiXYSet[this.site].x+i},20*a).call(function(){e._isWaitMove=!1,e.randMove},this)}}},i.prototype._Interrupted=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return[4,t.PVPArmatureManager.CreatHitEffectAni(this,t.RoleAttackAniGroupNames.CommAttack_DaDuan)];case 1:return e=i.sent(),this.PlayRoleAnimation("hit1",1),[2]}})})},i.prototype._SeeThrough=function(){this.PlayRoleAnimation("move",1)},i.prototype._EffectChange=function(e){return __awaiter(this,void 0,void 0,function(){var i,n,a,o,r;return __generator(this,function(s){switch(s.label){case 0:for(i=!1,n=!1,a=0;a<this._buffArmaSet.length;a++)this._buffArmaSet[a].type==e.type&&(i=!0,e.count<=0&&i&&(this._buffArmaSet[a].curAnimationName="buff_later",this._buffArmaSet[a].animation.gotoAndPlay("buff_later",-1,-1,1))),this._buffArmaSet[a].type==t.BattleBuffEnum.Dead&&(n=!0);return e.type==t.BattleBuffEnum.Dead&&(n=!0),n?this._roleArmature.display.visible=!1:this._roleArmature.display.visible=!0,e.count>0&&0==i?(r=(o=this._buffArmaSet).push,[4,t.PVPArmatureManager.createBuffEffect(this,e.type)]):[3,3];case 1:return[4,r.apply(o,[s.sent()])];case 2:s.sent(),s.label=3;case 3:return[2]}})})},i}(t.PVPSoldier);t.PVPRole=e,__reflect(e.prototype,"PVPManager.PVPRole")}(PVPManager||(PVPManager={}));var PVPRoleLife=function(t){function e(){var e=t.call(this)||this;return e._buffImaSet=[],e._curHealth=0,e._curShiQi=0,e.skinName="resource/game_skins/pvp/PVPRoleLifeSkins.exml",e}return __extends(e,t),e.prototype.upData=function(t){this._curHealth=t.d;var e=t.dm;t.a;this._curShiQi=t.h,0!=this._curHealth?egret.Tween.get(this._healthIma).to({width:this.CurHealth/e*this.MaxHealthWidth},100):this._healthIma.width=this.CurHealth/e*this.MaxHealthWidth,this._damgeLabel.text=this.CurHealth.toString(),egret.Tween.get(this._shiqiIma).to({width:this._curShiQi/100*this.MaxHealthWidth},100)},e.prototype.creatBuff=function(t){var e=new eui.Image;t==PVPManager.BattleBuffEnum.Poisoned?e.source="buff_zhongdu_png":e.source="buff_gongjijian_png",this.addChild(e),e.y=this._bg.y+this._bg.height+3,e.type=t,this._buffImaSet.length>0?e.x=this._buffImaSet[this._buffImaSet.length-1].x+e.width+1:e.x=1},e.prototype.upDataBuffPosi=function(){for(var t=0;t<this._buffImaSet.length;t++)this._buffImaSet[t].x=1+t*(this._buffImaSet[t].width+1)},e.prototype.clearBuff=function(t){for(var e=0;e<this._buffImaSet.length;e++)this._buffImaSet[e].type==t&&this._buffImaSet.splice(e,1);this.upDataBuffPosi()},Object.defineProperty(e.prototype,"CurHealth",{get:function(){return this._curHealth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CurShiQi",{get:function(){return this._curShiQi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"MaxHealthWidth",{get:function(){return 105},enumerable:!0,configurable:!0}),e}(eui.ProgressBar);__reflect(PVPRoleLife.prototype,"PVPRoleLife",["eui.UIComponent","egret.DisplayObject"]);var PVPRolePhysics=function(){function t(){this._factor=100,this._multiple=1.4,this._minY=0,this._CreateWorld(),this._CreateGround(),this._CreateBody()}return t.prototype._CreateWorld=function(){this._world=new p2.World({gravity:[0,-10*this._multiple]})},t.prototype._CreateGround=function(){var t=new p2.Plane;this._gBody=new p2.Body({position:[0,0]}),this._gBody.addShape(t),this._world.addBody(this._gBody)},t.prototype._CreateBody=function(){var t=new p2.Box({width:1,height:1});this._roleBody=new p2.Body({mass:1,position:[0,.5]}),this._roleBody.fixedX=!0,this._roleBody.addShape(t),this._roleBody.updateAABB(),this._roleBody.updateMassProperties(),this._world.addBody(this._roleBody)},t.prototype._CreateBody2=function(){var t=new p2.Box({width:1,height:1});this._roleBody2=new p2.Body({mass:1,position:[250,.5]}),this._roleBody2.fixedX=!0,this._roleBody2.addShape(t),this._roleBody2.updateAABB(),this._roleBody2.updateMassProperties(),this._world.addBody(this._roleBody2)},t.prototype._Process=function(t){this._world.step(t/1e3)},t.prototype.Jump=function(t){this._roleBody.velocity=[t*this._multiple,0]},t.prototype.Move=function(t){this._roleBody.velocity=[t*this._multiple,0]},Object.defineProperty(t.prototype,"RoleX",{get:function(){var t=Math.floor(-this._roleBody.position[0]*this._factor+this._factor/2);return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RoleX2",{get:function(){var t=Math.floor(-this._roleBody2.position[0]*this._factor+this._factor/2);return t},enumerable:!0,configurable:!0}),t.prototype.InitRole=function(){this._roleBody.position[1]=.5,this._roleBody.updateMassProperties()},t}();__reflect(PVPRolePhysics.prototype,"PVPRolePhysics");var PVPManager;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.CreatHitEffectAni=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,a,o,r,s;return __generator(this,function(c){switch(c.label){case 0:return n=null,a=null,o=t.AttrChangedType.ShouJiRes(i),"dra"!=o.type?[3,2]:[4,MovieManage.PromisifyGetDragonBonesMovie(o.res,e)];case 1:return n=c.sent(),a=n.display,n.animation.gotoAndPlay(o.aniName,-1,-1,1),n.animation.timeScale=t.PVPFightManager.TIMESCALE,[3,6];case 2:return"mov"!=o.type?[3,4]:(n=new egret.MovieClip,r=n,[4,MovieManage.GetMovieClipData(o.res+"_json",o.res+"_png",o.aniName)]);case 3:return r.movieClipData=c.sent(),a=n,n.play(1),n.frameRate=n.frameRate/t.PVPFightManager.TIMESCALE,[3,6];case 4:return"ima"!=o.type?[3,6]:[4,ObjectPool.getPool("eui.Image").borrowObject()];case 5:n=c.sent(),n.texture=RES.getRes(o.res),a=n,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,c.label=6;case 6:return a.type=o.type,i==t.RoleAttackAniGroupNames.CommAttack_JinChang?(e.Army.addChild(a),s=1,e._isMineArmy||(s=2),a.x=t.ArmyOfPosiSet[s][e.site].x,a.y=t.ArmyOfPosiSet[s][e.site].y-e.RoleHeight/2):(e.addChild(a),a.x=0+o.parX*e._direction,a.y=0+o.parY),"dra"==a.type?n.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(t){n.display.parent&&n.display.parent.removeChild(n.display);for(var i=0;i<e._hitAniSet.length;i++)e._hitAniSet[i]==n&&e._hitAniSet.splice(i,1)},e):"mov"==a.type?n.addEventListener(egret.Event.COMPLETE,function(t){n.parent&&n.parent.removeChild(n);for(var i=0;i<e._hitAniSet.length;i++)e._hitAniSet[i]==n&&e._hitAniSet.splice(i,1)},e):i==t.RoleAttackAniGroupNames.ZJB_NormalAttack1&&egret.Tween.get(n).wait(300/t.PVPFightManager.TIMESCALE).call(function(){n.parent&&n.parent.removeChild(n);for(var t=e._hitAniSet.length-1;t>=0;t--)e._hitAniSet[t]==n&&e._hitAniSet.splice(t,1)}),o.zhenping&&FacadeApp.dispatchAction(CommandList.M_CMD_ZhenPing),[2,n]}})})},i.createBuffEffect=function(e,i){return __awaiter(this,void 0,void 0,function(){var n,a;return __generator(this,function(o){switch(o.label){case 0:return n=t.BattleBuffEnum.BuffRes(i,e._roleid),[4,MovieManage.PromisifyGetDragonBonesMovie(n.res,e)];case 1:return a=o.sent(),e.addChild(a.display),a.curAnimationName="buff_before",a.animation.gotoAndPlay("buff_before",-1,-1,1),a.type=i,a.display.scaleX=1,a.display.scaleY=1,a.display.scaleX*=e._direction,a.animation.timeScale=t.PVPFightManager.TIMESCALE,a.display.x=0+n.parX*e._direction,a.display.y=0+n.parY,a.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){if("buff_before"==a.curAnimationName&&(a.curAnimationName="buff_playing",a.animation.gotoAndPlay("buff_playing",-1,-1,0),e.judgeAndClearCurFightData()),"buff_later"==a.curAnimationName){for(var t=e._buffArmaSet.length-1;t>=0;t--)e._buffArmaSet[t]==a&&(MovieManage.RemoveArmature(a),a.display.parent&&(console.log(a),a.display.parent.removeChild(a.display)),e._buffArmaSet.splice(t,1));e.judgeAndClearCurFightData()}},e),[2,a]}})})},i.RandomAttack=function(e,i){var n=[];n=t.SkillType.getSkillName(i,e);var a=Math.floor(n.length*Math.random());return n[a]},i.creatSkillArmaRes=function(e,i,n,a,o){return __awaiter(this,void 0,void 0,function(){var r,s,c,l,u,h,p,d,_,m,g;return __generator(this,function(f){switch(f.label){case 0:return r=i.res,s=e._isMineArmy?1:-1,c=i.oriXY[0]*s,l=i.oriXY[1],u=null,h=null,"dra"!=n?[3,2]:[4,MovieManage.PromisifyGetDragonBonesMovie(r,e)];case 1:return u=f.sent(),h=u.display,u.animation.gotoAndPlay(i.aniName,-1,-1,1),u.animation.timeScale=t.PVPFightManager.TIMESCALE,[3,5];case 2:return"mov"!=n?[3,4]:(u=new egret.MovieClip,p=u,[4,MovieManage.GetMovieClipData(r+"_json",r+"_png",i.aniName)]);case 3:return p.movieClipData=f.sent(),h=u,u.play(1),u.frameRate=u.frameRate/t.PVPFightManager.TIMESCALE,[3,5];case 4:"ima"==n?(u=new eui.Image,u.texture=RES.getRes(r[0]),h=u,console.log(h.height,h.width),h.anchorOffsetY=h.height/2,h.anchorOffsetX=h.width/2):"par"==n&&(u=new particle.GravityParticleSystem(RES.getRes(r[0]+"_png"),RES.getRes(r[0]+"_json")),u.start(),h=u),f.label=5;case 5:return h.aniName=i.aniName,u.isClear=i.isClear,u.type=n,u.hitData=a,u.curAniIndex=o,u.aniData=i,t.PVPFightManager.GetInstance().addChild(h),d=1,e._isMineArmy||(d=2),_=t.ArmyOfPosiSet[d][e.site],h.x=_.x+c,h.y=_.y+l,e.status.current==t.SoldierStatusList.attacking&&t.RoleAttackAniGroupNames.isEmeryPosi(e.AttackAniGroupName)&&(m=1,a[0]==t.PVPFightManager.GetInstance().armyOfEnemy._uid&&(m=2),"ima"==n&&(h.scaleX=.3,h.scaleY=.3),g=t.ArmyOfPosiSet[m][2],i.isMulti||(g=t.ArmyOfPosiSet[m][a[2]]),h.x=g.x+c,h.y=g.y+l,1==m&&(e.AttackAniGroupName==t.RoleAttackAniGroupNames.CommAttack_huangjinshen&&2==o&&(h.scaleX*=s),e.AttackAniGroupName==t.RoleAttackAniGroupNames.CommAttack_wucaixiayi&&2==o&&(h.scaleX*=s,h.x=g.x+c))),i.isMulti&&(h.scaleX*=s),"dra"==n?u.addEventListener(dragonBones.AnimationEvent.COMPLETE,e.SkillArmatureCompleteFun,e):"mov"==n&&u.addEventListener(egret.Event.COMPLETE,e.SkillMovieClipCompleteFun,e),[2,u]}})})},i}(egret.Sprite);t.PVPArmatureManager=e,__reflect(e.prototype,"PVPManager.PVPArmatureManager")}(PVPManager||(PVPManager={}));var ControllerPrepCommand=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.execute=function(t){(new GameCommand).register()},e}(puremvc.SimpleCommand);__reflect(ControllerPrepCommand.prototype,"ControllerPrepCommand",["puremvc.ICommand","puremvc.INotifier"]);var PVPManager;!function(t){var e=function(){function e(e,i,n,a){this.roleid=0,this.utype=t.SoldierType.pvpMineHero,this.site=2,this.isMineArmy=!1,this.uid=0,this.roleid=i,this.utype=e,this.site=n,this.uid=a,this.isMineArmy=this.uid==t.PVPFightManager.GetInstance().armyOfMine._uid?!0:!1}return e}();t.SoldierConfigInfo=e,__reflect(e.prototype,"PVPManager.SoldierConfigInfo");var i=function(){function e(){}return Object.defineProperty(e,"inst",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!0,configurable:!0}),e.prototype.newSildier=function(e){var i=null;switch(e.utype){case t.SoldierType.pvpMineHero:i=new t.PVPRole(e.utype,e.site,e.roleid,e.uid);break;case t.SoldierType.pvpEnemyHero:i=new t.PVPRole(e.utype,e.site,e.roleid,e.uid);break;case t.SoldierType.pvpMinePet:i=new t.PVPRole(e.utype,e.site,e.roleid,e.uid);break;case t.SoldierType.pvpEnemyPet:i=new t.PVPRole(e.utype,e.site,e.roleid,e.uid);break;default:i=new t.PVPSoldier}return i},e}();t.SoldierFactory=i,__reflect(i.prototype,"PVPManager.SoldierFactory")}(PVPManager||(PVPManager={}));var PVPVSWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/pvp/PVPVSWindow.exml")||this;return e._data=null,e._marshaSet=[],e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._bzButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnBzClick,this)},e.prototype.ComponentDidMount=function(){this._group_up.y=-500,this._group_down.y=400},e.prototype.Show=function(t){var e=this;this._data=t,this._name_1.text=t.name,this._name_2.text="我方名称",this._power_wo.text=FacadeApp.read(CommandList.Re_CardtInfo).power[0],this._rank_di.text=t.rank,FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=10&openid=",t.id],[function(t){t.code!=FacadeApp.SuccessCode?UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):e._power_di.text=t.data.power?t.data.power.toString():"0",e.updataMarshaCard(t)}]),this._rank_wo.text=FacadeApp.read(CommandList.Re_RankInfo).rank2,this.showAni()},e.prototype.updataMarshaCard=function(t){for(var e=0;10>e;e++){if(!this._marshaSet[e]){var i=new MarshallingLine;this._marshaSet[e]=i,this._marshaSet[e].x=Math.floor(e%5)*i.width+15,this._marshaSet[e].y=Math.floor(e/5)*(i.height+20)+110,this.addChild(i)}this._marshaSet[e].UpData(t.data.loc[e]?CardManager.GetCardByID(t.data.loc[e].id):null)}},e.prototype.showAni=function(){this._group_up.y=-500,this._group_down.y=400,egret.Tween.get(this._group_up).to({y:100},300).to({y:-50},100).to({y:0},20),egret.Tween.get(this._group_down).to({y:-100},300).to({y:50},100).to({y:0},20)},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnBzClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister(),FacadeApp.Notify(CommandList.M_CMD_ShowPVPMarshalling,this._data.id)},e}(APanel);__reflect(PVPVSWindow.prototype,"PVPVSWindow");var PVPWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/pvp/PVPWindowSkins.exml")||this;return FacadeApp.inst.removeMediator(ViewerName.PVPWindowMediator),FacadeApp.inst.registerMediator(new PVPWindowMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){var t=this;this.contains(Decoration.GetInstance2())||this.addChildAt(Decoration.GetInstance2(),0),this.contains(BG.GetInstance2())||this.addChildAt(BG.GetInstance2(),0),this.contains(PVPManager.PVPFightManager.GetInstance())||this.addChild(PVPManager.PVPFightManager.GetInstance()),FacadeApp.AddListener(CommandList.PVP_RemoveFightWindow,function(){t.UnRegister()})},e.prototype.ComponentDidMount=function(){},e.prototype.EnterPVPFight=function(){PVPManager.PVPFightManager.GetInstance().loadData(),FacadeApp.dispatchAction(CommandList.PVP_SRART)},e}(APanel);__reflect(PVPWindow.prototype,"PVPWindow");var PVPWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.PVPWindowMediator,e)||this;return i.page._endButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnEndFight,i),i.page._pauseButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._OnPauseFight,i),i.page._jiasuButton.addEventListener(egret.TouchEvent.TOUCH_TAP,i._JisSuFight,i),i}return __extends(e,t),e.prototype._OnEndFight=function(t){PVPManager.PVPFightManager.GetInstance().EndFight()},e.prototype._OnPauseFight=function(t){"running"==PVPManager.PVPFightManager.GetInstance().status.current?PVPManager.PVPFightManager.GetInstance().PauseFight():"pause"==PVPManager.PVPFightManager.GetInstance().status.current&&PVPManager.PVPFightManager.GetInstance().ContinueFight()},e.prototype._JisSuFight=function(t){1==PVPManager.PVPFightManager.TIMESCALE?(PVPManager.PVPFightManager.TIMESCALE=2,FacadeApp.dispatchAction(CommandList.pvp_ChangTimeScale)):(PVPManager.PVPFightManager.TIMESCALE=1,FacadeApp.dispatchAction(CommandList.pvp_ChangTimeScale))},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(PVPWindowMediator.prototype,"PVPWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var RankingWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/RankingWindowSkins.exml")||this;return e._rankArr=[],e._rankDate=[],e._pageNum=0,FacadeApp.inst.removeMediator(ViewerName.RankingWindowMediator),FacadeApp.inst.registerMediator(new RankingWindowMediator(e)),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._guanqiaButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnGuanQiaClick,this),this._jingjiButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnJingJiClick,this),this._gonghuiButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnGongHuiClick,this),this._SetFilter(),this._rank1Chance=!0,this._rank2Chance=!0
},e.prototype.ComponentDidMount=function(){FacadeApp.Notify(CommandList.M_CMD_UIOPENED_RANK_Tab1)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var e,i,n,a,o,r;return __generator(this,function(s){if(t.prototype.Render.call(this),this._guanqiaButton.selected=0==this._pageNum?!0:!1,this._jingjiButton.selected=1==this._pageNum?!0:!1,this._gonghuiButton.selected=2==this._pageNum?!0:!1,this._rankArr.length>0)for(e=0;e<this._rankArr.length;e++)this._rankGroup.removeChild(this._rankArr[e]);switch(this._rankArr=[],i=FacadeApp.read(CommandList.Re_RankInfo),this._pageNum){case 0:this._rankDate=FacadeApp.read(CommandList.Re_RankInfo).list1,this._pmNumLabel.text=i.rank1.toString(),0!=i.rank1&&i.rank1<=100&&this._rank1Chance&&(UIPage.inst(UIPage).ShowPrompt().ShowWindow("恭喜您进入关卡榜前100名！",null,null,!1,null,null,!0),this._rank1Chance=!1);break;case 1:this._rankDate=FacadeApp.read(CommandList.Re_RankInfo).list2.length>0?FacadeApp.read(CommandList.Re_RankInfo).list2:FacadeApp.read(CommandList.Re_RankInfo).list1,this._pmNumLabel.text=i.rank2.toString(),0!=i.rank2&&i.rank2<=100&&this._rank2Chance&&(UIPage.inst(UIPage).ShowPrompt().ShowWindow("恭喜您进入竞技榜前100名！",null,null,!1,null,null,!0),this._rank2Chance=!1);break;case 2:this._rankDate=FacadeApp.read(CommandList.Re_RankInfo).list3,this._pmNumLabel.text=FacadeApp.read(CommandList.Re_RankInfo).rank3.toString()}n=0;for(a in this._rankDate)o=this._rankDate[a],r=new RankList,this._rankGroup.addChild(r),r.y=n,n+=r.height,this._rankArr.push(r),r.SetShow(o,this._pageNum);return this.setScrollBar(),[2]})})},e.prototype._SetFilter=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnGuanQiaClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.Notify(CommandList.M_CMD_UIOPENED_RANK_Tab1)},e.prototype._OnJingJiClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.Notify(CommandList.M_CMD_UIOPENED_RANK_Tab2)},e.prototype._OnGongHuiClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.Notify(CommandList.M_CMD_UIOPENED_RANK_Tab3)},e.prototype.setScrollBar=function(){this._rankList.stopAnimation(),this._rankList.viewport.scrollV=0,this._rankList.bounces=!1,this._rankList.verticalScrollBar.autoVisibility=!1,this._rankList.verticalScrollBar.visible=!1},e}(APanel);__reflect(RankingWindow.prototype,"RankingWindow");var RankingWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.RankingWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.RANK_GET_LIST1,CommandList.RANK_GET_LIST2,CommandList.RANK_GET_LIST3])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UIOPENED_RANK_Tab1,CommandList.M_CMD_UIOPENED_RANK_Tab2,CommandList.M_CMD_UIOPENED_RANK_Tab3]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UIOPENED_RANK_Tab1:this.page._pageNum=0,FacadeApp.fetchData([CommandList.M_NET_RankNum,"&oper=1"],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.dispatchAction(CommandList.RANK_GET_LIST1,t.data):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]);break;case CommandList.M_CMD_UIOPENED_RANK_Tab2:this.page._pageNum=1,FacadeApp.fetchData([CommandList.M_NET_RankNum,"&oper=2"],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.dispatchAction(CommandList.RANK_GET_LIST2,t.data):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]);break;case CommandList.M_CMD_UIOPENED_RANK_Tab3:this.page._pageNum=2,FacadeApp.fetchData([CommandList.M_NET_RankNum,"&oper=3"],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.dispatchAction(CommandList.RANK_GET_LIST3,t.data):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(RankingWindowMediator.prototype,"RankingWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var RankList=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/ui/RankListSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.SetShow=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n,a;return __generator(this,function(o){switch(o.label){case 0:return void 0!=t.rank&&(this._numLabel.text=String(t.rank)),1!=t.rank?[3,2]:(i=this._maxThreeIma,[4,MovieManage.PromisifyGetRes("phb_1_png")]);case 1:return i.texture=o.sent(),[3,7];case 2:return 2!=t.rank?[3,4]:(n=this._maxThreeIma,[4,MovieManage.PromisifyGetRes("phb_2_png")]);case 3:return n.texture=o.sent(),[3,7];case 4:return 3!=t.rank?[3,6]:(a=this._maxThreeIma,[4,MovieManage.PromisifyGetRes("phb_3_png")]);case 5:return a.texture=o.sent(),[3,7];case 6:this._maxThreeIma.visible=!1,o.label=7;case 7:return this._nameLabel.text=t.name,this._guankaLabel.text="积分："+t.score.toString(),1==e&&0==FacadeApp.read(CommandList.Re_RankInfo).list2.length&&(this._guankaLabel.visible=!1),this._data=t,this._tiaozhanBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnTiaozhanClick,this),this._tiaozhanBtn.visible="1"==e?GameConfigOfRuntime.TestUserId==t.id?!1:!0:!1,[2]}})})},e.prototype._OnTiaozhanClick=function(t){var e=this;SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=9"],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_MarshallingList,t.data),t.code!=FacadeApp.SuccessCode?UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):FacadeApp.Notify(CommandList.M_CMD_ShowPVPVS,e._data)}])},e}(eui.Component);__reflect(RankList.prototype,"RankList");var HangUpRewardsWindow=function(t){function e(){return t.call(this,"resource/game_skins/revive/HangUpGetWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanel);__reflect(HangUpRewardsWindow.prototype,"HangUpRewardsWindow");var HangUpingWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/revive/HangUpWindowSkins.exml")||this;return e.continueAni=!1,e.timeObj=null,e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStopClick,this),this._rightNowBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRightNowClick,this)},e.prototype.ComponentDidMount=function(){this.RegisterDataSourceFunction(),FacadeApp.dispatchAction(CommandList.M_CMD_UiOpened_HangUp)},e.prototype.RegisterDataSourceFunction=function(){this.RegisterDataSource([CommandList.M_CMD_UiOpened_HangUp])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n=this;return __generator(this,function(a){return this.dianAni(),t=FacadeApp.read(CommandList.Re_FightInfo).his-10,this._maxLevelLabel.text=t.toString(),this._curLevelLabel.text=FacadeApp.read(CommandList.Re_FightInfo).LEVEL,e=1,i=0,this.timeObj=new ChangeLabelValue(this,function(t){n._timeLabel.text=n.timeObj.getValue(t),n._curLevelLabel.text=FacadeApp.read(CommandList.Re_FightInfo).LEVEL+ ++i/GameConfigOfRuntime.HangupInterval},function(t){n.continueAni&&n._OnRightNowClick(null)}),this.timeObj.setValue("HangUpWindow_Time",(t-FacadeApp.read(CommandList.Re_FightInfo).LEVEL)*GameConfigOfRuntime.HangupInterval),[2]})})},e.prototype.dianAni=function(){var t=this;this.continueAni=!0;var e=setTimeout(function(){t._diIma1.visible=!0,t._diIma2.visible=!1,t._diIma3.visible=!1,e=setTimeout(function(){t._diIma1.visible=!0,t._diIma2.visible=!0,t._diIma3.visible=!1,e=setTimeout(function(){t._diIma1.visible=!0,t._diIma2.visible=!0,t._diIma3.visible=!0,t.continueAni&&t.dianAni()},500)},500)},500)},e.prototype._OnCloseClick=function(t){this.continueAni=!1,this._OnStopClick(t)},e.prototype._OnStopClick=function(t){var e=this;this.continueAni=!1,this.timeObj.destory(),FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=11"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode?(SoundManager.PlayCloseWinMusic(),e.UnRegister(),UIPage.inst(UIPage).ShowHangUpRewardsWindow()):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype._OnRightNowClick=function(t){var e=this;this.continueAni=!1,this.timeObj.destory(),FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=10"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode?(SoundManager.PlayCloseWinMusic(),e.UnRegister(),UIPage.inst(UIPage).ShowHangUpRewardsWindow()):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e}(APanel);__reflect(HangUpingWindow.prototype,"HangUpingWindow");var HangUpTipWindow=function(t){function e(){return t.call(this,"resource/game_skins/revive/HangUpTipWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStartClick,this),this._waitBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this.RegisterDataSourceFunction()},e.prototype.ComponentDidMount=function(){FacadeApp.dispatchAction(CommandList.M_CMD_UiOpened_HangUpTip)},e.prototype.RegisterDataSourceFunction=function(){this.RegisterDataSource([CommandList.M_AT_SyncCheckpoint,CommandList.M_CMD_UiOpened_HangUpTip])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t=FacadeApp.read(CommandList.Re_FightInfo).his-10,this._maxLevelLabel.text=t.toString(),this._timeLabel.text=TimeFormator.ToTimeFormat((t-FacadeApp.read(CommandList.Re_FightInfo).LEVEL)*GameConfigOfRuntime.HangupInterval),[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnStartClick=function(t){FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=9&gateNo&monsterNum"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode?UIPage.inst(UIPage).ShowHangUpingWindow():UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanel);__reflect(HangUpTipWindow.prototype,"HangUpTipWindow");var ReviveTipsWindow=function(t){function e(){return t.call(this,"resource/game_skins/revive/ReviveTipsWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._sureBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this)},e.prototype.ComponentDidMount=function(){},e.prototype.onAccess=function(){t.prototype.onAccess.call(this);var e=FacadeApp.read(CommandList.Re_FightInfo).aStone;this._neidangLabel.text=e.toString(),this._addPetGongJiLabel.text=e/10+"%",this._addRoleGongJiLabel.text=e/10+"%"},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e}(APanel);__reflect(ReviveTipsWindow.prototype,"ReviveTipsWindow");var SeniorReviveWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/revive/SeniorReviveWindowSkins.exml")||this;return e.RegisterDataSourceFunction(),e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._normalBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnNormal,this),this._senoirBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnSenoir,this)},e.prototype.ComponentDidMount=function(){FacadeApp.dispatchAction(CommandList.M_CMD_UiOpened_SeniorRevive)},e.prototype.RegisterDataSourceFunction=function(){this.RegisterDataSource([CommandList.M_AT_SyncCheckpoint,CommandList.M_CMD_UiOpened_SeniorRevive])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this._curReviveNumLabel.text=FacadeApp.read(CommandList.Re_FightInfo).rt+1,this._content.text="今天还可以转生 "+FacadeApp.read(CommandList.Re_FightInfo).rl+" 次",[2]})})},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnNormal=function(t){this.UnRegister(),UIPage.inst(UIPage).ShowZSWindow()},e.prototype._OnSenoir=function(t){UIPage.inst(UIPage).ShowConsumeTipWindow().ShowWindow("确认花费元宝进行高级转生吗?",this.StartSeniorZS.bind(this))},e.prototype.StartSeniorZS=function(){FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=8&gateNo&monsterNum"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode?(SoldierManage.FightManager.GetInstance().readyZS(),UIPage.inst(UIPage).ShowReviveTipsWindow(),e.inst(e).UnRegister(),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data)}]),UIPage.inst(UIPage).updateProperties(),FacadeApp.fetchData([CommandList.M_NET_PetNum],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_PetList,t.data)}])):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e}(APanel);__reflect(SeniorReviveWindow.prototype,"SeniorReviveWindow");var ZSLine=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/game_skins/revive/ZSListSkins.exml",e}return __extends(e,t),e.prototype.createChildren=function(){var e=this;t.prototype.createChildren.call(this),this._zsButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnZSClick,this),FacadeApp.AddListener(CommandList.M_AT_SyncCheckpoint,function(){e.Render()}),this.Render()},e.prototype.Render=function(){this._csLabel.text=FacadeApp.read(CommandList.Re_FightInfo).rl,this._zsButton.enabled=FacadeApp.read(CommandList.Re_FightInfo).rl>0},e.prototype._OnZSClick=function(t){SoundManager.PlayButtonMusic(),UIPage.inst(UIPage).ShowSeniorReviveWindow()},e}(eui.Component);__reflect(ZSLine.prototype,"ZSLine");var ZSWindow=function(t){function e(){return t.call(this,"resource/game_skins/revive/ZSWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._waitZSButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnWaitZSButtonClick,this),this._starZSButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnStarZSButtonClick,this),this._lookButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnLookButtonClick,this)},e.prototype.ComponentDidMount=function(){this.RegisterDataSourceFunction(),FacadeApp.dispatchAction(CommandList.M_CMD_UiOpened_ZS)},e.prototype.RegisterDataSourceFunction=function(){this.RegisterDataSource([CommandList.M_AT_SyncCheckpoint,CommandList.M_DAT_PetList,CommandList.M_CMD_UiOpened_ZS])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){return t=FacadeApp.read(CommandList.Re_Status),this._zsNumLabel.text=FacadeApp.read(CommandList.Re_FightInfo).rt+1,this._curLevelLabel.text=FacadeApp.read(CommandList.Re_FightInfo).LEVEL,this._curMoneyLabel.text=Digit.fromObject(FacadeApp.read(CommandList.Re_Status).money).ShowToString,this._cueNDLabel.text=t.stoneHero,this._curXWLabel.text=t.stone,this._laterLevelLabel.text="1",this._laterMoneyLabel.text="100000",this._laterNDLabel.text=t.stoneHero+t.stone,this._laterXWLabel.text="0",this._curFBLevLabel.text=FacadeApp.read(CommandList.Re_PetInfo).PetLevel,this._curFBNumLabel.text=FacadeApp.read(CommandList.Re_TalismanInfo).talismansNumOfActive(),this._curFBAllLevLabel.text=FacadeApp.read(CommandList.Re_TalismanInfo).talismansTotalLevel(),this._laterFBLevLabel.text="1",this._laterFBNumLabel.text="0",this._laterFBAllLevLabel.text="0",this._canXWLabel.text=t.stone,e=GameConfigOfRuntime.getStoneEffect(),this._canPlayerGJLabel.text=e+"%",this._canPetGJLabel.text=e+"%",[2]})})},e.prototype.onAccess=function(){t.prototype.onAccess.call(this),this.anchorOffsetX=320,this.anchorOffsetY=568,this.x=320,this.y=568,this.scaleX=0,this.scaleY=0,egret.Tween.get(this).to({scaleX:1,scaleY:1},200)},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnWaitZSButtonClick=function(t){SoundManager.PlayCloseWinMusic(),this.UnRegister()},e.prototype._OnStarZSButtonClick=function(t){UIPage.inst(UIPage).ShowConsumeTipWindow().ShowWindow("确认进行普通转生吗?",this.StartNormalZS.bind(this))},e.prototype._OnLookButtonClick=function(t){},e.prototype.StartNormalZS=function(){FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=7&gateNo&monsterNum"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),t.code==FacadeApp.SuccessCode?(SoldierManage.FightManager.GetInstance().readyZS(),UIPage.inst(UIPage).ShowReviveTipsWindow(),e.inst(e).UnRegister(),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data)}]),UIPage.inst(UIPage).updateProperties(),FacadeApp.fetchData([CommandList.M_NET_PetNum],[function(t){FacadeApp.dispatchAction(CommandList.M_DAT_PetList,t.data)}])):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e}(APanel);__reflect(ZSWindow.prototype,"ZSWindow");var DragonObjType={show_hou:"show_hou",stand_hou:"stand_hou",show_qian:"show_qian",guang:"guang",stand_qian:"stand_qian"},DragonObj=function(){function t(t,e){this.name="",this.obj=null,this.name=t,this.obj=e}return t}();__reflect(DragonObj.prototype,"DragonObj");var SanjieAniManage=function(t){function e(){var e=t.call(this)||this;return e._resArr1={},e._resArr2={},e._speed=.7,e._a=.05,Object.keys(DragonObjType).map(function(t){MovieManage.GetDragonBonesMovie("hong_"+DragonObjType[t],function(i){return null==i?void console.log("create monster armature error: hong_"+DragonObjType[t]):void(e._resArr1[DragonObjType[t]]=new DragonObj("hong_"+DragonObjType[t],i))}),MovieManage.GetDragonBonesMovie("lan_"+DragonObjType[t],function(i){return null==i?void console.log("create monster armature error: lan_"+DragonObjType[t]):void(e._resArr2[DragonObjType[t]]=new DragonObj("lan_"+DragonObjType[t],i))},e)}),e}return __extends(e,t),e.prototype.PlayAni=function(t,e,i,n){void 0===e&&(e=[]),void 0===i&&(i=0),void 0===n&&(n=0),this._sanjieGhost=[],this._cur=t;for(var a=0;a<e.length;a++){var o=e[a].p;for(o>0;o--;)this._sanjieGhost.push(new SanjieCard(e[a].id))}for(i>0;i--;)this._sanjieGhost.push(new SanjieCard(5));for(n>0;n--;)this._sanjieGhost.push(new SanjieCard(6));for(var r=0;r<this._sanjieGhost.length;r++)this.addChild(this._sanjieGhost[r]),this._sanjieGhost[r].y=500,this._sanjieGhost[r].x=170,this._sanjieGhost[r].scaleX=.001,this._sanjieGhost[r].scaleY=.001;1==t?this._curResArr=this._resArr1:2==t&&(this._curResArr=this._resArr2),this._state="ing",this._startShowAni=this._curResArr[DragonObjType.show_hou].obj,this._startShowAni.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.showAni,this),MovieManage.ADDArmature(this._startShowAni),this.addChild(this._startShowAni.display),this._startShowAni.animation.gotoAndPlay(this._curResArr[DragonObjType.show_hou].name,-1,-1,1)},e.prototype.showAni=function(t){var e=this;if(null!=this._startShowAni.display.parent){this._startShowAni.display.parent.removeChild(this._startShowAni.display),MovieManage.RemoveArmature(this._startShowAni),this._startShowAni.removeEventListener(dragonBones.AnimationEvent.COMPLETE,function(t,i){e.showAni},this),MovieManage.ADDArmature(this._curResArr[DragonObjType.stand_hou].obj),this.addChild(this._curResArr[DragonObjType.stand_hou].obj.display),this._curResArr[DragonObjType.stand_hou].obj.animation.gotoAndPlay(this._curResArr[DragonObjType.stand_hou].name);for(var i=0;i<this._sanjieGhost.length;i++)this._sanjieGhost[i].anchorOffsetX=this._sanjieGhost[i].width/2,this._sanjieGhost[i].anchorOffsetY=this._sanjieGhost[i].height/2,this._sanjieGhost[i].x=1e3+44*i,this._sanjieGhost[i].y=593,this.setChildIndex(this._sanjieGhost[i],this.numChildren-1),1==this._cur?(this._sanjieGhost[i].scaleX=1.5,this._sanjieGhost[i].scaleY=1.5):(this._sanjieGhost[i].scaleX=.6,this._sanjieGhost[i].scaleY=.6);this._count=0,this.feichu(this._cur)}},e.prototype.AniEnd=function(){this.removeChild(this._curResArr[DragonObjType.stand_hou].obj.display),MovieManage.RemoveArmature(this._curResArr[DragonObjType.stand_hou].obj);for(var t=0;t<this._sanjieGhost.length;t++)this.removeChild(this._sanjieGhost[t])},e.prototype.feichu=function(t){var e=this;egret.Tween.get(this._sanjieGhost[this._count]).to({scaleX:1==t?1.5:.6,scaleY:1==t?1.5:.6,x:1==t?323:this._sanjieGhost[this._count].width/2*.6+44*this._count,y:593},200).call(function(){if(13==e._sanjieGhost[e._count].Card.ID||16==e._sanjieGhost[e._count].Card.ID||20==e._sanjieGhost[e._count].Card.ID){var i=egret.Tween.get(e._sanjieGhost[e._count]);i.to({scaleX:1,scaleY:1,x:320,y:450},1e3,egret.Ease.backOut).call(function(){FacadeApp.Notify(CommandList.M_CMD_ZhenPing)},e).wait(1e3).to({scaleX:1==t?1.5:.6,scaleY:1==t?1.5:.6,x:1==t?323:e._sanjieGhost[e._count].width/2*.6+44*e._count,y:593},200).call(function(){e._count==e._sanjieGhost.length-1?e._state="end":(e._count++,e.feichu(t))})}else e._count==e._sanjieGhost.length-1?e._state="end":(e._count++,e.feichu(t))},this)},e.prototype.GetState=function(){return this._state},e.prototype.SetState=function(t){void 0===t&&(t=null),this._state=t},e}(egret.DisplayObjectContainer);__reflect(SanjieAniManage.prototype,"SanjieAniManage");var SanjieCard=function(t){function e(e){var i=t.call(this)||this;return i._card=CardManager.GetCardByID(e),i.Init(),i}return __extends(e,t),Object.defineProperty(e.prototype,"Card",{get:function(){return this._card},enumerable:!0,configurable:!0}),e.prototype.Init=function(){this._icon=new CardImage,this.addChild(this._icon),this._icon.ShowCard(this.Card,!0),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2},Object.defineProperty(e.prototype,"Icon",{get:function(){return this._icon},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(SanjieCard.prototype,"SanjieCard");var SanJieFuWindow=function(t){function e(){var e=t.call(this,"resource/game_skins/ui/SanjiefuWindowSkins.exml")||this;return e._curClickNum=0,e}return __extends(e,t),e.prototype.ComponentWillMount=function(){this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._kuitanButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnKuitanClick,this),this._wuxingButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnWuxingClick,this),this._yinyangIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnWuxingClick,this),this._qiankunIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnKuitanClick,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnAniEnd,this),this._CreateArmature(),this._Render()},e.prototype.ComponentDidMount=function(){3==FacadeApp.read(CommandList.Re_Status).guideId&&GuideWindow.inst(GuideWindow).GuideFinish(FacadeApp.read(CommandList.Re_Status).guideId)},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),null==this._aniPage.GetState()&&this.UnRegister()},e.prototype._OnAniEnd=function(t){"end"==this._aniPage.GetState()&&(this._aniPage.AniEnd(),this._aniPage.SetState(null))},e.prototype._OnWuxingClick=function(t){var e=this;SoundManager.PlayButtonMusic();var i=null,n=null;FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=1"],[function(t){return t.code!=FacadeApp.SuccessCode?void UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):(i=t.data,FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=5"],[function(t){if(t.code!=FacadeApp.SuccessCode)return void UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]);e._Render(),FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),n=t.data;var a=[];for(var o in n.items)n.items[o].p-i.items[o].p>0&&a.push({id:n.items[o].i,p:n.items[o].p-i.items[o].p});null==e._aniPage.GetState()&&e._aniPage.PlayAni(1,a,n.adChip-i.adChip,n.chip-i.chip)}]),FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),void FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]))}])},e.prototype._OnKuitanClick=function(t){var e=this;SoundManager.PlayButtonMusic();var i=null,n=null;FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=1"],[function(t){return t.code!=FacadeApp.SuccessCode?void UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]):(FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),i=t.data,void FacadeApp.fetchData([CommandList.M_NET_Card,"&oper=11"],[function(t){if(t.code!=FacadeApp.SuccessCode)return void UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code]);FacadeApp.dispatchAction(CommandList.M_DAT_CardList,t.data),n=t.data;var a=[];for(var o in n.items)n.items[o].p-i.items[o].p>0&&a.push({id:n.items[o].i,p:n.items[o].p-i.items[o].p});null==e._aniPage.GetState()&&e._aniPage.PlayAni(2,a,n.adChip-i.adChip,n.chip-i.chip),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}]))}])},e.prototype._CreateArmature=function(){this._aniPage=new SanjieAniManage,this.addChild(this._aniPage)},e.prototype._Render=function(){var t=FacadeApp.read(CommandList.Re_Status).execute.max[101]?FacadeApp.read(CommandList.Re_Status).execute.max[101].num:3,e=FacadeApp.read(CommandList.Re_Status).execute.num[101]?FacadeApp.read(CommandList.Re_Status).execute.num[101]:0;this._freeChance.text=t-e+"/"+t},e}(APanel);__reflect(SanJieFuWindow.prototype,"SanJieFuWindow");var ShopGoodsLine=function(t){function e(){var e=t.call(this)||this;return e.goods=null,e.skinName="resource/game_skins/shop/ShopListSkins.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"getId",{get:function(){return this.goods?this.goods.ListID:-1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.goods=GoodsManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._buyButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnButtonClick,this),this.Render()},e.prototype._OnButtonClick=function(t){SoundManager.PlayButtonMusic(),FacadeApp.fetchData([CommandList.M_NET_SHOP,"&oper=2&type=1&id="+this.goods.ID],[this.onSuccess.bind(this)],!0,"order")},e.prototype.onSuccess=function(t){FacadeApp.fetchData([CommandList.M_NET_SHOP,"&oper=3&type=1"],[function(t){FacadeApp.dispatchAction(CommandList.SHOP_GET_LIST,t.data.items),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),FacadeApp.fetchData([CommandList.M_NET_STATUS],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_STATUSLIST,t.data),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return null==this.goods?(console.log("获取商品出错，商品ID："+this.goods.ID),[2]):(this._shopImage.source=this.goods.IconRes,this._nameImage.source=this.goods.NameRes,1==this.goods.BuyType?this._buyButton.updateShow(1,[this.goods.Cost.toString(),"金币购买"]):0==this.goods.BuyType&&this._buyButton.updateShow(1,["y"+this.goods.Cost,"人民币购买"]),""==this.goods.Description?(this._desGroup.visible=!1,this._desLabel.visible=!0,this._desLabel.text=this.goods.Description):(this._desGroup.visible=!0,this._desLabel.visible=!1,this._desImage.source=this.goods.CostTypeRes,this._desGLabel.text=this.goods.Description),[2])})})},e.prototype.creatFlyMoney=function(){},e}(eui.Component);__reflect(ShopGoodsLine.prototype,"ShopGoodsLine",["IGroupLine","egret.DisplayObject"]);var ShopWindow=function(t){function e(){var i=t.call(this,"resource/game_skins/shop/ShopWindowSkins.exml")||this;return t.prototype.InitComponent.call(i,i._shopGroup,i._shopList,[function(){return e.genericsFactory(ShopGoodsLine)}],[function(){var t=FacadeApp.read(CommandList.Re_ShopInfo).list,e=Object.keys(t).filter(function(t){return!0});return[t,e]}]),FacadeApp.inst.removeMediator(ViewerName.ShopWindowMediator),FacadeApp.inst.registerMediator(new ShopWindowMediator(i)),i}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.y=GameConfigOfRuntime.gameHeight,this._totalGJLabel.rotation=8,this._shopList.height=250,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._upOrDownButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._UpOrDownPanel,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,FacadeApp.Notify(CommandList.M_CMD_UiOpened_Shop)},e.prototype._OnCloseClick=function(t){this.CloseWindow()},e.prototype._UpOrDownPanel=function(){t.prototype._UpOrDown.call(this,this._upOrDownButton.selected,this._shopList),SoundManager.PlayButtonMusic()},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),[2]})})},e}(APanelList);__reflect(ShopWindow.prototype,"ShopWindow");var ShopWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.ShopWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.main.RegisterDataSource([CommandList.SHOP_GET_LIST,CommandList.M_DAT_Change_Money])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Shop]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Shop:FacadeApp.fetchData([CommandList.M_NET_SHOP,"&oper=3&type=1"],[function(t){FacadeApp.dispatchAction(CommandList.SHOP_GET_LIST,t.data.items),t.code!=FacadeApp.SuccessCode&&UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])}},Object.defineProperty(e.prototype,"main",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(ShopWindowMediator.prototype,"ShopWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var SkillCD=function(t){function e(e){var i=t.call(this)||this;return i._isShow=!1,i._loaded=!1,i._id=0,i._id=e,i._movie=new egret.MovieClip,i._movie.x=38,i._movie.y=38,MovieManage.GetMovieClipData("jineng_cd_json","jineng_cd_png","jineng_sd").then(function(t){return __awaiter(i,void 0,void 0,function(){var e;return __generator(this,function(i){switch(i.label){case 0:return this._movie.movieClipData=t,this._movie.gotoAndStop(1),this._image=new eui.Image,this._image.width=44,this._image.height=25,this._image.x=18,this._image.y=18,e=this._image,[4,MovieManage.PromisifyGetRes("jineng_cdlq_png",this)];case 1:return e.texture=i.sent(),this._text=new eui.BitmapLabel,this._text.font="mainnum_fnt",this._text.y=43,this._text.width=200,this._text.x=-60,this._text.textAlign=egret.HorizontalAlign.CENTER,this.Progress=100,this._loaded=!0,[2]
}})})}),i}return __extends(e,t),Object.defineProperty(e.prototype,"loaded",{get:function(){return this._loaded},enumerable:!0,configurable:!0}),e.prototype.Update=function(){if(this.loaded){var t=SkillManager.GetActiveSkillByID(this._id);if(null!=t)var e=3==t.Status,i=TextManager.TimeFormat(t.LastTime);this.SetContent(i,e),this.Progress=Math.floor(100*(1-t.GetProgress()))}},Object.defineProperty(e.prototype,"Progress",{set:function(t){0>t||(t=Math.round(t),t>=100?this._IsShow(!1):100>t&&this._IsShow(!0),this._movie.gotoAndStop(Math.min(t+1,100)))},enumerable:!0,configurable:!0}),e.prototype.SetContent=function(t,e){return void 0===e&&(e=!1),__awaiter(this,void 0,void 0,function(){var i,n;return __generator(this,function(a){switch(a.label){case 0:return this._text.text=t,i=e?"jineng_cdlq_png":"jineng_cdsf_png",n=this._image,[4,MovieManage.PromisifyGetRes(i,this)];case 1:return n.texture=a.sent(),[2]}})})},e.prototype._IsShow=function(t){t!=this._isShow&&(this._isShow=t,t?null==this._movie.parent&&(this.addChild(this._movie),this.addChild(this._image),this.addChild(this._text)):null!=this._movie.parent&&(this.removeChild(this._movie),this.removeChild(this._image),this.removeChild(this._text)))},e}(egret.DisplayObjectContainer);__reflect(SkillCD.prototype,"SkillCD");var TalismanDetail=function(t){function e(){return t.call(this,"resource/game_skins/talisman/TalismanDetailWindowSkins.exml")||this}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.anchorOffsetX=320,this.anchorOffsetY=568,this.x=320,this.y=568,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._leftButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnLeftClick,this),this._rightButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnRightClick,this)},e.prototype.ComponentDidMount=function(){this._ShowMovie()},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.ShowTalisman(this._talisman),[2]})})},e.prototype._OnLeftClick=function(t){var e=this._talisman.ID-1,i=FacadeApp.read(CommandList.Re_TalismanInfo).list,n=i[e];null!=n?this.ShowTalisman(TalismanManager.fromData(n)):console.log("法宝为空"+this._talisman.ID)},e.prototype._OnRightClick=function(t){var e=this._talisman.ID- -1,i=FacadeApp.read(CommandList.Re_TalismanInfo).list,n=i[e];null!=n?this.ShowTalisman(TalismanManager.fromData(n)):console.log("法宝为空"+this._talisman.ID)},e.prototype._OnCloseClick=function(t){this.UnRegister()},e.prototype.ShowTalisman=function(t){var e=this;this._talisman=t,RES.getResAsync(t.Icon+"_png",function(t){e._talismanImage.texture=t},this),RES.getResAsync(t.NameRes+"_png",function(t){e._nameIma.texture=t},this),this._levelLabel.text="Lv."+t.Level.toString();var i=t.Gongji;this._gjLabel.text=i.ShowToString,this._nextGJLabel.text=t.NextLVGJ.ShowToString;var n=TalismanManager.TalismanTotalGJ,a=CalculateMgr.Mul(new Digit([100]),CalculateMgr.Div(i,n));this._account.text=a.ShowToString+"%",this.CreatSkill(),this.setScrollBar()},e.prototype._ShowMovie=function(){this.scaleX=0,this.scaleY=0;var t=egret.Tween.get(this);t.to({scaleX:1,scaleY:1},200)},e.prototype.CreatSkill=function(){this._talismanSkillGroup.removeChildren();for(var t=0,e=0;10>e;e++){var i=new TalismanDetailList(this._talisman,e);i.y=t,t+=i.height,this._talismanSkillGroup.addChild(i)}},e.prototype.setScrollBar=function(){this._talismanSkillList.stopAnimation(),this._talismanSkillList.viewport.scrollV=0,this._talismanSkillList.bounces=!1,this._talismanSkillList.verticalScrollBar.autoVisibility=!1,this._talismanSkillList.verticalScrollBar.visible=!1},e}(APanel);__reflect(TalismanDetail.prototype,"TalismanDetail");var TalismanDetailList=function(t){function e(e,i){var n=t.call(this)||this;return n.requireLevel=0,n.sObj=null,n.talisman=null,n.skinName="resource/game_skins/talisman/TalismanDetailListSkins.exml",n.talisman=e,n.requireLevel=e._skillLevelSet[i],n.sObj=SkillManager.GetTalismanSkillByID(e._skillIDSet[i]),n}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.updateShow()},e.prototype.updateShow=function(){this._iconIma.source=this.sObj.Icon+"_png",this._iconIma.alpha=this.talisman.Level>=this.requireLevel?1:.1,this._jiesuoLevelLabel.text=this.requireLevel.toString(),this._derLabel.text=this.sObj.Description,this._nameLabel.text=this.sObj.Name},e}(eui.Component);__reflect(TalismanDetailList.prototype,"TalismanDetailList");var TalismanLine=function(t){function e(){var e=t.call(this)||this;return e._talismanSkillArr=[],e._curSkillNum=-1,e._ifShenjiAni=!1,e.skinName="resource/game_skins/talisman/TalismanListSkins.exml",e}return __extends(e,t),Object.defineProperty(e.prototype,"getId",{get:function(){return this.talisman?this.talisman.ID:-1},enumerable:!0,configurable:!0}),e.prototype.update=function(t){return this.talisman=TalismanManager.fromData(t),this.Render(),this},e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this._scroller.horizontalScrollBar.autoVisibility=!1,this._scroller.horizontalScrollBar.visible=!1,this._scroller.horizontalScrollBar.touchEnabled=!1,this._scroller.touchEnabled=!1,this._scroller.touchChildren=!1,this._upButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnUpLevelClick,this),this._iconIma.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnImageClick,this)},e.prototype.Render=function(){var t=this;RES.getResAsync(this.talisman.NameRes+"_png",function(e){t._nameIma.texture=e},this),RES.getResAsync(this.talisman.Icon+"_png",function(e){t._iconIma.texture=e},this),this._levelLabel.text="Lv."+this.talisman.Level.toString(),this._gjLabel.text=Digit.fromObject(this.talisman.ori.b).ShowToString;var e=this.talisman.UpLVMoney(TalismanWindow.curUpLevel);this._upMoneyNumString=e.ShowToString;var i=Digit.fromObject(this.talisman.ori.bn).Sub(Digit.fromObject(this.talisman.ori.b)).SetUpNum(TalismanWindow.curUpLevel).ShowToString;if(this._addGJNumString="+"+i,this._upButton.updateShow(0,[this._upMoneyNumString,this._addGJNumString]),this.oriSkill(),this.Talisman.Level<1){var n=this.talisman.UpLVMoney(1);this._upMoneyNumString=n.ShowToString;var a=Digit.fromObject(this.talisman.ori.bn).Sub(Digit.fromObject(this.talisman.ori.b)).SetUpNum(1).ShowToString;this._addGJNumString="+"+a,this.changeState("huidu")}else this.changeState("normal")},e.prototype._OnUpLevelClick=function(t){var e=this;FacadeApp.read(CommandList.Re_Status).TestMoney(this.talisman.UpLVMoney(TalismanWindow.curUpLevel),!0)&&FacadeApp.fetchData([CommandList.M_NET_TalismanNum,"&oper=2","&id=",this.talisman.ID,"&pm="+TalismanWindow.curUpLevel],[function(t){if(t.code==FacadeApp.SuccessCode){SoundManager.PlayLvupMusic(),e._ifShenjiAni=!0;var i=Digit.fromObject(t.data.power),n=Digit.fromObject(FacadeApp.read(CommandList.Re_Status).power);i.Sub(n).ShowToString;e._curSkillNum=e.Talisman.Level,FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList,t.data),FacadeApp.dispatchAction(CommandList.M_DAT_Change_Money,t.data.money),FacadeApp.dispatchAction(CommandList.M_AT_STATUS_Power,t.data.power),FacadeApp.dispatchAction(CommandList.M_DAT_Status_PowerClick,t.data.powerClick)}else UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}])},e.prototype.oriSkill=function(){if(this._talismanSkillArr=[this._skill1,this._skill2,this._skill3],this.judgeLevelSkill(),this._ifShenjiAni){var t=this.Talisman.Level-this._curSkillNum;this._curSkillNum>=10?(t>=25||this._curSkillNum%25+t>=25)&&(this._scroller.viewport.scrollH=0,this.creatSkillAni()):(t>=10||this._curSkillNum%25+t>=10)&&(this._scroller.viewport.scrollH=0,this.creatSkillAni()),this._ifShenjiAni=!1,this._curSkillNum=this.Talisman.Level}else this.talisman.Level>=25?this._scroller.viewport.scrollH=70:this._scroller.viewport.scrollH=0},e.prototype.judgeLevelSkill=function(){for(var t=[11,26,50,75,100,125,150,175,200,1e3],e=this.talisman.Level-this.talisman.Level%1e3,i=this.talisman.Level-this.talisman.Level%25,n=0;n<t.length;n++){if(this.talisman.Level<t[n]){0==n?(this._talismanSkillArr[0].updataTalismanShow(t[n]-1,this.Talisman._skillIDSet[n],this.Talisman),this._talismanSkillArr[1].updataTalismanShow(t[n+1]-1,this.Talisman._skillIDSet[n+1],this.Talisman),this._talismanSkillArr[2].updataTalismanShow(t[n+2],this.Talisman._skillIDSet[n+2],this.Talisman)):1==n?(this._talismanSkillArr[0].updataTalismanShow(t[n-1]-1,this.Talisman._skillIDSet[n-1],this.Talisman),this._talismanSkillArr[1].updataTalismanShow(t[n]-1,this.Talisman._skillIDSet[n],this.Talisman),this._talismanSkillArr[2].updataTalismanShow(t[n+1],this.Talisman._skillIDSet[n+1],this.Talisman)):0!=n&&1!=n&&8>=n?(this._talismanSkillArr[0].updataTalismanShow(t[n-2],this.Talisman._skillIDSet[n-2],this.Talisman),this._talismanSkillArr[1].updataTalismanShow(t[n-1],this.Talisman._skillIDSet[n-1],this.Talisman),this.talisman.Level%1e3+25<1e3?this._talismanSkillArr[2].updataTalismanShow(i+25,this.Talisman._skillIDSet[8],this.Talisman):this._talismanSkillArr[2].updataTalismanShow(i+25,this.Talisman._skillIDSet[9],this.Talisman)):(this._talismanSkillArr[0].updataTalismanShow(i-25,this.Talisman._skillIDSet[8],this.Talisman),this._talismanSkillArr[1].updataTalismanShow(i,this.Talisman._skillIDSet[8],this.Talisman),this.talisman.Level%1e3+25<1e3?this._talismanSkillArr[2].updataTalismanShow(i+25,this.Talisman._skillIDSet[8],this.Talisman):this._talismanSkillArr[2].updataTalismanShow(i+25,this.Talisman._skillIDSet[9],this.Talisman));break}this.talisman.Level%1e3<25?(this._talismanSkillArr[0].updataTalismanShow(e-25,this.Talisman._skillIDSet[8],this.Talisman),this._talismanSkillArr[1].updataTalismanShow(e,this.Talisman._skillIDSet[9],this.Talisman),this._talismanSkillArr[2].updataTalismanShow(e+25,this.Talisman._skillIDSet[8],this.Talisman)):(this._talismanSkillArr[0].updataTalismanShow(i-25,this.Talisman._skillIDSet[8],this.Talisman),this._talismanSkillArr[1].updataTalismanShow(i,this.Talisman._skillIDSet[8],this.Talisman),this.talisman.Level%1e3+25<1e3?this._talismanSkillArr[2].updataTalismanShow(i+25,this.Talisman._skillIDSet[8],this.Talisman):this._talismanSkillArr[2].updataTalismanShow(i+25,this.Talisman._skillIDSet[9],this.Talisman))}},e.prototype.creatSkillAni=function(){var t=this,e=[this._skill1,this._skill2,this._skill3];MovieManage.GetDragonBonesMovie("shengji_tx",function(i){var n=i;t._group.addChild(n.display),t.Talisman.Level>=25?(n.display.x=e[1].x+e[1].width/2,n.display.y=e[1].y+e[1].height/2,egret.Tween.removeTweens(t._scroller.viewport),t._scroller.viewport.scrollH=0,egret.Tween.get(t._scroller.viewport).to({scrollH:70},1e3)):(n.display.x=e[0].x+e[0].width/2,n.display.y=e[0].y+e[0].height/2),n.addEventListener(dragonBones.AnimationEvent.COMPLETE,function(){this._group.removeChild(n.display)},t),n.animation.gotoAndPlay("shengji_tx")},this)},e.prototype.creatAni=function(t){var e=new eui.BitmapLabel;e.font="upZLNum_fnt",e.text=t,this.addChild(e),e.y=this.height/2,e.x=this.width/2,egret.Tween.get(e).to({y:0,alpha:0},2e3).call(function(){this.removeChild(e)}.bind(this))},Object.defineProperty(e.prototype,"Talisman",{get:function(){return this.talisman},enumerable:!0,configurable:!0}),e.prototype._OnImageClick=function(t){FacadeApp.Notify(CommandList.M_CMD_ShowTalisman,this.talisman)},e.prototype.changeState=function(t){"huidu"==t?(this._bgIma.setHuiduState(),this._iconIma.filters=[FilterManage.HuiDu],this._fgStarIma.visible=!1):"gaoliang"==t?(this._bgIma.setGaoLiangState(),this._iconIma.filters=null,this._fgStarIma.visible=!0):"normal"==t&&(this._bgIma.setNormalState(),this._iconIma.filters=null,this._fgStarIma.visible=!1)},e}(eui.Component);__reflect(TalismanLine.prototype,"TalismanLine",["IGroupLine","egret.DisplayObject"]);var TalismanWindow=function(t){function e(){var i=t.call(this,"resource/game_skins/talisman/TalismanWindowSkins.exml")||this;return i._curUpLevelNum=1,t.prototype.InitComponent.call(i,i._talismanGroup,i._talismanList,[function(){return e.genericsFactory(TalismanLine)}],[function(){var t=FacadeApp.read(CommandList.Re_TalismanInfo).list,e=!0,i=Object.keys(t).filter(function(i){return t[i].l<=0?e?(e=!1,!0):!1:!0});return[t,i]}]),FacadeApp.inst.removeMediator(ViewerName.TalismanWindowMediator),FacadeApp.inst.registerMediator(new TalismanWindowMediator(i)),i}return __extends(e,t),e.prototype.ComponentWillMount=function(){this.y=GameConfigOfRuntime.gameHeight,this._totalGJLabel.rotation=4,this._talismanList.height=250,this._upLevelLabel.touchEnabled=!1,this._closeButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._OnCloseClick,this),this._upOrDownButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._UpOrDownPanel,this),this._upLevelButton.addEventListener(egret.TouchEvent.TOUCH_TAP,this._UpLevelClick,this)},e.prototype.ComponentDidMount=function(){this.firstOpen=!0,FacadeApp.Notify(CommandList.M_CMD_UiOpened_Talisman)},e.prototype.Render=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t.prototype.Render.call(this),this._totalGJLabel.text=Digit.fromObject(FacadeApp.read(CommandList.Re_Status).powerClick).ShowToString,[2]})})},e.prototype._UpLevelClick=function(t){this._curUpLevelNum+=1,1==this._curUpLevelNum?(this._upLevelLabel.text="X1",e.curUpLevel=1):2==this._curUpLevelNum?(this._upLevelLabel.text="X25",e.curUpLevel=25):3==this._curUpLevelNum?(this._upLevelLabel.text="X100",e.curUpLevel=100):4==this._curUpLevelNum?(this._upLevelLabel.text="X1000",e.curUpLevel=1e3):5==this._curUpLevelNum&&(this._curUpLevelNum=1,this._upLevelLabel.text="X1",e.curUpLevel=1),this.Render()},e.prototype._OnCloseClick=function(t){SoundManager.PlayCloseWinMusic(),this.CloseWindow()},e.prototype._UpOrDownPanel=function(){SoundManager.PlayButtonMusic(),t.prototype._UpOrDown.call(this,this._upOrDownButton.selected,this._talismanList,this._talismanGroup)},e}(APanelList);TalismanWindow.curUpLevel=1,__reflect(TalismanWindow.prototype,"TalismanWindow");var TalismanWindowMediator=function(t){function e(e){var i=t.call(this,ViewerName.TalismanWindowMediator,e)||this;return i.RegisterDataSourceFun(),i}return __extends(e,t),e.prototype.RegisterDataSourceFun=function(){this.page.RegisterDataSource([CommandList.M_DAT_TalismanList,CommandList.M_DAT_Change_Money])},e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_UiOpened_Talisman]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_UiOpened_Talisman:FacadeApp.fetchData([CommandList.M_NET_TalismanNum,"&oper=1"],[function(t){t.code==FacadeApp.SuccessCode?FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList,t.data):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])}]),FacadeApp.dispatchAction(CommandList.M_DAT_TalismanList),FacadeApp.dispatchAction(CommandList.M_AT_STATUS_Power),FacadeApp.dispatchAction(CommandList.M_DAT_Status_PowerClick),2==FacadeApp.read(CommandList.Re_Status).guideId&&GuideWindow.inst(GuideWindow).GuideFinish(FacadeApp.read(CommandList.Re_Status).guideId)}},Object.defineProperty(e.prototype,"page",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(TalismanWindowMediator.prototype,"TalismanWindowMediator",["puremvc.IMediator","puremvc.INotifier"]);var ViewerName={MainMediator:"MainMediator",UIPageMediator:"UIPageMediator",DailyTaskWindowMediator:"DailyTaskWindowMediator",ShopWindowMediator:"ShopWindowMediator",RankingWindowMediator:"RankingWindowMediator",PetWindowMediator:"PetWindowMediator",TalismanWindowMediator:"TalismanWindowMediator",BuddhaManagerMediator:"BuddhaWindowMediator",BuddhaGuardMediator:"BuddhaGuardMediator",AchievementWindowMediator:"AchievementWindowMediator",CardWindowMediator:"CardWindowMediator",MarshallingWindowMediator:"MarshallingWindowMediator",AmuletWindowMediator:"AmuletWindowMediator",PVPWindowMediator:"PVPWindowMediator",MailWindowMediator:"MailWindowMediator",IntegralWindowMediator:"IntegralWindowMediator"},ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function a(t){e.call(n,t)}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),i.call(n))}RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,a,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var CalculateMgr=function(){function t(){}return t.Transformation=function(t){var e=[],i=t?t:0,n=0;if(Math.abs(i)<0)for(;Math.abs(i)<0;)i=10*i,n-=1;else if(Math.abs(i)>10)for(;Math.abs(i)>10;)i/=10,n+=1;return e.push(i),e.push(n),e},t.CounterPoise=function(t){t.CounterPoise()},t.Compare=function(e,i){return null==e||null==i?-2:0==e.Base&&0==i.Base?0:e.Base>=0&&i.Base<=0?1:e.Base<=0&&i.Base>=0?-1:(t.CounterPoise(e),t.CounterPoise(i),e.Power>i.Power?1:e.Power<i.Power?-1:e.Base>i.Base?1:e.Base<i.Base?-1:0)},t.Add=function(t,e){return t.clone.Add(e)},t.Sub=function(t,e){return t.clone.Sub(e)},t.Mul=function(t,e){return t.clone.Mul(e)},t.Div=function(t,e){return t.clone.Div(e)},t.Pow=function(t,e){for(var i=new Digit([1]);e>0;){var n=e>=100?100:e,a=new Digit([Math.pow(t,n)]);i.Mul(a),e-=n}return i},t}();__reflect(CalculateMgr.prototype,"CalculateMgr");var Digit=function(){function t(t){if(void 0===t&&(t=[0]),(null==t||t.length>2)&&console.log("数据错误"),1==t.length&&0!=t[0]){var e=CalculateMgr.Transformation(t[0]);this.base=e[0],this.power=e[1]}else 0==t[0]?(this.base=0,this.power=0):(this.base=t[0]?t[0]:0,this.power=t[1]?t[1]:0,this.CounterPoise())}return t.fromObject=function(e){return new t([e.base,e.power])},Object.defineProperty(t.prototype,"clone",{get:function(){return new t([this.Base,this.Power])},enumerable:!0,configurable:!0}),t.prototype.Compare=function(e){if(e instanceof t)return CalculateMgr.Compare(this,e);var i=new t([e,0]);return CalculateMgr.Compare(this,i)},t.prototype.Larger=function(t){return 1==this.Compare(t)},t.prototype.Little=function(t){return-1==this.Compare(t)},t.prototype.Equal=function(t){return 0==this.Compare(t)},t.prototype.max=function(e){if(e instanceof t)return 1==e.Compare(this)?e:this;var i=new t([e,0]);return 1==i.Compare(this)?i:this},t.prototype.CounterPoise=function(){var t=this.Base,e=this.Power;if(0==t)e=0;else if(Math.abs(t)<1)for(;Math.abs(t)<1;)t=10*t,e-=1;else if(Math.abs(t)>10)for(;Math.abs(t)>10;)t/=10,e+=1;return this.Base=parseFloat(t.toFixed(4)),this.Power=e,this},Object.defineProperty(t.prototype,"Base",{get:function(){return this.base},set:function(t){this.base=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Power",{get:function(){return this.power},set:function(t){this.power=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShowToString",{get:function(){var t="",e=4;if(this.power>=0&&this.power<8){t=(this.base*Math.pow(10,this.power)).toString();var i=t.indexOf(".");-1!=i&&(t=t.substr(0,i))}else if(this.power>0&&this.power<12){var n=(this.base*Math.pow(10,this.power-8)).toString();t=-1==n.indexOf(".")?n.toString():n.substr(0,n.indexOf(".")+e),t+="亿"}else if(this.power>0&&this.power<16){var n=(this.base*Math.pow(10,this.power-12)).toString();t=-1==n.indexOf(".")?n.toString():n.substr(0,n.indexOf(".")+e),t+="万亿"}else{var n=this.base.toString();t=-1==n.indexOf(".")?n.toString():n.substr(0,n.indexOf(".")+e),t=t+"e"+this.power.toString()}return t},enumerable:!0,configurable:!0}),t.prototype.Add=function(e){var i=e instanceof t?e:new t([e]);return i.CounterPoise(),this.power>i.power+t.scope||(this.power<i.power-t.scope?(this.base=i.base,this.power=i.power):(this.base+=i.base/Math.pow(10,this.power-i.power),this.CounterPoise())),this},t.prototype.Sub=function(e){var i=e instanceof t?e:new t([e]);return i.CounterPoise(),this.power>i.power+t.scope||(this.power<i.power-t.scope?(this.base=-i.base,this.power=i.power):(this.base-=i.base/Math.pow(10,this.power-i.power),this.CounterPoise())),this},t.prototype.Mul=function(e){var i=e instanceof t?e:new t([e]);return this.Base=this.Base*i.Base,this.Power=this.Power+i.Power,this.CounterPoise(),this},t.prototype.Div=function(e){var i=e instanceof t?e:new t([e]);return this.Base=this.Base/i.Base,this.Power=this.Power-i.Power,this.CounterPoise(),this},Object.defineProperty(t.prototype,"Number",{get:function(){return this.CounterPoise(),this.power>300&&(this.power=300),this.base*Math.pow(10,this.power)},enumerable:!0,configurable:!0}),t.prototype.SetUpNum=function(t){return this.base*=t,this.CounterPoise(),this.power>300&&(this.power=300),this},t.prototype.CalcFinallyValue=function(t){var e=this;return t.map(function(t){e.base=FacadeApp.Calc(t,e.base)}),this.CounterPoise()},t}();Digit.scope=8,__reflect(Digit.prototype,"Digit");var FilterManage=function(){function t(){}return Object.defineProperty(t,"HuiDu",{get:function(){var t=[.33,.33,.33,0,0,.33,.33,.33,0,0,.33,.33,.33,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return e},enumerable:!0,configurable:!0}),t.AddMiaoBian=function(t,e){void 0===t&&(t=0),void 0===e&&(e=16777215);var i=new egret.GlowFilter(e,1,t,t,10,1,!1,!1);return i},t}();__reflect(FilterManage.prototype,"FilterManage");var Indicator=function(){function t(t){this._indecate=t}return Object.defineProperty(t.prototype,"indecate",{get:function(){return this._indecate},enumerable:!0,configurable:!0}),t.prototype.unSet=function(t){return this._indecate=this._indecate&~t,this},t.prototype.set=function(t){return this._indecate|=t,this},t.prototype.check=function(t){return(this.indecate&t)==t},t.getChecker=function(e){return function(i){return t.getInstance(e).check(i)}},t.getInstance=function(e){return new t(e)},t}();__reflect(Indicator.prototype,"Indicator");var MainMediator=function(t){function e(e){return t.call(this,ViewerName.MainMediator,e)||this}return __extends(e,t),e.prototype.listNotificationInterests=function(){return[CommandList.M_CMD_Login]},e.prototype.handleNotification=function(t){switch(t.getName()){case CommandList.M_CMD_Login:FacadeApp.fetchData([CommandList.M_NET_CheckpointNum,"&oper=4"],[function(t){FacadeApp.dispatchAction(CommandList.M_AT_SyncCheckpoint,t.data),t.code==FacadeApp.SuccessCode?FacadeApp.Notify(CommandList.M_CMD_CHANGE,1):UIPage.inst(UIPage).ShowPrompt().ShowWindow(FacadeApp._errorCodeSet[t.code])},function(t){FacadeApp.Notify(CommandList.M_CMD_Login)}])}},Object.defineProperty(e.prototype,"main",{get:function(){return this.viewComponent},enumerable:!0,configurable:!0}),e}(puremvc.Mediator);__reflect(MainMediator.prototype,"MainMediator",["puremvc.IMediator","puremvc.INotifier"]);var GameCommand=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.register=function(){this.facade.registerCommand(CommandList.M_CMD_ZhenPing,e),this.facade.registerCommand(CommandList.M_CMD_CHANGE,e)},e.prototype.execute=function(t){switch(t.getName()){case CommandList.M_CMD_CHANGE:var e=t.getBody(),i=this.facade.retrieveMediator(ViewerName.MainMediator);1==e?i.main.enterStartScreen():i.main.enterGameScreen();break;case CommandList.M_CMD_ZhenPing:Main.Instance.creatZhenPingFun()}},e}(puremvc.SimpleCommand);GameCommand.NAME="GameCommand",__reflect(GameCommand.prototype,"GameCommand",["puremvc.ICommand","puremvc.INotifier"]);var MovieManage=function(){function t(){}return t.GetMovieClipData=function(e,i,n){return __awaiter(this,void 0,void 0,function(){var a,o,r,s,c;return __generator(this,function(l){switch(l.label){case 0:return null==t._movieDataFactorySet&&(t._movieDataFactorySet=[]),[4,t.PromisifyGetRes(e,this)];case 1:return a=l.sent(),[4,t.PromisifyGetRes(i,this)];case 2:return o=l.sent(),r=e+i,s=t._movieDataFactorySet[r],null==s&&(s=new egret.MovieClipDataFactory(a,o),t._movieDataFactorySet[r]=s),c=s.generateMovieClipData(n),[2,c]}})})},t.PromisifyGetRes=function(t,e){return new Promise(function(i,n){try{RES.getResAsync(t,function(t){i(t)},e)}catch(a){n(a)}})},t.getResList=function(t,e,i){for(var n=this,a=0,o=0;o<t.length;o++)a|=1<<o;var r=0,s=[],c=0;t.map(function(t){var o=c++;RES.getResAsync(t,function(t){s[o]=t,r=Indicator.getInstance(r).set(1<<o).indecate,Indicator.getChecker(r)(a)&&e.call(i,s)},n)})},t.PromisifyGetDragonBonesMovie=function(e,i){return new Promise(function(n,a){try{t.GetDragonBonesMovie(e,function(t){n(t)},i)}catch(o){a(o)}})},t.GetDragonBonesMovie=function(e,i,n){var a=this;void 0===e&&(e="");var o=e+"_json",r=e+"texture_json",s=e+"texture_png";if(null==this._dragonBonesFactory&&(this._dragonBonesFactory=new dragonBones.EgretFactory),null==t._dragonMovieSet&&(t._dragonMovieSet=[]),!i){if(null==t._dragonMovieSet[o]){var c=RES.getRes(o),l=RES.getRes(r),u=RES.getRes(s);null==c&&console.log("Data:"+o),null==l&&console.log("Texturejson:"+r),null==u&&console.log("Texture:"+s),t._dragonBonesFactory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(c)),t._dragonBonesFactory.addTextureAtlas(new dragonBones.EgretTextureAtlas(u,l)),t._dragonMovieSet[o]="1"}var h=t._dragonBonesFactory.buildArmature(e);return t.ADDArmature(h),t._isTickerRegister||(egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3)},this),t._isTickerRegister=!0),h}this.getResList([o,r,s],function(r){var s=r[0],c=r[1],l=r[2];null==t._dragonMovieSet[o]&&(t._dragonBonesFactory.addSkeletonData(dragonBones.DataParser.parseDragonBonesData(s)),t._dragonBonesFactory.addTextureAtlas(new dragonBones.EgretTextureAtlas(l,c)),t._dragonMovieSet[o]="1");var u=t._dragonBonesFactory.buildArmature(e);t.ADDArmature(u),t._isTickerRegister||(egret.Ticker.getInstance().register(function(t){dragonBones.WorldClock.clock.advanceTime(t/1e3)},a),t._isTickerRegister=!0),i.call(n,u)},this)},t.ADDArmature=function(t){null==t||dragonBones.WorldClock.clock.contains(t)||dragonBones.WorldClock.clock.add(t)},t.RemoveArmature=function(t){null!=t&&dragonBones.WorldClock.clock.contains(t)&&dragonBones.WorldClock.clock.remove(t)},t}();MovieManage._isTickerRegister=!1,__reflect(MovieManage.prototype,"MovieManage");var ObjectPool=function(){function t(t){this.className=t,this.list=[]}return t.prototype.borrowObject=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.list.length>0){var i=this.list.shift();return"function"==typeof i.onInit?i.onInit():i}var n=egret.getDefinitionByName(this.className);return new(n.bind.apply(n,[void 0].concat(t)))},t.prototype.returnObject=function(t){"function"==typeof t.onReturn?this.list.push(t.onReturn()):this.list.push(t)},t.getPool=function(e){return t.pool[e]||(t.pool[e]=new t(e)),t.pool[e]},t}();ObjectPool.pool={},__reflect(ObjectPool.prototype,"ObjectPool");var physicsWorld=function(){function t(){}return Object.defineProperty(t,"world",{get:function(){if(null==this._world){var e=new p2.World({gravity:[0,t.params.gravity]});e.sleepMode=p2.World.BODY_SLEEPING;var i=new p2.Plane,n=new p2.Body({position:[0,t.params.landline/t.params.factor],mass:0});n.addShape(i),n.displays=[],e.addBody(n),e.defaultContactMaterial.restitution=.7,this._world=e,egret.Ticker.getInstance().register(function(e){if(!(10>e||e>1e3)){t.world.step(e/t.params.timeGear);for(var i=egret.MainContext.instance.stage.stageHeight,n=t.world.bodies.length,a=[],o=0;n>o;o++){var r=t.world.bodies[o],s=r.displays[0],c=r.shapes[0];s&&c&&(s.x=r.position[0]*t.params.factor,s.y=i-r.position[1]*t.params.factor,s.rotation=360-180*(r.angle+c.angle)/Math.PI,(r.sleepState==p2.Body.SLEEPING||s.x<20||s.x>egret.MainContext.instance.stage.stageWidth-20)&&a.push(r))}a.map(function(e){var i=e.displays[0];if(i){var n=66,a=36;egret.Tween.get(i).to({alpha:0},0).wait(80).to({alpha:1},0).wait(80).to({alpha:0},0).wait(80).to({alpha:1},0).wait(80).to({x:n,y:a},300).call(function(){i.parent&&(ObjectPool.getPool("egret.Bitmap").returnObject(i),i.parent.removeChild(i));var t=ObjectPool.getPool("eui.Image").borrowObject();RES.getResAsync("foguang_fp02_png",function(e){t.source=e,t.anchorOffsetX=0,t.anchorOffsetY=0,t.x=n-25,t.y=a-25,UIPage.inst(UIPage).EffectGroup.addChild(t),setTimeout(function(){ObjectPool.getPool("egret.Bitmap").returnObject(t),t.parent.removeChild(t)},50)},this)}),e.shapes[0]&&(ObjectPool.getPool("p2.Circle").returnObject(e.shapes[0]),e.removeShape(e.shapes[0])),ObjectPool.getPool("p2.Body").returnObject(e),t._world.removeBody(e)}})}},self)}return this._world},enumerable:!0,configurable:!0}),t.addOneBox=function(e,i,n,a,o){return __awaiter(this,void 0,void 0,function(){var r,s,c,l,u,h;return __generator(this,function(p){switch(p.label){case 0:r=0,p.label=1;case 1:return a>r?(s=ObjectPool.getPool("p2.Circle").borrowObject(),s.radius=.45,s.material=t.params.coinMaterial,c=ObjectPool.getPool("p2.Body").borrowObject({mass:Math.ceil(10*Math.random()),position:[Math.floor(i/t.params.factor),Math.floor((egret.MainContext.instance.stage.stageHeight-n+150)/t.params.factor)],angle:0,velocity:[Math.floor(12*Math.random())-6,Math.ceil(20*Math.random())+15],angularVelocity:3}),c.displays=[],c.shapes=[],c.position=[Math.floor(i/t.params.factor),Math.floor((egret.MainContext.instance.stage.stageHeight-n+150)/t.params.factor)],c.velocity=[Math.floor(12*Math.random())-6,Math.ceil(20*Math.random())+15],c.addShape(s),l=ObjectPool.getPool("egret.Bitmap").borrowObject(),u=l,[4,MovieManage.PromisifyGetRes(e)]):[3,4];case 2:u.texture=p.sent(),h=l,h.x=i,h.y=n,o.addChild(h),h.width=2*s.radius*t.params.factor,h.height=2*s.radius*t.params.factor,h.anchorOffsetX=h.width/2,h.anchorOffsetY=h.height/2,c.displays=[h],t.world.addBody(c),p.label=3;case 3:return r++,[3,1];case 4:return[2]}})})},t.jinbiAniFfun=function(t,e,i,n,a,o){return __awaiter(this,void 0,void 0,function(){var r,s,c,l,u;return __generator(this,function(h){switch(h.label){case 0:return r=ObjectPool.getPool("eui.Image").borrowObject(),s=r,[4,MovieManage.PromisifyGetRes("jinbi_png",o)];case 1:return s.texture=h.sent(),o.addChild(r),r.x=e,r.y=i-.8*a,r.scaleX=.2,r.scaleY=.2,r.alpha=0,c=Math.floor(Math.random()*(2*n)-n),l=c>0?1:-1,u=Math.floor(10*Math.random()+10),egret.Tween.get(r).to({alpha:1,scaleX:t,scaleY:t},200).to({y:630},300).to({y:580,x:r.x-c/4},100).to({y:630,x:r.x-c/3},100).to({y:600,x:r.x-c/2},50).to({y:630,x:r.x-c},50).to({y:630,x:r.x-c-10*l},30).wait(1500).call(function(){this.removeChild(r),ObjectPool.getPool("eui.Image").returnObject(r)}.bind(o)),[2]}})})},t}();physicsWorld._world=null,physicsWorld.params={factor:50,landline:450,timeGear:1e3,gravity:-58.92,coinMaterial:new p2.Material(1)},__reflect(physicsWorld.prototype,"physicsWorld");var SoundManager=function(){function t(){}return Object.defineProperty(t,"BG_Music",{get:function(){return"bg_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack1_Music",{get:function(){return"attack1_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack2_Music",{get:function(){return"attack2_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack3_Music",{get:function(){return"attack3_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack4_Music",{get:function(){return"attack4_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack5_Music",{get:function(){return"attack5_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack6_Music",{get:function(){return"attack6_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Attack7_Music",{get:function(){return"attack7_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PetAttack1_Music",{get:function(){return"petattack1_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PetAttack2_Music",{get:function(){return"petattack2_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PetAttack3_Music",{get:function(){return"petattack3_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OpenWin_Music",{get:function(){return"openwin_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CloseWin_Music",{get:function(){return"closewin_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Button_Music",{get:function(){return"button_music_mp3"
},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BoxApp_Music",{get:function(){return"boxapp_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Reward_Music",{get:function(){return"reward_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Gold_Music",{get:function(){return"gold_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Lvup_Music",{get:function(){return"lvup_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Error1_Music",{get:function(){return"error1_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Error2_Music",{get:function(){return"error2_music_mp3"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Skill_Music",{get:function(){return"skill_music_mp3"},enumerable:!0,configurable:!0}),t.PlayMusic=function(e,i){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(a){switch(a.label){case 0:return e==t.BG_Music||t._isPlayYinxiao?e==t.BG_Music&&null!=t._bgSound?[2]:[4,MovieManage.PromisifyGetRes(e,this)]:[2];case 1:return n=a.sent(),null==n?(console.log(e),[2,null]):(e!=t.BG_Music?this._channel=n.play(0,i):this._bgSound=n.play(0,i),[2])}})})},t.PlayBackgroundMusic=function(){t.PlayMusic(t.BG_Music,0)},t.StopBackgroundMusic=function(){0!=this._bgSound.volume?this._bgSound.volume=0:this._bgSound.volume=1},t.StopEffectsMusic=function(){0!=this._channel.volume?this._channel.volume=0:this._channel.volume=1},t.PlayButtonMusic=function(){t._isPlayYinxiao&&t.PlayMusic(t.Button_Music,1)},t.PlayOpenWinMusic=function(){t._isPlayYinxiao&&t.PlayMusic(t.OpenWin_Music,1)},t.PlayCloseWinMusic=function(){t._isPlayYinxiao&&t.PlayMusic(t.CloseWin_Music,1)},Object.defineProperty(t,"YinYue",{set:function(e){t._isPlayYinyue!=e&&(t._isPlayYinyue=e,null!=t._bgSound&&(e?t._bgSound.volume=1:t._bgSound.volume=0))},enumerable:!0,configurable:!0}),Object.defineProperty(t,"YinXiao",{set:function(e){t._isPlayYinxiao!=e&&(t._isPlayYinxiao=e)},enumerable:!0,configurable:!0}),t.PlayGoldMusic=function(){t._isPlayYinxiao&&t.PlayMusic(t.Gold_Music,1)},t.PlayLvupMusic=function(){t._isPlayYinxiao&&t.PlayMusic(t.Lvup_Music,1)},t.PlayError1Music=function(){t._isPlayYinxiao&&t.PlayMusic(t.Error1_Music,1)},t.PlayError2Music=function(){t._isPlayYinxiao&&t.PlayMusic(t.Error2_Music,1)},t.PlaySkillMusic=function(){t._isPlayYinxiao&&t.PlayMusic(t.Skill_Music,1)},t}();SoundManager._isPlayYinyue=!0,SoundManager._isPlayYinxiao=!0,__reflect(SoundManager.prototype,"SoundManager");var TextManager=function(){function t(){}return t.TimeFormat=function(t){var e="";if(100>t)e=t.toString()+"s";else{var i=Math.floor(t/60/60),n=Math.floor(t%3600/60),a=t%60,o=i>0?i.toString():"",r=n>9?n.toString():"0"+n.toString(),s=a>9?a.toString():"0"+a.toString();e=i>0?o+":"+r+":"+s:r+":"+s}return e},t}();__reflect(TextManager.prototype,"TextManager");var ChangeLabelValue=function(){function t(t,e,i,n){void 0===n&&(n=1),this.interval=1,this.onUpdate=e,this.parent=t,this.callback=i,this.timer={},this.interval=n,this.tick()}return t.prototype.tick=function(){var t=this;this.timer&&(Object.keys(this.timer).map(function(e){t.timer[e].val<=.001?1==t.timer[e].status&&(t.timer[e].status=0,t.onUpdate(e),t.callback(e)):t.timer[e].val>0&&(t.timer[e].val-=t.interval,t.onUpdate(e))}),this.pointOfTimer=setTimeout(function(){t.tick()},1e3*this.interval))},t.prototype.destory=function(){this.pointOfTimer>0&&(clearTimeout(this.pointOfTimer),this.pointOfTimer=0)},t.prototype.getValue=function(t){return this.timer[t]?TimeFormator.ToTimeFormat(this.timer[t].val):TimeFormator.ToTimeFormat(0)},t.prototype.getOriValue=function(t){return this.timer[t].val},t.prototype.setValue=function(t,e){e>0?this.timer[t]={val:e,status:1}:(this.timer.hasOwnProperty(t)&&this.onUpdate(t),this.timer[t]={val:0,status:0})},t}();__reflect(ChangeLabelValue.prototype,"ChangeLabelValue");var TimeFormator=function(){function t(){}return t.ToTimeFormat=function(t){var e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%60);return this.AddPad(e)+":"+this.AddPad(i)+":"+this.AddPad(n)},t.AddPad=function(t){return 10>t?"0"+t.toString():t.toString()},t}();__reflect(TimeFormator.prototype,"TimeFormator");var Toast=function(t){function e(i,n,a){var o=t.call(this)||this,r=new egret.Bitmap(e._txtrToastBg);o.addChildAt(r,0);var s=new egret.TextField;return s.multiline=!0,s.size=20,s.bold=!0,s.textColor=16777215,s.stroke=2,s.strokeColor=0,s.text=i,s.fontFamily="微软雅黑",s.textAlign=egret.HorizontalAlign.CENTER,s.width=.84*n,s.x=(e._txtrToastBg.textureWidth-s.width)/2,s.y=6,o.addChildAt(s,0),r.height=12+s.height,o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=.5*n,o.y=.418*a,o.alpha=0,egret.Tween.get(o).to({alpha:1},800,egret.Ease.quintOut).wait(1600).to({alpha:0},1200,egret.Ease.quintIn).call(function(){o.parent&&o.parent.removeChild(o)}),o}return __extends(e,t),e.init=function(t,e){this._cont=t,this._txtrToastBg=e},e.launch=function(t){if(this._cont){var i=new e(t,this._cont.stage.stageWidth,this._cont.stage.stageHeight);this._cont.addChild(i)}},e}(egret.DisplayObjectContainer);__reflect(Toast.prototype,"Toast"),Mixin.applyMixins(Main,[Mixin.asSettable]);